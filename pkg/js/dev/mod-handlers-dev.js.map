{"version":3,"sources":["mod-handlers.js"],"names":["$","MyAMS","_initialized","clickHandler","evt","source","currentTarget","handlers","data","amsClickHandler","amsPreventDefault","amsClickPreventDefault","preventDefault","amsStopPropagation","amsClickStopPropagation","stopPropagation","split","handler","callback","core","getFunctionByName","undefined","call","document","amsClickHandlerOptions","changeHandler","prop","amsChangeHandler","amsKeepDefault","amsChangeKeepDefault","amsChangeStopPropagation","amsChangeHandlerOptions","clearForm","form","not","remove","removeClass","find","trigger","each","idx","elt","element","amsResetCallback","amsResetCallbackOptions","formResetHandler","setTimeout","setFocus","customResetHandler","amsResetHandler","amsResetKeepDefault","amsResetHandlerOptions","clickEventTrigger","target","init","on","env","bundle","config","modules","push","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS */\n/**\n * MyAMS events handlers\n */\n\nconst $ = MyAMS.$;\n\n\nlet _initialized = false;\n\n\n/**\n * Generic click event handler\n */\nexport function clickHandler(evt) {\n\tconst\n\t\tsource = $(evt.currentTarget),\n\t\thandlers = source.data('ams-disabled-handlers');\n\tif ((handlers === true) || (handlers === 'click') || (handlers === 'all')) {\n\t\treturn;\n\t}\n\tconst data = source.data();\n\tif (data.amsClickHandler) {\n\t\tif ((data.amsPreventDefault !== false) && (data.amsClickPreventDefault !== false)) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t\tif ((data.amsStopPropagation !== false) && (data.amsClickStopPropagation !== false)) {\n\t\t\tevt.stopPropagation();\n\t\t}\n\t\tfor (const handler of data.amsClickHandler.split(/[\\s,;]+/)) {\n\t\t\tconst callback = MyAMS.core.getFunctionByName(handler);\n\t\t\tif (callback !== undefined) {\n\t\t\t\tcallback.call(document, evt, source, data.amsClickHandlerOptions);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Generic change event handler\n */\nexport function changeHandler(evt) {\n\tconst source = $(evt.currentTarget);\n\t// Disable change handlers for readonly inputs\n\t// These change handlers are activated by IE!!!\n\tif (source.prop('readonly')) {\n\t\treturn;\n\t}\n\tconst handlers = source.data('ams-disabled-handlers');\n\tif ((handlers === true) || (handlers === 'change') || (handlers === 'all')) {\n\t\treturn;\n\t}\n\tconst data = source.data();\n\tif (data.amsChangeHandler) {\n\t\tif ((data.amsKeepDefault !== false) && (data.amsChangeKeepDefault !== false)) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t\tif ((data.amsStopPropagation !== false) && (data.amsChangeStopPropagation !== false)) {\n\t\t\tevt.stopPropagation();\n\t\t}\n\t\tfor (const handler of data.amsChangeHandler.split(/[\\s,;]+/)) {\n\t\t\tconst callback = MyAMS.core.getFunctionByName(handler);\n\t\t\tif (callback !== undefined) {\n\t\t\t\tcallback.call(document, evt, source, data.amsChangeHandlerOptions);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Generic form reset handler\n */\nexport function clearForm(form) {\n\t$('.alert-danger, SPAN.state-error', form).not('.persistent').remove();\n\t$('LABEL.state-error', form).removeClass('state-error');\n\tform.find('.select2').trigger('change');\n\t$('[data-ams-reset-callback]', form).each((idx, elt) => {\n\t\tconst\n\t\t\telement = $(elt),\n\t\t\tdata = element.data(),\n\t\t\tcallback = MyAMS.core.getFunctionByName(data.amsResetCallback);\n\t\tif (callback !== undefined) {\n\t\t\tcallback.call(document, form, element, data.amsResetCallbackOptions);\n\t\t}\n\t});\n}\n\nexport function formResetHandler(evt) {\n\tconst form = $(evt.currentTarget);\n\tsetTimeout(function() {\n\t\tclearForm(form);\n\t}, 10);\n\tMyAMS.form && MyAMS.form.setFocus(form);\n}\n\n\n/**\n * Custom reset handler\n */\nexport function customResetHandler(evt) {\n\tconst\n\t\tform = $(evt.currentTarget),\n\t\tdata = form.data();\n\tif (data.amsResetHandler) {\n\t\tif ((data.amsKeepDefault !== true) && (data.amsResetKeepDefault !== true)) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t\tconst callback = MyAMS.core.getFunctionByName(data.amsResetHandler);\n\t\tif (callback !== undefined) {\n\t\t\tcallback.call(document, evt, form, data.amsResetHandlerOptions);\n\t\t}\n\t}\n}\n\n\n/**\n * Genenric click event trigger\n */\nexport function clickEventTrigger(evt) {\n\tconst source = $(evt.currentTarget);\n\t$(evt.target).trigger(source.data('ams-click-event'),\n\t\tsource.data('ams-click-event-options'));\n}\n\n\nexport const handlers = {\n\n\tinit: () => {\n\n\t\tif (_initialized) {\n\t\t\treturn;\n\t\t}\n\t\t_initialized = true;\n\n\t\t// Initialize custom click handlers\n\t\t$(document).on('click', '[data-ams-click-handler]', clickHandler);\n\n\t\t// Initialize custom change handlers\n\t\t$(document).on('change', '[data-ams-change-handler]', changeHandler);\n\n\t\t// Notify reset to update Select2 widgets\n\t\t$(document).on('reset', 'form', formResetHandler);\n\n\t\t// Initialize custom reset handlers\n\t\t$(document).on('reset', '[data-ams-reset-handler]', customResetHandler);\n\n\t\t// Initialize custom event on click\n\t\t$(document).on('click', '[data-ams-click-event]', clickEventTrigger);\n\n\t\t// Cancel clicks on readonly checkbox\n\t\t$(document).on('click', 'input[type=\"checkbox\"][readonly]', () => {\n\t\t\treturn false;\n\t\t});\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (MyAMS.env.bundle) {\n\tMyAMS.config.modules.push('handlers');\n} else {\n\tMyAMS.handlers = handlers;\n\tconsole.debug(\"MyAMS: handlers module loaded...\");\n}\n"],"file":"mod-handlers-dev.js"}