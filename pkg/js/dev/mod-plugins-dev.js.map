{"version":3,"sources":["mod-plugins.js"],"names":["$","MyAMS","templates","jsrender","require","CHECKER_TEMPLATE_STRING","CHECKER_TEMPLATE","markup","checker","element","Promise","resolve","checkers","length","each","idx","elt","legend","data","amsChecker","fieldset","parent","state","amsCheckerState","amsState","checked","hasClass","fieldName","amsCheckerFieldname","amsFieldname","core","generateId","fieldId","replace","prefix","amsCheckerHiddenPrefix","amsHiddenPrefix","marker","amsCheckerMarker","amsMarker","checkerMode","amsCheckerMode","amsMode","checkedValue","amsCheckerValueOn","amsValueOn","uncheckedValue","amsCheckerValueOff","amsValueOff","value","amsCheckerValue","amsValue","readonly","amsCheckerReadonly","amsReadonly","props","text","veto","trigger","html","render","change","evt","input","target","is","prop","executeFunctionByName","amsCheckerChangeHandler","amsChangeHandler","document","amsCheckerCancelDefault","amsCancelDefault","siblings","removeClass","val","addClass","closest","on","click","contextMenu","reject","menus","then","menu","options","menuSelector","amsContextmenuSelector","amsMenuSelector","settings","extend","amsContextmenuOptions","amsOptions","amsContextmenuInitCallback","amsInit","plugin","amsContextmenuAfterInitCallback","amsAfterInit","_datatablesHelpers","init","types","fn","dataTable","ext","type","detect","unshift","match","order","a","b","x","y","parseFloat","trimmed","trim","frDate","split","frDateTime","frTime","preReorder","node","table","reorderRows","amsReorderInputTarget","url","amsReorderUrl","ids","rows","getter","getFunctionByName","amsReorderData","makeArray","map","listattr","separator","amsReorderSeparator","exists","join","startsWith","window","location","protocol","postData","amsReorderPostData","attr","amsReorderPostAttr","ajax","post","result","status","xhr","callback","amsReorderCallback","results","apply","handleJSON","parents","datatables","baseJS","env","baseURL","baseCSS","tables","check","extext","firstLoad","required","push","getScript","getCSS","when","css","bases","extensions","depends","loaded","buttons","removeData","autoFill","AutoFill","Buttons","isArray","indexOf","buttons_print","print","buttons_excel","excelHtml5","buttons_pdf","pdfMake","buttons_colvis","colvis","colReorder","ColReorder","fixedColumns","FixedColumns","fixedHeader","FixedHeader","keyTable","KeyTable","responsive","Responsive","rowGroup","RowGroup","rowReorder","RowReorder","scroller","Scroller","searchBuilder","SearchBuilder","searchPanes","SearchPanes","select","Object","entries","name","isDataTable","dom","amsDatatableDom","amsDom","searching","lengthChange","info","paging","defaultOptions","language","amsDatatableLanguage","amsLanguage","i18n","plugins","amsDatatableOrder","amsOrder","orders","col","colOrder","parseInt","heads","columns","th","sortables","iterator","sortable","undefined","JSON","parse","stype","amsDatatableOptions","amsDatatableInitCallback","DataTable","amsDatatableAfterInitCallback","amsDatatablePreReorder","amsPreReorder","amsDatatableReordered","amsReordered","datetime","inputs","moment","datetimepicker","locale","amsDatetimeLanguage","icons","time","date","up","down","previous","next","today","clear","close","format","amsDatetimeFormat","amsFormat","datetimeOptions","amsDatetimeInitCallback","amsDatetimeIsoTarget","amsIsoTarget","source","currentTarget","toISOString","dragdrop","dragitems","draggable","item","dragOptions","cursor","amsDraggableCursor","containment","amsDraggableContainment","handle","amsDraggableHandle","connectToSortable","amsDraggableConnectSortable","helper","amsDraggableHelper","start","amsDraggableStart","stop","amsDraggableStop","amsDraggableOptions","amsDraggableInitCallback","disableSelection","amsDraggableAfterInitCallback","dropOptions","accept","amsDroppableAccept","amsAccept","drop","amsDroppableDrop","amsDroppableOptions","amsDroppableInitCallback","droppable","amsDroppableAfterInitCallback","sortOptions","items","amsSortableItems","amsSortableHandle","amsSortableHelper","connectWith","amsSortableConnectwith","amsSortableContainment","placeholder","amsSortablePlaceholder","amsSortableStart","over","amsSortableOver","amsSortableStop","amsSortableOptions","amsSortableInitCallback","amsSortableAfterInitCallback","resizeOptions","autoHide","amsResizableAutohide","amsResizableContainment","grid","amsResizableGrid","handles","amsResizableHandles","amsResizableStart","resize","amsResizableResize","amsResizableStop","amsResizableOptions","amsResizableInitCallback","resizable","amsResizableAfterInitCallback","editor","editors","ace","deferred","config","set","textarea","widget","modeList","mode","amsEditorMode","getModeForPath","amsEditorFilename","amsFilename","setTimeout","textEditor","position","width","height","insertBefore","fontSize","tabSize","useSoftTabs","showGutter","showLineNumbers","printMargin","showInvisibles","amsEditorOptions","amsEditorInitCallback","edit","setOptions","theme","setTheme","session","setValue","getValue","amsEditorAfterEditCallback","fileInput","bsCustomFileInput","inputId","inputSelector","form","formId","formSelector","imgAreaSelect","images","image","parentSelector","amsImgareaselectParent","amsParent","instance","x1","amsImgareaselectX1","amsX1","y1","amsImgareaselectY1","amsY1","x2","amsImgareaselectX2","amsX2","amsImgareaselectImageWidth","amsImageWidth","y2","amsImgareaselectY2","amsY2","amsImgareaselectImageHeight","amsImageHeight","imageWidth","imageHeight","imgWidth","amsImgareaselectThumbWidth","amsThumbWidth","imgHeight","amsImgareaselectThumbHeight","amsThumbHeight","minWidth","minHeight","aspectRatio","amsImgareaselectAspectRatio","amsAspectRatio","onSelectEnd","amsImgareaselectSelectEnd","amsSelectedEnd","img","selection","amsImgareaselectTargetField","amsTargetField","amsImgareaselectOptions","amsImgareaselectInitCallback","_select2Helpers","select2UpdateHiddenField","values","find","children","title","select2AjaxParamsHelper","params","assign","select2","selects","amsSelect2Theme","amsTheme","amsSelect2Language","escapeMarkup","amsSelect2EscapeMarkup","amsEscapeMarkup","matcher","amsSelect2Matcher","amsMatcher","sorter","amsSelect2Sorter","amsSorter","templateResult","amsSelect2TemplateResult","amsTemplateResult","templateSelection","amsSelect2TemplateSelection","amsTemplateSelection","tokenizer","amsSelect2Tokenizer","amsTokenizer","ajaxUrl","amsSelect2AjaxUrl","amsAjaxUrl","ajaxParamsHelper","ajaxParams","amsSelect2AjaxParams","amsAjaxParams","amsSelect2AjaxData","amsAjaxData","processResults","amsSelect2AjaxProcessResults","amsAjaxProcessResults","transport","amsSelect2AjaxTransport","amsAjaxTransport","minimumInputLength","amsSelect2MinimumInputLength","amsMinimumInputLength","hidden","insertAfter","amsSelect2Separator","removeAttr","amsSelect2Options","amsSelect2InitCallback","modal","first","zIndex","$dropdown","get","focus","update","id","option","helpers","moveElementToParentEnd","amsSelect2AfterInitCallback","svgPlugin","svgs","container","svg","setAttribute","Math","round","switcher","switchers","amsSwitcherState","minusClass","amsSwitcherMinusClass","amsMinusClass","plusClass","amsSwitcherPlusClass","amsPlusClass","amsSwitcher","prependTo","preventDefault","switchIcon","tinymce","devmode","suffix","stopImmediatePropagation","editorId","remove","selector","base_url","amsTinymceTheme","menubar","amsTinymceMenubar","amsMenubar","statusbar","amsTinymceStatusbar","amsStatusbar","amsTinymcePlugins","amsPlugins","toolbar","amsTinymceToolbar","amsToolbar","toolbar1","amsTinymceToolbar1","amsToolbar1","toolbar2","amsTinymceToolbar2","amsToolbar2","content_css","amsTinymceContentCss","amsContentCss","formats","amsTinymceFormats","amsFormats","style_formats","amsTinymceStyleFormats","amsStyleFormats","block_formats","amsTinymceBlockFormats","amsBlockFormats","valid_classes","amsTinymceValidClasses","amsValidClasses","image_advtab","image_list","amsTinymceImageList","amsImageList","image_class_list","amsTinymceImageClassList","amsImageClassList","link_list","amsTinymceLinkList","amsLinkList","link_class_list","amsTinymceLinkClassList","amsLinkClassList","paste_as_text","amsTinymcePasteAsText","amsPasteAsText","paste_auto_cleanup_on_paste","amsTinymcePasteAutoCleanup","amsPasteAutoCleanup","paste_strip_class_attributes","amsTinymcePasteStripClassAttributes","amsPasteStripClassAttributes","paste_remove_spans","amsTinymcePasteRemoveSpans","amsPasteRemoveSpans","paste_remove_styles","amsTinymcePasteRemoveStyles","amsPasteRemoveStyles","amsTinymceHeight","amsHeight","min_height","autoresize_min_height","autoresize_max_height","amsTinymceExternalPlugins","amsExternalPlugins","names","src","PluginManager","load","getSource","amsTinymceOptions","amsTinymceInitCallback","amsTinymceAfterInitCallback","treeview","trees","treview","dataOptions","amsTreeviewData","levels","amsTreeviewLevels","injectStyle","amsTreeviewInjectStyle","expandIcon","amsTreeviewExpandIcon","collapseIcon","amsTreeviewCollaspeIcon","emptyIcon","amsTreeviewEmptyIcon","nodeIcon","amsTreeviewNodeIcon","selectedIcon","amsTreeviewSelectedIcon","checkedIcon","amsTreeviewCheckedIcon","uncheckedIcon","amsTreeviewUncheckedIcon","color","amsTreeviewColor","backColor","amsTreeviewBackColor","borderColor","amsTreeviewBorderColor","onHoverColor","amsTreeviewHoverColor","selectedColor","amsTreeviewSelectedColor","selectedBackColor","amsTreeviewSelectedBackColor","unselectableColor","amsTreeviewUnselectableColor","unselectableBackColor","amsTreeviewUnselectableBackColor","enableLinks","amsTreeviewEnableLinks","highlightSelected","amsTreeviewHighlightSelected","highlightSearchResults","amsTreeviewhighlightSearchResults","showBorder","amsTreeviewShowBorder","showIcon","amsTreeviewShowIcon","showCheckbox","amsTreeviewShowCheckbox","showTags","amsTreeviewShowTags","toggleUnselectable","amsTreeviewToggleUnselectable","multiSelect","amsTreeviewMultiSelect","onNodeChecked","amsTreeviewNodeChecked","onNodeCollapsed","amsTreeviewNodeCollapsed","onNodeDisabled","amsTreeviewNodeDisabled","onNodeEnabled","amsTreeviewNodeEnabled","onNodeExpanded","amsTreeviewNodeExpanded","onNodeSelected","amsTreeviewNodeSelected","onNodeUnchecked","amsTreeviewNodeUnchecked","onNodeUnselected","amsTreeviewNodeUnselected","onSearchComplete","amsTreeviewSearchComplete","onSearchCleared","amsTreeviewSearchCleared","amsTreeviewOptions","amsTreeviewInitcallback","amsTreeviewAfterInitCallback","validate","forms","ignore","invalidHandler","amsValidateInvalidHandler","validator","errorList","error","panels","fieldsets","panel","tabs","index","errorElement","amsValidateErrorElement","errorClass","amsValidateErrorClass","errorPlacement","amsValidateErrorPlacement","append","submitHandler","amsValidateSubmitHandler","submit","rules","messages","amsValidateOptions","amsValidateInitCallback","amsValidateAfterInitCallback","registry","register","modules","bundle","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS, bsCustomFileInput */\n/**\n * MyAMS standard plugins\n */\n\nconst $ = MyAMS.$;\n\nif (!$.templates) {\n\tconst jsrender = require('jsrender');\n\t$.templates = jsrender.templates;\n}\n\n\n/**\n * Fieldset checker plug-in\n *\n * A checker is like a simple switcher, but also provides a checkbox which is used\n * as \"switcher\" input field.\n *\n * The \"checker\" class is applied to the fieldset legend; checkbox is created automatically\n * by the plug-in.\n * Check options are given as data attributes, all prefixed with \"ams-checker-\":\n *  - state: is 'off' by default; can be set to 'on' to automatically activate the checker\n *  - mode: is 'hide' by default, which make the fieldset hidden when the checker is not activated;\n *    you cna set it to \"disable\" to make fieldset content visible but disabled when the checker\n *    is not activated\n *  - fieldname: is the name of the input checkbox created by the plug-in\n *  - value: this is the \"checked\" value of the main checkbox field\n *  - readonly: if \"true\", the checkbox is disabled and in read-only mode\n *  - hidden-prefix: if not null, this is a prefix which will be assigned to an additional\n *    hidden input field, updated automatically when the checker is switched; the name of the\n *    hidden input if made of this prefix, followed by the \"fieldname\" value\n *  - value-on: this is the \"checked\" value of the hidden input; \"true\" by default\n *  - value-off: this is the \"unchecked\" value of the hidden input; \"false\" by default\n *  - marker: if not null, another hidden input with a fixed value of 1 will be created; the name\n *    of this input will be the \"fieldname\" value followed by this \"marker\" value\n *  - change-handler: this optional handler will be called on checker switch\n *  - cancel-default: if \"true\", the default behaviour will not be executed on checker switch\n */\n\nconst CHECKER_TEMPLATE_STRING = `\n\t<span class=\"custom-control custom-switch\">\n\t\t<input type=\"checkbox\"\n\t\t\t   id=\"{{: fieldId }}\" name=\"{{: fieldName }}\"\n\t\t\t   class=\"custom-control-input checker\"\n\t\t\t   {{if checked}}checked{{/if}}\n\t\t\t   {{if readonly}}disabled{{/if}}\n\t\t\t   value=\"{{: value }}\" />\n\t\t{{if prefix}}\n\t\t<input type=\"hidden\" class=\"prefix\"\n\t\t\t   id=\"{{: prefix}}{{: fieldName}}_prefix\"\n\t\t\t   name=\"{{: prefix}}{{: fieldName}}\"\n\t\t\t   value=\"{{if state==='on'}}{{: checkedValue}}{{else}}{{: uncheckedValue}}{{/if}}\" />\n\t\t{{else marker}}\n\t\t<input type=\"hidden\" class=\"marker\"\n\t\t\t   name=\"{{: fieldName}}{{: marker}}\"\n\t\t\t   value=\"1\" />\n\t\t{{/if}}\n\t\t<label for=\"{{: fieldId }}\"\n\t\t\t   class=\"custom-control-label\">\n\t\t\t{{: legend }}\n\t\t</label>\n\t</span>\n`;\n\nconst CHECKER_TEMPLATE = $.templates({\n\tmarkup: CHECKER_TEMPLATE_STRING\n});\n\nexport function checker(element) {\n\treturn new Promise((resolve) => {\n\t\tconst checkers = $('legend.checker', element);\n\t\tif (checkers.length > 0) {\n\t\t\tcheckers.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tlegend = $(elt),\n\t\t\t\t\tdata = legend.data();\n\t\t\t\tif (!data.amsChecker) {\n\t\t\t\t\tconst\n\t\t\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\t\t\tstate = data.amsCheckerState || data.amsState,\n\t\t\t\t\t\tchecked = fieldset.hasClass('switched') || (state === 'on'),\n\t\t\t\t\t\tfieldName = data.amsCheckerFieldname || data.amsFieldname || `checker_${MyAMS.core.generateId()}`,\n\t\t\t\t\t\tfieldId = fieldName.replace(/\\./g, '_'),\n\t\t\t\t\t\tprefix = data.amsCheckerHiddenPrefix || data.amsHiddenPrefix,\n\t\t\t\t\t\tmarker = data.amsCheckerMarker || data.amsMarker || false,\n\t\t\t\t\t\tcheckerMode = data.amsCheckerMode || data.amsMode || 'hide',\n\t\t\t\t\t\tcheckedValue = data.amsCheckerValueOn || data.amsValueOn || 'true',\n\t\t\t\t\t\tuncheckedValue = data.amsCheckerValueOff || data.amsValueOff || 'false',\n\t\t\t\t\t\tvalue = data.amsCheckerValue || data.amsValue,\n\t\t\t\t\t\treadonly = data.amsCheckerReadonly || data.amsReadonly,\n\t\t\t\t\t\tprops = {\n\t\t\t\t\t\t\tlegend: legend.text(),\n\t\t\t\t\t\t\tfieldName: fieldName,\n\t\t\t\t\t\t\tfieldId: fieldId,\n\t\t\t\t\t\t\tvalue: value || true,\n\t\t\t\t\t\t\tchecked: checked,\n\t\t\t\t\t\t\treadonly: readonly,\n\t\t\t\t\t\t\tprefix: prefix,\n\t\t\t\t\t\t\tstate: state,\n\t\t\t\t\t\t\tcheckedValue: checkedValue,\n\t\t\t\t\t\t\tuncheckedValue: uncheckedValue,\n\t\t\t\t\t\t\tmarker: marker\n\t\t\t\t\t\t},\n\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\tlegend.trigger('before-init.ams.checker', [legend, props, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlegend.html(CHECKER_TEMPLATE.render(props));\n\t\t\t\t\t$('input', legend).change((evt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tinput = $(evt.target),\n\t\t\t\t\t\t\tchecked = input.is(':checked'),\n\t\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\t\tlegend.trigger('before-switch.ams.checker', [legend, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\tinput.prop('checked', !checked);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsCheckerChangeHandler ||\n\t\t\t\t\t\t\tdata.amsChangeHandler, document, legend, checked);\n\t\t\t\t\t\tif (!data.amsCheckerCancelDefault && !data.amsCancelDefault) {\n\t\t\t\t\t\t\tconst prefix = input.siblings('.prefix');\n\t\t\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\t\t\tprefix.val(checkedValue);\n\t\t\t\t\t\t\t\t\tlegend.trigger('opened.ams.checker', [legend]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\t\t\tprefix.val(uncheckedValue);\n\t\t\t\t\t\t\t\t\tlegend.trigger('closed.ams.checker', [legend]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfieldset.prop('disabled', !checked);\n\t\t\t\t\t\t\t\tprefix.val(checked ? checkedValue : uncheckedValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tlegend.closest('form').on('reset', () => {\n\t\t\t\t\t\tconst checker = $('.checker', legend);\n\t\t\t\t\t\tif (checker.prop('checked') !== checked) {\n\t\t\t\t\t\t\tchecker.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!checked) {\n\t\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.prop('disabled', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlegend.trigger('after-init.ams.checker', [legend]);\n\t\t\t\t\tlegend.data('ams-checker', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tresolve(checkers);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Context menu plug-in\n */\n\nexport function contextMenu(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst menus = $('.context-menu', element);\n\t\tif (menus.length > 0) {\n\t\t\tMyAMS.require('menu').then(() => {\n\t\t\t\tmenus.each((idx, elt) => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tmenu = $(elt),\n\t\t\t\t\t\tdata = menu.data(),\n\t\t\t\t\t\toptions = {\n\t\t\t\t\t\t\tmenuSelector: data.amsContextmenuSelector || data.amsMenuSelector\n\t\t\t\t\t\t};\n\t\t\t\t\tlet settings = $.extend({}, options, data.amsContextmenuOptions || data.amsOptions);\n\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsContextmenuInitCallback || data.amsInit,\n\t\t\t\t\t\tdocument, menu, settings) || settings;\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\tmenu.trigger('before-init.ams.contextmenu', [menu, settings, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst plugin = menu.contextMenu(settings);\n\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsContextmenuAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\tdocument, menu, plugin, settings);\n\t\t\t\t\tmenu.trigger('after-init.ams.contextmenu', [menu, plugin]);\n\t\t\t\t});\n\t\t\t}, reject).then(() => {\n\t\t\t\tresolve(menus);\n\t\t\t});\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * JQuery Datatable plug-in\n */\n\nconst _datatablesHelpers = {\n\n\tinit: () => {\n\n\t\t// Add autodetect formats\n\t\tconst types = $.fn.dataTable.ext.type;\n\n\t\ttypes.detect.unshift((data) => {\n\t\t\tif (data !== null && data.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\\/(0[1-9]|1[0-2])\\/[0-3][0-9]{3}$/)) {\n\t\t\t\treturn 'date-euro';\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\ttypes.detect.unshift((data) => {\n\t\t\tif (data !== null && data.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\\/(0[1-9]|1[0-2])\\/[0-3][0-9]{3} - ([0-1][0-9]|2[0-3]):[0-5][0-9]$/)) {\n\t\t\t\treturn 'datetime-euro';\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\t// Add sorting methods\n\t\t$.extend(types.order, {\n\n\t\t\t// numeric values using commas separators\n\t\t\t\"numeric-comma-asc\": (a, b) => {\n\t\t\t\tlet x = a.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tlet y = b.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tx = parseFloat(x);\n\t\t\t\ty = parseFloat(y);\n\t\t\t\treturn ((x < y) ? -1 : ((x > y) ? 1 : 0));\n\t\t\t},\n\t\t\t\"numeric-comma-desc\": (a, b) => {\n\t\t\t\tlet x = a.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tlet y = b.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tx = parseFloat(x);\n\t\t\t\ty = parseFloat(y);\n\t\t\t\treturn ((x < y) ? 1 : ((x > y) ? -1 : 0));\n\t\t\t},\n\n\t\t\t// date-euro column sorter\n\t\t\t\"date-euro-pre\": (a) => {\n\t\t\t\tconst trimmed = $.trim(a);\n\t\t\t\tlet x;\n\t\t\t\tif (trimmed !== '') {\n\t\t\t\t\tconst frDate = trimmed.split('/');\n\t\t\t\t\tx = (frDate[2] + frDate[1] + frDate[0]) * 1;\n\t\t\t\t} else {\n\t\t\t\t\tx = 10000000; // = l'an 1000 ...\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t},\n\t\t\t\"date-euro-asc\": (a, b) => {\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\t\"date-euro-desc\": (a, b) => {\n\t\t\t\treturn b - a;\n\t\t\t},\n\n\t\t\t// datetime-euro column sorter\n\t\t\t\"datetime-euro-pre\": (a) => {\n\t\t\t\tconst trimmed = $.trim(a);\n\t\t\t\tlet x;\n\t\t\t\tif (trimmed !== '') {\n\t\t\t\t\tconst frDateTime = trimmed.split(' - ');\n\t\t\t\t\tconst frDate = frDateTime[0].split('/');\n\t\t\t\t\tconst frTime = frDateTime[1].split(':');\n\t\t\t\t\tx = (frDate[2] + frDate[1] + frDate[0] + frTime[0] + frTime[1]) * 1;\n\t\t\t\t} else {\n\t\t\t\t\tx = 100000000000; // = l'an 1000 ...\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t},\n\t\t\t\"datetime-euro-asc\": (a, b) => {\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\t\"datetime-euro-desc\": (a, b) => {\n\t\t\t\treturn b - a;\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Store reorder source before reorder\n\t *\n\t * @param evt: original event\n\t * @param node: source node\n\t */\n\tpreReorder: function(evt, node) {\n\t\tconst table = $(evt.target);\n\t\ttable.data('ams-reorder-source', node);\n\t},\n\n\t/**\n\t * Handle table rows reordering\n\t *\n\t * @param evt: original event\n\t */\n\treorderRows: function(evt) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst\n\t\t\t\ttable = $(evt.target),\n\t\t\t\tdata = table.data();\n\t\t\t// extract target and URL\n\t\t\tlet target = data.amsReorderInputTarget,\n\t\t\t\turl = data.amsReorderUrl,\n\t\t\t\tids;\n\t\t\tif (!(target || url)) {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\t// extract reordered rows IDs\n\t\t\tconst\n\t\t\t\trows = $('tbody tr', table),\n\t\t\t\tgetter = MyAMS.core.getFunctionByName(data.amsReorderData) || 'data-ams-row-value';\n\t\t\tif (typeof getter === 'function') {\n\t\t\t\tids = $.makeArray(rows).map(getter);\n\t\t\t} else {\n\t\t\t\tids = rows.listattr(getter);\n\t\t\t}\n\t\t\t// set target input value (if any)\n\t\t\tconst separator = data.amsReorderSeparator || ';';\n\t\t\tif (target) {\n\t\t\t\ttarget = $(target);\n\t\t\t\tif (target.exists()) {\n\t\t\t\t\ttarget.val(ids.join(separator));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tids = ids.join(separator);\n\t\t\t}\n\t\t\t// call target URL (if any)\n\t\t\tif (url) {\n\t\t\t\turl = MyAMS.core.executeFunctionByName(url, document, table) || url;\n\t\t\t\tif (!(url.startsWith(window.location.protocol) || url.startsWith('/'))) {\n\t\t\t\t\tconst location = table.data('ams-location');\n\t\t\t\t\turl = `${location || ''}/${url}`;\n\t\t\t\t}\n\t\t\t\tif (ids.length > 0) {\n\t\t\t\t\tlet postData;\n\t\t\t\t\tif (data.amsReorderPostData) {\n\t\t\t\t\t\tpostData = MyAMS.core.executeFunctionByName(data.amsReorderPostData,\n\t\t\t\t\t\t\tdocument, table, ids);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst attr = data.amsReorderPostAttr || 'order';\n\t\t\t\t\t\tpostData = {};\n\t\t\t\t\t\tpostData[attr] = ids;\n\t\t\t\t\t}\n\t\t\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\t\t\tMyAMS.ajax.post(url, postData).then((result, status, xhr) => {\n\t\t\t\t\t\t\tconst callback = data.amsReorderCallback;\n\t\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(callback, document,\n\t\t\t\t\t\t\t\t\ttable, result, status, xhr).then((...results) => {\n\t\t\t\t\t\t\t\t\tresolve.apply(table, ...results);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tMyAMS.ajax\n\t\t\t\t\t\t\t\t\t.handleJSON(result, table.parents('.dataTables_wrapper'))\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n\nexport function datatables(element) {\n\tconst\n\t\tbaseJS = `${MyAMS.env.baseURL}../ext/datatables/`,\n\t\tbaseCSS = `${MyAMS.env.baseURL}../../css/ext/datatables/`;\n\treturn new Promise((resolve, reject) => {\n\t\tconst tables = $('.datatable', element);\n\t\tif (tables.length > 0) {\n\t\t\tMyAMS.ajax.check($.fn.dataTable,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/datatables/dataTables${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\tconst required = [];\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\trequired.push(MyAMS.core.getScript(`${baseJS}dataTables-bootstrap4${MyAMS.env.extext}.js`));\n\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${baseCSS}dataTables-bootstrap4${MyAMS.env.extext}.css`, 'datatables-bs4'));\n\t\t\t\t}\n\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tcss = {},\n\t\t\t\t\t\tbases = [],\n\t\t\t\t\t\textensions = [],\n\t\t\t\t\t\tdepends = [],\n\t\t\t\t\t\tloaded = {};\n\t\t\t\t\ttables.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\ttable = $(elt),\n\t\t\t\t\t\t\tdata = table.data();\n\t\t\t\t\t\tif (data.buttons === 'default') {\n\t\t\t\t\t\t\ttable.attr('data-buttons', '[\"copy\", \"print\"]');\n\t\t\t\t\t\t\ttable.removeData('buttons');\n\t\t\t\t\t\t\tdata.buttons = table.data('buttons');\n\t\t\t\t\t\t} else if (data.buttons === 'all') {\n\t\t\t\t\t\t\ttable.attr('data-buttons', '[\"copy\", \"csv\", \"excel\", \"print\", \"pdf\", \"colvis\"]');\n\t\t\t\t\t\t\ttable.removeData('buttons');\n\t\t\t\t\t\t\tdata.buttons = table.data('buttons');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.autoFill && !loaded.autoFill && !$.fn.dataTable.AutoFill) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}autoFill${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}autoFill-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-autofill-bs4'] = `${baseCSS}autoFill-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.autoFill = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.buttons) {\n\t\t\t\t\t\t\tif (!loaded.buttons && !$.fn.dataTable.Buttons) {\n\t\t\t\t\t\t\t\tbases.push(`${baseJS}buttons${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}buttons-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}buttons-html5${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\tcss['dt-buttons-bs4'] = `${baseCSS}buttons-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\t\tloaded.buttons = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ($.isArray(data.buttons)) {\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('print') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_print && !$.fn.dataTable.ext.buttons.print) {\n\t\t\t\t\t\t\t\t\t\tdepends.push(`${baseJS}buttons-print${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_print = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('excel') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_excel && !$.fn.dataTable.ext.buttons.excelHtml5) {\n\t\t\t\t\t\t\t\t\t\tbases.push(`${baseJS}jszip${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_excel = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('pdf') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_pdf && !window.pdfMake) {\n\t\t\t\t\t\t\t\t\t\tbases.push(`${baseJS}pdfmake${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\textensions.push(`${baseJS}vfs_fonts${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_pdf = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('colvis') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_colvis && !$.fn.dataTable.ext.buttons.colvis) {\n\t\t\t\t\t\t\t\t\t\tdepends.push(`${baseJS}buttons-colVis${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_colvis = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.colReorder && !loaded.colReorder && !$.fn.dataTable.ColReorder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}colReorder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}colReorder-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-colreorder-bs4'] = `${baseCSS}colReorder-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.colReorder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.fixedColumns && !loaded.fixedColumns && !$.fn.dataTable.FixedColumns) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}fixedColumns${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}fixedColumns-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-fixedcolumns-bs4'] = `${baseCSS}fixedColumns-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.fixedColumns = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.fixedHeader && !loaded.fixedHeader && !$.fn.dataTable.FixedHeader) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}fixedHeader${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}fixedHeader-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-fixedheader-bs4'] = `${baseCSS}fixedHeader-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.fixedHeader = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.keyTable && !loaded.keyTable && !$.fn.dataTable.KeyTable) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}keyTable${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}keyTable-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-keytable-bs4'] = `${baseCSS}keyTable-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.keyTable = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((data.responsive !== false) && !loaded.responsive && !$.fn.dataTable.Responsive) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}responsive${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}responsive-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-responsive-bs4'] = `${baseCSS}responsive-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.responsive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.rowGroup && !loaded.rowGroup && !$.fn.dataTable.RowGroup) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}rowGroup${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}rowGroup-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-rowgroup-bs4'] = `${baseCSS}rowGroup-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.rowGroup = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.rowReorder && !loaded.rowReorder && !$.fn.dataTable.RowReorder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}rowReorder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}rowReorder-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-rowreorder-bs4'] = `${baseCSS}rowReorder-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.rowReorder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.scroller && !loaded.scroller && !$.fn.dataTable.Scroller) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}scroller${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}scroller-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-scroller-bs4'] = `${baseCSS}scroller-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.scroller = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.searchBuilder && !loaded.searchBuilder && !$.fn.dataTable.SearchBuilder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}searchBuilder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}searchBuilder-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-searchbuilder-bs4'] = `${baseCSS}searchBuilder-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.searchBuilder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.searchPanes && !loaded.searchPanes && !$.fn.dataTable.SearchPanes) {\n\t\t\t\t\t\t\tif (!loaded.select && !$.fn.dataTable.select) {\n\t\t\t\t\t\t\t\tbases.push(`${baseJS}select${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}select-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\tcss['dt-select-bs4'] = `${baseCSS}select-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\t\tloaded.select = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\textensions.push(`${baseJS}searchPanes${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tdepends.push(`${baseJS}searchPanes-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-searchpanes-bs4'] = `${baseCSS}searchPanes-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.searchPanes = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.select && !loaded.select && !$.fn.dataTable.select) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}select${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}select-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-select-bs4'] = `${baseCSS}select-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.select = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$.when.apply($, bases.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\treturn $.when.apply($, extensions.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\t\treturn $.when.apply($, depends.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\t\t\t\t_datatablesHelpers.init();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (const [name, url] of Object.entries(css)) {\n\t\t\t\t\t\t\t\t\tMyAMS.core.getCSS(url, name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttables.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\tconst table = $(elt);\n\t\t\t\t\t\t\t\t\tif ($.fn.dataTable.isDataTable(table)) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst data = table.data();\n\n\t\t\t\t\t\t\t\t\t// initialize dom property\n\t\t\t\t\t\t\t\t\tlet dom = data.amsDatatableDom || data.amsDom || data.dom || '';\n\t\t\t\t\t\t\t\t\tif (!dom) {\n\t\t\t\t\t\t\t\t\t\tif (data.buttons) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"B\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searchBuilder) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"Q\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searchPanes) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"P\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searching !== false || data.lengthChange !== false) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-2'\";\n\t\t\t\t\t\t\t\t\t\t\tif (data.searching !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-6 col-md-8'f>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (data.lengthChange !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-6 col-md-4'l>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdom += \">\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdom += \"<'row'<'col-sm-12'tr>>\";\n\t\t\t\t\t\t\t\t\t\tif (data.info !== false || data.paging !== false) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-2 py-1'\";\n\t\t\t\t\t\t\t\t\t\t\tif (data.info !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-12 col-md-5'i>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (data.paging !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-12 col-md-7'p>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdom += \">\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!data.buttons && !data.searchBuilder && !data.searchPanes &&\n\t\t\t\t\t\t\t\t\t\t(data.searching === false) || (data.lengthChange === false)) {\n\t\t\t\t\t\t\t\t\t\ttable.siblings('h3').addClass('mb-0');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// initialize default options\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\t\t\tlanguage: data.amsDatatableLanguage || data.amsLanguage ||\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.i18n.plugins.datatables,\n\t\t\t\t\t\t\t\t\t\t\tresponsive: true,\n\t\t\t\t\t\t\t\t\t\t\tdom: dom\n\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t// initialize sorting\n\t\t\t\t\t\t\t\t\tlet order = data.amsDatatableOrder || data.amsOrder;\n\t\t\t\t\t\t\t\t\tif (typeof order === 'string') {\n\t\t\t\t\t\t\t\t\t\tconst orders = order.split(';');\n\t\t\t\t\t\t\t\t\t\torder = [];\n\t\t\t\t\t\t\t\t\t\tfor (const col of orders) {\n\t\t\t\t\t\t\t\t\t\t\tconst colOrder = col.split(',');\n\t\t\t\t\t\t\t\t\t\t\tcolOrder[0] = parseInt(colOrder[0]);\n\t\t\t\t\t\t\t\t\t\t\torder.push(colOrder);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (order) {\n\t\t\t\t\t\t\t\t\t\tdefaultOptions.order = order;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// initialize columns definition based on header settings\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\theads = $('thead th', table),\n\t\t\t\t\t\t\t\t\t\tcolumns = [];\n\t\t\t\t\t\t\t\t\theads.each((idx, th) => {\n\t\t\t\t\t\t\t\t\t\tcolumns[idx] = $(th).data('ams-column') || {};\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tconst sortables = heads.listattr('data-ams-sortable');\n\t\t\t\t\t\t\t\t\tfor (const iterator of sortables.entries()) {\n\t\t\t\t\t\t\t\t\t\tconst [idx, sortable] = iterator;\n\t\t\t\t\t\t\t\t\t\tif (sortable !== undefined) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].sortable =\n\t\t\t\t\t\t\t\t\t\t\t\ttypeof sortable === 'string' ? JSON.parse(sortable) : sortable;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst types = heads.listattr('data-ams-type');\n\t\t\t\t\t\t\t\t\tfor (const iterator of types.entries()) {\n\t\t\t\t\t\t\t\t\t\tconst [idx, stype] = iterator;\n\t\t\t\t\t\t\t\t\t\tif (stype !==  undefined) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].type = stype;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdefaultOptions.columns = columns;\n\n\t\t\t\t\t\t\t\t\t// initialize final settings and initialize plug-in\n\t\t\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsDatatableOptions || data.amsOptions);\n\t\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsDatatableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\t\t\tdocument, table, settings) || settings;\n\t\t\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\t\t\ttable.trigger('before-init.ams.datatable', [table, settings, veto]);\n\t\t\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst plugin = table.DataTable(settings);\n\t\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsDatatableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\t\tdocument, table, plugin, settings);\n\t\t\t\t\t\t\t\t\ttable.trigger('after-init.ams.datatable', [table, plugin]);\n\n\t\t\t\t\t\t\t\t\t// set reorder events\n\t\t\t\t\t\t\t\t\tif (settings.rowReorder) {\n\t\t\t\t\t\t\t\t\t\tplugin.on('pre-row-reorder', MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatablePreReorder || data.amsPreReorder) ||\n\t\t\t\t\t\t\t\t\t\t\t_datatablesHelpers.preReorder);\n\t\t\t\t\t\t\t\t\t\tplugin.on('row-reorder', MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatableReordered || data.amsReordered) ||\n\t\t\t\t\t\t\t\t\t\t\t_datatablesHelpers.reorderRows);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tresolve(tables);\n\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap 4 Tempus/Dominus date/time picker\n */\n\nexport function datetime(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.datetime', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.ajax.check(window.moment,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/moment${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.datetimepicker,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/tempusdominus-bootstrap4${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/tempusdominus-bootstrap4${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'tempusdominus'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\t\tdata = input.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tlocale: data.amsDatetimeLanguage || data.amsLanguage || MyAMS.i18n.language,\n\t\t\t\t\t\t\t\t\ticons: {\n\t\t\t\t\t\t\t\t\t\ttime: 'far fa-clock',\n\t\t\t\t\t\t\t\t\t\tdate: 'far fa-calendar',\n\t\t\t\t\t\t\t\t\t\tup: 'fas fa-arrow-up',\n\t\t\t\t\t\t\t\t\t\tdown: 'fas fa-arrow-down',\n\t\t\t\t\t\t\t\t\t\tprevious: 'fas fa-chevron-left',\n\t\t\t\t\t\t\t\t\t\tnext: 'fas fa-chevron-right',\n\t\t\t\t\t\t\t\t\t\ttoday: 'far fa-calendar-check-o',\n\t\t\t\t\t\t\t\t\t\tclear: 'far fa-trash',\n\t\t\t\t\t\t\t\t\t\tclose: 'far fa-times'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tdate: input.val(),\n\t\t\t\t\t\t\t\t\tformat: data.amsDatetimeFormat || data.amsFormat\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.datetimeOptions || data.options);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDatetimeInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, input, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tinput.trigger('before-init.ams.datetime', [input, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinput.datetimepicker(settings);\n\t\t\t\t\t\t\tconst plugin = input.data('datetimepicker');\n\t\t\t\t\t\t\tif (data.amsDatetimeIsoTarget || data.amsIsoTarget) {\n\t\t\t\t\t\t\t\tinput.on('change.datetimepicker', (evt) => {\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tsource = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\tdata = source.data(),\n\t\t\t\t\t\t\t\t\t\ttarget = $(data.amsDatetimeIsoTarget || data.amsIsoTarget);\n\t\t\t\t\t\t\t\t\ttarget.val(evt.date ? evt.date.toISOString(true) : null);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinput.trigger('after-init.ams.datetime', [input, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}, reject).then(() => {\n\t\t\t\t\tresolve(inputs);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * JQuery-UI drag and drop plug-ins\n */\n\nexport function dragdrop(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst dragitems = $('.draggable, .droppable, .sortable, .resizable', element);\n\t\tif (dragitems.length > 0) {\n\t\t\tMyAMS.ajax.check($.fn.draggable,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tMyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/jquery-ui.structure${MyAMS.env.extext}.css`, 'jquery-ui').then(() => {\n\t\t\t\t\tdragitems.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\titem = $(elt),\n\t\t\t\t\t\t\tdata = item.data();\n\t\t\t\t\t\t// draggable components\n\t\t\t\t\t\tif (item.hasClass('draggable')) {\n\t\t\t\t\t\t\tconst dragOptions = {\n\t\t\t\t\t\t\t\tcursor: data.amsDraggableCursor || 'move',\n\t\t\t\t\t\t\t\tcontainment: data.amsDraggableContainment,\n\t\t\t\t\t\t\t\thandle: data.amsDraggableHandle,\n\t\t\t\t\t\t\t\tconnectToSortable: data.amsDraggableConnectSortable,\n\t\t\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsDraggableHelper) || data.amsDraggableHelper,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsDraggableStart),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsDraggableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dragOptions,\n\t\t\t\t\t\t\t\tdata.amsDraggableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDraggableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.draggable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.draggable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDraggableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.draggable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// droppable components\n\t\t\t\t\t\tif (item.hasClass('droppable')) {\n\t\t\t\t\t\t\tconst dropOptions = {\n\t\t\t\t\t\t\t\taccept: data.amsDroppableAccept || data.amsAccept,\n\t\t\t\t\t\t\t\tdrop: MyAMS.core.getFunctionByName(data.amsDroppableDrop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dropOptions,\n\t\t\t\t\t\t\t\tdata.amsDroppableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDroppableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.droppable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.droppable(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDroppableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.droppable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// sortable components\n\t\t\t\t\t\tif (item.hasClass('sortable')) {\n\t\t\t\t\t\t\tconst sortOptions = {\n\t\t\t\t\t\t\t\titems: data.amsSortableItems,\n\t\t\t\t\t\t\t\thandle: data.amsSortableHandle,\n\t\t\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsSortableHelper) || data.amsSortableHelper,\n\t\t\t\t\t\t\t\tconnectWith: data.amsSortableConnectwith,\n\t\t\t\t\t\t\t\tcontainment: data.amsSortableContainment,\n\t\t\t\t\t\t\t\tplaceholder: data.amsSortablePlaceholder,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsSortableStart),\n\t\t\t\t\t\t\t\tover: MyAMS.core.getFunctionByName(data.amsSortableOver),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsSortableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, sortOptions,\n\t\t\t\t\t\t\t\tdata.amsSortableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSortableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.sortable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.sortable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSortableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.sortable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// resizable components\n\t\t\t\t\t\tif (item.hasClass('resizable')) {\n\t\t\t\t\t\t\tconst resizeOptions = {\n\t\t\t\t\t\t\t\tautoHide: data.amsResizableAutohide === false ? true : data.amsResizableAutohide,\n\t\t\t\t\t\t\t\tcontainment: data.amsResizableContainment,\n\t\t\t\t\t\t\t\tgrid: data.amsResizableGrid,\n\t\t\t\t\t\t\t\thandles: data.amsResizableHandles,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsResizableStart),\n\t\t\t\t\t\t\t\tresize: MyAMS.core.getFunctionByName(data.amsResizableResize),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsResizableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, resizeOptions,\n\t\t\t\t\t\t\t\tdata.amsResizableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsResizableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.resizable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.resizable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsResizableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.resizable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, reject).then(() => {\n\t\t\t\tresolve(dragitems);\n\t\t\t});\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * ACE text editor\n */\n\nexport function editor(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst editors = $('.editor textarea', element);\n\t\tif (editors.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check(window.ace,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/ace/ace${MyAMS.env.extext}.js`).then((firstLoad) => {\n\n\t\t\t\t\tconst\n\t\t\t\t\t\tace = window.ace,\n\t\t\t\t\t\tdeferred = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\tace.config.set('basePath', `${MyAMS.env.baseURL}../ext/ace`);\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/ace/ext-modelist${MyAMS.env.extext}.js`));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, deferred).then(() => {\n\t\t\t\t\t\teditors.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\ttextarea = $(elt),\n\t\t\t\t\t\t\t\twidget = textarea.parents('.editor'),\n\t\t\t\t\t\t\t\tdata = textarea.data(),\n\t\t\t\t\t\t\t\tmodeList = ace.require('ace/ext/modelist'),\n\t\t\t\t\t\t\t\tmode = data.amsEditorMode || data.amsMode ||\n\t\t\t\t\t\t\t\t\tmodeList.getModeForPath(data.amsEditorFilename || data.amsFilename || 'text.txt').mode;\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t// create editor DIV\n\t\t\t\t\t\t\t\tconst textEditor = $('<div>', {\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\twidth: textarea.width(),\n\t\t\t\t\t\t\t\t\theight: textarea.height(),\n\t\t\t\t\t\t\t\t\t'class': textarea.attr('class')\n\t\t\t\t\t\t\t\t}).insertBefore(textarea);\n\t\t\t\t\t\t\t\ttextarea.css('display', 'none');\n\t\t\t\t\t\t\t\t// initialize editor\n\t\t\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\t\t\tmode: mode,\n\t\t\t\t\t\t\t\t\tfontSize: 12,\n\t\t\t\t\t\t\t\t\ttabSize: 4,\n\t\t\t\t\t\t\t\t\tuseSoftTabs: false,\n\t\t\t\t\t\t\t\t\tshowGutter: true,\n\t\t\t\t\t\t\t\t\tshowLineNumbers: true,\n\t\t\t\t\t\t\t\t\tprintMargin: 132,\n\t\t\t\t\t\t\t\t\tshowInvisibles: true\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsEditorOptions || data.amsOptions);\n\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsEditorInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\t\tdocument, textarea, settings) || settings;\n\t\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\t\ttextarea.trigger('before-init.ams.editor', [textarea, settings, veto]);\n\t\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst editor = ace.edit(textEditor[0]);\n\t\t\t\t\t\t\t\teditor.setOptions(settings);\n\t\t\t\t\t\t\t\tif (MyAMS.theme === 'darkmode') {\n\t\t\t\t\t\t\t\t\teditor.setTheme('ace/theme/dracula');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\teditor.setTheme('ace/theme/textmate');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\teditor.session.setValue(textarea.val());\n\t\t\t\t\t\t\t\teditor.session.on('change', () => {\n\t\t\t\t\t\t\t\t\ttextarea.val(editor.session.getValue());\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twidget.data('editor', editor);\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsEditorAfterEditCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\tdocument, textarea, editor, settings);\n\t\t\t\t\t\t\t\ttextarea.trigger('after-init.ams.editor', [textarea, editor]);\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, reject).then(() => {\n\t\t\t\tresolve(editors);\n\t\t\t})\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap custom file input manager\n */\n\nexport function fileInput(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.custom-file-input', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check(window.bsCustomFileInput,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bs-custom-file-input${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\tinputId = input.attr('id'),\n\t\t\t\t\t\t\tinputSelector = inputId ? `#${inputId}` : input.attr('name'),\n\t\t\t\t\t\t\tform = $(elt.form),\n\t\t\t\t\t\t\tformId = form.attr('id'),\n\t\t\t\t\t\t\tformSelector = formId ? `#${formId}` : form.attr('name'),\n\t\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\t\tinput.trigger('before-init.ams.fileinput', [input, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbsCustomFileInput.init(inputSelector, formSelector);\n\t\t\t\t\t\tinput.trigger('after-init.ams.fileinput', [input]);\n\t\t\t\t\t});\n\t\t\t\t}, reject).then(() => {\n\t\t\t\t\tresolve(inputs);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Image area select plug-in integration\n */\n\nexport function imgAreaSelect(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst images = $('.imgareaselect', element);\n\t\tif (images.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.imgAreaSelect,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-imgareaselect${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/imgareaselect-animated${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'imgareaselect'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\timages.each((idx, elt) => {\n\t\t\t\t\t\t\tconst image = $(elt);\n\t\t\t\t\t\t\tif (image.data('imgAreaSelect')) {\n\t\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tdata = image.data(),\n\t\t\t\t\t\t\t\tparentSelector = data.amsImgareaselectParent || data.amsParent,\n\t\t\t\t\t\t\t\tparent = parentSelector ? image.parents(parentSelector) : 'body',\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tinstance: true,\n\t\t\t\t\t\t\t\t\thandles: true,\n\t\t\t\t\t\t\t\t\tparent: parent,\n\t\t\t\t\t\t\t\t\tx1: data.amsImgareaselectX1 || data.amsX1 || 0,\n\t\t\t\t\t\t\t\t\ty1: data.amsImgareaselectY1 || data.amsY1 || 0,\n\t\t\t\t\t\t\t\t\tx2: data.amsImgareaselectX2 || data.amsX2 ||\n\t\t\t\t\t\t\t\t\t\tdata.amsImgareaselectImageWidth || data.amsImageWidth,\n\t\t\t\t\t\t\t\t\ty2: data.amsImgareaselectY2 || data.amsY2 ||\n\t\t\t\t\t\t\t\t\t\tdata.amsImgareaselectImageHeight || data.amsImageHeight,\n\t\t\t\t\t\t\t\t\timageWidth: data.amsImgareaselectImageWidth || data.amsImageWidth,\n\t\t\t\t\t\t\t\t\timageHeight: data.amsImgareaselectImageHeight || data.amsImageHeight,\n\t\t\t\t\t\t\t\t\timgWidth: data.amsImgareaselectThumbWidth || data.amsThumbWidth,\n\t\t\t\t\t\t\t\t\timgHeight: data.amsImgareaselectThumbHeight || data.amsThumbHeight,\n\t\t\t\t\t\t\t\t\tminWidth: 128,\n\t\t\t\t\t\t\t\t\tminHeight: 128,\n\t\t\t\t\t\t\t\t\taspectRatio: data.amsImgareaselectAspectRatio || data.amsAspectRatio,\n\t\t\t\t\t\t\t\t\tonSelectEnd: MyAMS.core.getFunctionByName(data.amsImgareaselectSelectEnd || data.amsSelectedEnd) || function(img, selection) {\n\t\t\t\t\t\t\t\t\t\tconst target = data.amsImgareaselectTargetField || data.amsTargetField || 'image_';\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}x1\"]`, parent).val(selection.x1);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}y1\"]`, parent).val(selection.y1);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}x2\"]`, parent).val(selection.x2);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}y2\"]`, parent).val(selection.y2);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsImgareaselectOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsImgareaselectInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, image, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\timage.trigger('before-init.ams.imgareaselect', [image, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// add timeout to update plug-in if displayed into a modal dialog\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst plugin = image.imgAreaSelect(settings);\n\t\t\t\t\t\t\t\timage.trigger('after-init.ams.imgareaselect', [image, plugin]);\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, reject).then(() => {\n\t\t\t\t\t\tresolve(images);\n\t\t\t\t\t})\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Select2 plug-in integration\n */\n\nconst _select2Helpers = {\n\n\tselect2UpdateHiddenField: (input) => {\n\t\tconst values = [];\n\t\tinput.parent().find('ul.select2-selection__rendered').children('li[title]').each((idx, elt) => {\n\t\t\tvalues.push(input.children(`option[data-content=\"${elt.title}\"]`).attr('value'));\n\t\t});\n\t\tinput.data('select2-target').val(values.join(input.data('ams-select2-separator') || ','));\n\t},\n\n\tselect2AjaxParamsHelper: (params, data) => {\n\t\treturn Object.assign({}, params, data);\n\t}\n};\n\nexport function select2(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst selects = $('.select2', element);\n\t\tif (selects.length > 0) {\n\t\t\tMyAMS.require('ajax', 'helpers').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.select2,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/select2/select2${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/select2/i18n/${MyAMS.i18n.language}.js`));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tselects.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tselect = $(elt),\n\t\t\t\t\t\t\t\tdata = select.data();\n\t\t\t\t\t\t\tif (data.select2) {\n\t\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\t\ttheme: data.amsSelect2Theme || data.amsTheme || 'bootstrap4',\n\t\t\t\t\t\t\t\tlanguage: data.amsSelect2Language || data.amsLanguage || MyAMS.i18n.language,\n\t\t\t\t\t\t\t\tescapeMarkup: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2EscapeMarkup || data.amsEscapeMarkup),\n\t\t\t\t\t\t\t\tmatcher: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Matcher || data.amsMatcher),\n\t\t\t\t\t\t\t\tsorter: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Sorter || data.amsSorter),\n\t\t\t\t\t\t\t\ttemplateResult: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2TemplateResult || data.amsTemplateResult),\n\t\t\t\t\t\t\t\ttemplateSelection: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2TemplateSelection || data.amsTemplateSelection),\n\t\t\t\t\t\t\t\ttokenizer: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Tokenizer || data.amsTokenizer)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst ajaxUrl = data.amsSelect2AjaxUrl || data.amsAjaxUrl || data['ajax-Url'];\n\t\t\t\t\t\t\tif (ajaxUrl) {\n\t\t\t\t\t\t\t\t// check AJAX data helper function\n\t\t\t\t\t\t\t\tlet ajaxParamsHelper;\n\t\t\t\t\t\t\t\tconst ajaxParams = MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxParams || data.amsAjaxParams || data['ajax-Params']) ||\n\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxParams || data.amsAjaxParams || data['ajax-Params'];\n\t\t\t\t\t\t\t\tif (typeof ajaxParams === 'function') {\n\t\t\t\t\t\t\t\t\tajaxParamsHelper = ajaxParams;\n\t\t\t\t\t\t\t\t} else if (ajaxParams) {\n\t\t\t\t\t\t\t\t\tajaxParamsHelper = (params) => {\n\t\t\t\t\t\t\t\t\t\treturn _select2Helpers.select2AjaxParamsHelper(params, ajaxParams);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdefaultOptions.ajax = {\n\t\t\t\t\t\t\t\t\turl: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxUrl || data.amsAjaxUrl) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxUrl || data.amsAjaxUrl,\n\t\t\t\t\t\t\t\t\tdata: ajaxParamsHelper || MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxData || data.amsAjaxData) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxData || data.amsAjaxData,\n\t\t\t\t\t\t\t\t\tprocessResults: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxProcessResults || data.amsAjaxProcessResults) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxProcessResults || data.amsAjaxProcessResults,\n\t\t\t\t\t\t\t\t\ttransport: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxTransport || data.amsAjaxTransport) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxTransport || data.amsAjaxTransport\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tdefaultOptions.minimumInputLength = data.amsSelect2MinimumInputLength ||\n\t\t\t\t\t\t\t\t\tdata.amsMinimumInputLength || data.minimumInputLength || 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t\t// create hidden input for sortable selections\n\t\t\t\t\t\t\t\tconst hidden = $(`<input type=\"hidden\" name=\"${select.attr('name')}\">`).insertAfter(select);\n\t\t\t\t\t\t\t\thidden.val($('option:selected', select).listattr('value').join(data.amsSelect2Separator || ','));\n\t\t\t\t\t\t\t\tselect.data('select2-target', hidden)\n\t\t\t\t\t\t\t\t\t.removeAttr('name');\n\t\t\t\t\t\t\t\tdefaultOptions.templateSelection = (data) => {\n\t\t\t\t\t\t\t\t\tconst elt = $(data.element);\n\t\t\t\t\t\t\t\t\telt.attr('data-content', elt.html());\n\t\t\t\t\t\t\t\t\treturn data.text;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsSelect2Options || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSelect2InitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, select, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tselect.trigger('before-init.ams.select2', [select, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = select.select2(settings);\n\t\t\t\t\t\t\tselect.on('select2:opening select2:selecting select2:unselecting select2:clearing', (evt) => {\n\t\t\t\t\t\t\t\t// handle disabled selects\n\t\t\t\t\t\t\t\tif ($(evt.target).is(':disabled')) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tselect.on('select2:opening', (evt) => {\n\t\t\t\t\t\t\t\t// handle z-index in modals\n\t\t\t\t\t\t\t\tconst modal = $(evt.currentTarget).parents('.modal').first();\n\t\t\t\t\t\t\t\tif (modal.exists()) {\n\t\t\t\t\t\t\t\t\tconst zIndex = parseInt(modal.css('z-index'));\n\t\t\t\t\t\t\t\t\tplugin.data('select2').$dropdown.css('z-index', zIndex + 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tselect.on('select2:open', () => {\n\t\t\t\t\t\t\t\t// handle dropdown automatic focus\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t$('.select2-search__field', plugin.data('select2').$dropdown).get(0).focus();\n\t\t\t\t\t\t\t\t}, 50);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t\tMyAMS.ajax.check($.fn.sortable,\n\t\t\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t\t\t\tselect.parent().find('ul.select2-selection__rendered').sortable({\n\t\t\t\t\t\t\t\t\t\tcontainment: 'parent',\n\t\t\t\t\t\t\t\t\t\tupdate: () => {\n\t\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(select);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tselect.on('select2:select select2:unselect', (evt) => {\n\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\tid = evt.params.data.id,\n\t\t\t\t\t\t\t\t\t\t\ttarget = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\t\toption = target.children(`option[value=\"${id}\"]`);\n\t\t\t\t\t\t\t\t\t\tMyAMS.helpers.moveElementToParentEnd(option);\n\t\t\t\t\t\t\t\t\t\ttarget.trigger('change');\n\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(target);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSelect2AfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, select, plugin, settings);\n\t\t\t\t\t\t\tselect.trigger('after-init.ams.select2', [select, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, reject).then(() => {\n\t\t\t\t\t\tresolve(selects);\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * SVG image plug-in\n */\n\nexport function svgPlugin(element) {\n\treturn new Promise((resolve) => {\n\t\tconst svgs = $('.svg-container', element);\n\t\tif (svgs.length > 0) {\n\t\t\tsvgs.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tcontainer = $(elt),\n\t\t\t\t\tsvg = $('svg', container),\n\t\t\t\t\twidth = svg.attr('width'),\n\t\t\t\t\theight = svg.attr('height');\n\t\t\t\tif (width && height) {\n\t\t\t\t\telt.setAttribute('viewBox',\n\t\t\t\t\t\t`0 0 ${Math.round(parseFloat(width))} ${Math.round(parseFloat(height))}`);\n\t\t\t\t}\n\t\t\t\tsvg.attr('width', '100%').attr('height', 'auto');\n\t\t\t});\n\t\t\tresolve(svgs);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Fieldset switcher plug-in\n *\n * A switcher is a simple fieldset with a \"switch\" icon in it's legend, which can\n * be used to hide or show fieldset content.\n */\n\nexport function switcher(element) {\n\treturn new Promise((resolve) => {\n\t\tconst switchers = $('legend.switcher', element);\n\t\tif (switchers.length > 0) {\n\t\t\tswitchers.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tlegend = $(elt),\n\t\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\t\tdata = legend.data(),\n\t\t\t\t\tstate = data.amsSwitcherState || data.amsState,\n\t\t\t\t\tminusClass = data.amsSwitcherMinusClass || data.amsMinusClass || 'minus',\n\t\t\t\t\tplusClass = data.amsSwitcherPlusClass || data.amsPlusClass || 'plus';\n\t\t\t\tif (!data.amsSwitcher) {\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\tlegend.trigger('before-init.ams.switcher', [legend, data, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t$(`<i class=\"fa fa-${state === 'open' ? minusClass : plusClass} mr-2\"></i>`)\n\t\t\t\t\t\t.prependTo(legend);\n\t\t\t\t\tlegend.on('click', (evt) => {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\tconst veto = {};\n\t\t\t\t\t\tlegend.trigger('before-switch.ams.switcher', [legend, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fieldset.hasClass('switched')) {\n\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), plusClass, minusClass);\n\t\t\t\t\t\t\tlegend.trigger('opened.ams.switcher', [legend]);\n\t\t\t\t\t\t\tconst id = legend.attr('id');\n\t\t\t\t\t\t\tif (id) {\n\t\t\t\t\t\t\t\t$(`legend.switcher[data-ams-switcher-sync=\"${id}\"]`, fieldset).each((idx, elt) => {\n\t\t\t\t\t\t\t\t\tconst switcher = $(elt);\n\t\t\t\t\t\t\t\t\tif (switcher.parents('fieldset').hasClass('switched')) {\n\t\t\t\t\t\t\t\t\t\tswitcher.click();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), minusClass, plusClass);\n\t\t\t\t\t\t\tlegend.trigger('closed.ams.switcher', [legend]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (state !== 'open') {\n\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t}\n\t\t\t\t\tlegend.trigger('after-init.ams.switcher', [legend]);\n\t\t\t\t\tlegend.data('ams-switcher', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tresolve(switchers);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * TinyMCE HTML editor plug-in\n */\n\nexport function tinymce(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst editors = $('.tinymce', element);\n\t\tif (editors.length > 0) {\n\t\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\t\tconst baseURL = `${MyAMS.env.baseURL}../ext/tinymce${MyAMS.env.devmode ? '/dev': ''}`;\n\t\t\t\tMyAMS.ajax.check(window.tinymce,\n\t\t\t\t\t`${baseURL}/tinymce${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst deferred = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\ttinymce.baseURL = baseURL;\n\t\t\t\t\t\ttinymce.suffix = MyAMS.env.extext;\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(`${baseURL}/jquery.tinymce.min.js`));\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(`${baseURL}/themes/silver/theme${MyAMS.env.extext}.js`));\n\t\t\t\t\t\t// Prevent Bootstrap dialog from blocking focusin\n\t\t\t\t\t\t$(document).on('focusin', (evt) => {\n\t\t\t\t\t\t\tif ($(evt.target).closest(\".tox-tinymce, .tox-tinymce-aux, \" +\n\t\t\t\t\t\t\t\t\".moxman-window, .tam-assetmanager-root\").length) {\n\t\t\t\t\t\t\t\tevt.stopImmediatePropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Remove editor before cleaning content\n\t\t\t\t\t\t$(document).on('clear.ams.content', (evt, veto, element) => {\n\t\t\t\t\t\t\t$('.tinymce', element).each((idx, elt) => {\n\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\teditorId = $(elt).attr('id'),\n\t\t\t\t\t\t\t\t\teditor = window.tinymce.get(editorId);\n\t\t\t\t\t\t\t\tif (editor !== null) {\n\t\t\t\t\t\t\t\t\teditor.remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, deferred).then(() => {\n\t\t\t\t\t\teditors.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\teditor = $(elt),\n\t\t\t\t\t\t\t\tdata = editor.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tselector: `textarea#${editor.attr('id')}`,\n\t\t\t\t\t\t\t\t\tbase_url: baseURL,\n\t\t\t\t\t\t\t\t\ttheme: data.amsTinymceTheme || data.amsTheme || 'silver',\n\t\t\t\t\t\t\t\t\tlanguage: MyAMS.i18n.language,\n\t\t\t\t\t\t\t\t\tmenubar: (data.amsTinymceMenubar !== false) && (data.amsMenubar !== false),\n\t\t\t\t\t\t\t\t\tstatusbar: (data.amsTinymceStatusbar !== false) && (data.amsStatusbar !== false),\n\t\t\t\t\t\t\t\t\tplugins: data.amsTinymcePlugins || data.amsPlugins || [\n\t\t\t\t\t\t\t\t\t\t\"advlist autosave autolink lists link charmap print preview hr anchor pagebreak\",\n\t\t\t\t\t\t\t\t\t\t\"searchreplace wordcount visualblocks visualchars code fullscreen\",\n\t\t\t\t\t\t\t\t\t\t\"insertdatetime nonbreaking save table contextmenu directionality\",\n\t\t\t\t\t\t\t\t\t\t\"emoticons paste textcolor colorpicker textpattern autoresize\"\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ttoolbar: data.amsTinymceToolbar || data.amsToolbar,\n\t\t\t\t\t\t\t\t\ttoolbar1: ((data.amsTinymceToolbar1 === false) || (data.amsToolbar1 === false)) ? false :\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceToolbar1 || data.amsToolbar1 ||\n\t\t\t\t\t\t\t\t\t\t\"undo redo | pastetext | styleselect | bold italic | \" +\n\t\t\t\t\t\t\t\t\t\t\"alignleft aligncenter alignright alignjustify | \" +\n\t\t\t\t\t\t\t\t\t\t\"bullist numlist outdent indent\",\n\t\t\t\t\t\t\t\t\ttoolbar2: ((data.amsTinymceToolbar2 === false) || (data.amsToolbar2 === false)) ? false :\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceToolbar2 || data.amsToolbar2 ||\n\t\t\t\t\t\t\t\t\t\t\"forecolor backcolor emoticons | charmap link image media | \" +\n\t\t\t\t\t\t\t\t\t\t\"fullscreen preview print | code\",\n\t\t\t\t\t\t\t\t\tcontent_css: data.amsTinymceContentCss || data.amsContentCss,\n\t\t\t\t\t\t\t\t\tformats: data.amsTinymceFormats || data.amsFormats,\n\t\t\t\t\t\t\t\t\tstyle_formats: data.amsTinymceStyleFormats || data.amsStyleFormats,\n\t\t\t\t\t\t\t\t\tblock_formats: data.amsTinymceBlockFormats || data.amsBlockFormats,\n\t\t\t\t\t\t\t\t\tvalid_classes: data.amsTinymceValidClasses || data.amsValidClasses,\n\t\t\t\t\t\t\t\t\timage_advtab: true,\n\t\t\t\t\t\t\t\t\timage_list: MyAMS.core.getFunctionByName(data.amsTinymceImageList || data.amsImageList) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceImageList || data.amsImageList,\n\t\t\t\t\t\t\t\t\timage_class_list: data.amsTinymceImageClassList || data.amsImageClassList,\n\t\t\t\t\t\t\t\t\tlink_list: MyAMS.core.getFunctionByName(data.amsTinymceLinkList || data.amsLinkList) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceLinkList || data.amsLinkList,\n\t\t\t\t\t\t\t\t\tlink_class_list: data.amsTinymceLinkClassList || data.amsLinkClassList,\n\t\t\t\t\t\t\t\t\tpaste_as_text: ((data.amsTinymcePasteAsText === undefined) && (data.amsPasteAsText === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteAsText || data.amsPasteAsText,\n\t\t\t\t\t\t\t\t\tpaste_auto_cleanup_on_paste: ((data.amsTinymcePasteAutoCleanup === undefined) && (data.amsPasteAutoCleanup === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteAutoCleanup || data.amsPasteAutoCleanup,\n\t\t\t\t\t\t\t\t\tpaste_strip_class_attributes: data.amsTinymcePasteStripClassAttributes || data.amsPasteStripClassAttributes || 'all',\n\t\t\t\t\t\t\t\t\tpaste_remove_spans: ((data.amsTinymcePasteRemoveSpans === undefined) && (data.amsPasteRemoveSpans === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteRemoveSpans || data.amsPasteRemoveSpans,\n\t\t\t\t\t\t\t\t\tpaste_remove_styles: ((data.amsTinymcePasteRemoveStyles === undefined) || (data.amsPasteRemoveStyles === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteRemoveStyles || data.amsPasteRemoveStyles,\n\t\t\t\t\t\t\t\t\theight: data.amsTinymceHeight || data.amsHeight || 50,\n\t\t\t\t\t\t\t\t\tmin_height: 50,\n\t\t\t\t\t\t\t\t\tresize: true,\n\t\t\t\t\t\t\t\t\tautoresize_min_height: 50,\n\t\t\t\t\t\t\t\t\tautoresize_max_height: 500\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst plugins = data.amsTinymceExternalPlugins || data.amsExternalPlugins;\n\t\t\t\t\t\t\tif (plugins) {\n\t\t\t\t\t\t\t\tconst names = plugins.split(/\\s+/);\n\t\t\t\t\t\t\t\tfor (const name of names) {\n\t\t\t\t\t\t\t\t\tconst src = editor.data(`ams-tinymce-plugin-${name}`) || editor.data(`ams-plugin-${name}`);\n\t\t\t\t\t\t\t\t\twindow.tinymce.PluginManager.load(name, MyAMS.core.getSource(src));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsTinymceOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsTinymceInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, editor, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\teditor.trigger('before-init.ams.tinymce', [editor, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst plugin = editor.tinymce(settings);\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsTinymceAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\tdocument, editor, plugin, settings);\n\t\t\t\t\t\t\t\teditor.trigger('after-init.ams.tinymce', [editor, settings]);\n\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, reject).then(() => {\n\t\t\t\t\t\tresolve(editors);\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap treeview plug-in\n */\n\nexport function treeview(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst trees = $('.treeview', element);\n\t\tif (trees.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.treview,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bootstrap-treeview${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/bootstrap-treeview${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'treeview'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\ttrees.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\ttreeview = $(elt),\n\t\t\t\t\t\t\t\tdata = treeview.data(),\n\t\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\t\tdata: data.amsTreeviewData,\n\t\t\t\t\t\t\t\t\tlevels: data.amsTreeviewLevels,\n\t\t\t\t\t\t\t\t\tinjectStyle: data.amsTreeviewInjectStyle,\n\t\t\t\t\t\t\t\t\texpandIcon: data.amsTreeviewExpandIcon || 'far fa-fw fa-plus-square',\n\t\t\t\t\t\t\t\t\tcollapseIcon: data.amsTreeviewCollaspeIcon || 'far fa-fw fa-minus-square',\n\t\t\t\t\t\t\t\t\temptyIcon: data.amsTreeviewEmptyIcon,\n\t\t\t\t\t\t\t\t\tnodeIcon: data.amsTreeviewNodeIcon,\n\t\t\t\t\t\t\t\t\tselectedIcon: data.amsTreeviewSelectedIcon,\n\t\t\t\t\t\t\t\t\tcheckedIcon: data.amsTreeviewCheckedIcon || 'far fa-fw fa-check-square',\n\t\t\t\t\t\t\t\t\tuncheckedIcon: data.amsTreeviewUncheckedIcon || 'far fa-fw fa-square',\n\t\t\t\t\t\t\t\t\tcolor: data.amsTreeviewColor,\n\t\t\t\t\t\t\t\t\tbackColor: data.amsTreeviewBackColor,\n\t\t\t\t\t\t\t\t\tborderColor: data.amsTreeviewBorderColor,\n\t\t\t\t\t\t\t\t\tonHoverColor: data.amsTreeviewHoverColor,\n\t\t\t\t\t\t\t\t\tselectedColor: data.amsTreeviewSelectedColor,\n\t\t\t\t\t\t\t\t\tselectedBackColor: data.amsTreeviewSelectedBackColor,\n\t\t\t\t\t\t\t\t\tunselectableColor: data.amsTreeviewUnselectableColor || 'rgba(1,1,1,0.25)',\n\t\t\t\t\t\t\t\t\tunselectableBackColor: data.amsTreeviewUnselectableBackColor || 'rgba(1,1,1,0.25)',\n\t\t\t\t\t\t\t\t\tenableLinks: data.amsTreeviewEnableLinks,\n\t\t\t\t\t\t\t\t\thighlightSelected: data.amsTreeviewHighlightSelected,\n\t\t\t\t\t\t\t\t\thighlightSearchResults: data.amsTreeviewhighlightSearchResults,\n\t\t\t\t\t\t\t\t\tshowBorder: data.amsTreeviewShowBorder,\n\t\t\t\t\t\t\t\t\tshowIcon: data.amsTreeviewShowIcon,\n\t\t\t\t\t\t\t\t\tshowCheckbox: data.amsTreeviewShowCheckbox,\n\t\t\t\t\t\t\t\t\tshowTags: data.amsTreeviewShowTags,\n\t\t\t\t\t\t\t\t\ttoggleUnselectable: data.amsTreeviewToggleUnselectable,\n\t\t\t\t\t\t\t\t\tmultiSelect: data.amsTreeviewMultiSelect,\n\t\t\t\t\t\t\t\t\tonNodeChecked: MyAMS.core.getFunctionByName(data.amsTreeviewNodeChecked),\n\t\t\t\t\t\t\t\t\tonNodeCollapsed: MyAMS.core.getFunctionByName(data.amsTreeviewNodeCollapsed),\n\t\t\t\t\t\t\t\t\tonNodeDisabled: MyAMS.core.getFunctionByName(data.amsTreeviewNodeDisabled),\n\t\t\t\t\t\t\t\t\tonNodeEnabled: MyAMS.core.getFunctionByName(data.amsTreeviewNodeEnabled),\n\t\t\t\t\t\t\t\t\tonNodeExpanded: MyAMS.core.getFunctionByName(data.amsTreeviewNodeExpanded),\n\t\t\t\t\t\t\t\t\tonNodeSelected: MyAMS.core.getFunctionByName(data.amsTreeviewNodeSelected),\n\t\t\t\t\t\t\t\t\tonNodeUnchecked: MyAMS.core.getFunctionByName(data.amsTreeviewNodeUnchecked),\n\t\t\t\t\t\t\t\t\tonNodeUnselected: MyAMS.core.getFunctionByName(data.amsTreeviewNodeUnselected),\n\t\t\t\t\t\t\t\t\tonSearchComplete: MyAMS.core.getFunctionByName(data.amsTreeviewSearchComplete),\n\t\t\t\t\t\t\t\t\tonSearchCleared: MyAMS.core.getFunctionByName(data.amsTreeviewSearchCleared)\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsTreeviewOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsTreeviewInitcallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, treeview, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\ttreeview.trigger('before-init.ams.treeview', [treeview, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = treeview.treeview(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsTreeviewAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, treeview, plugin, settings);\n\t\t\t\t\t\t\ttreeview.trigger('after-init.ams.treeview', [treeview, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(trees);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Form validation plug-in\n */\n\nexport function validate(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst forms = $('form:not([novalidate])', element);\n\t\tif (forms.length > 0) {\n\t\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.validate,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/validate/jquery-validate${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tif (firstLoad && (MyAMS.i18n.language !== 'en')) {\n\t\t\t\t\t\tMyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/validate/i18n/messages_${MyAMS.i18n.language}${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tforms.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tform = $(elt),\n\t\t\t\t\t\t\tdata = form.data(),\n\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\tignore: null,\n\t\t\t\t\t\t\t\tinvalidHandler: MyAMS.core.getFunctionByName(data.amsValidateInvalidHandler) || (\n\t\t\t\t\t\t\t\t\t(evt, validator) => {\n\t\t\t\t\t\t\t\t\t\t// automatically display hidden fields with errors!\n\t\t\t\t\t\t\t\t\t\t$('span.is-invalid', form).remove();\n\t\t\t\t\t\t\t\t\t\t$('.is-invalid', form).removeClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\tfor (const error of validator.errorList) {\n\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\telement = $(error.element),\n\t\t\t\t\t\t\t\t\t\t\t\tpanels = element.parents('.tab-pane'),\n\t\t\t\t\t\t\t\t\t\t\t\tfieldsets = element.parents('fieldset.switched');\n\t\t\t\t\t\t\t\t\t\t\tfieldsets.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t\t$('legend.switcher', elt).click();\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\tpanels.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\t\tpanel = $(elt),\n\t\t\t\t\t\t\t\t\t\t\t\t\ttabs = panel.parents('.tab-content')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.siblings('.nav-tabs');\n\t\t\t\t\t\t\t\t\t\t\t\t$(`li:nth-child(${panel.index() + 1})`, tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.addClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\t\t\t$('li.is-invalid:first a', tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.click();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\terrorElement: data.amsValidateErrorElement || 'span',\n\t\t\t\t\t\t\t\terrorClass: data.amsValidateErrorClass || 'is-invalid',\n\t\t\t\t\t\t\t\terrorPlacement: MyAMS.core.getFunctionByName(data.amsValidateErrorPlacement) ||\n\t\t\t\t\t\t\t\t\t((error, element) => {\n\t\t\t\t\t\t\t\t\t\terror.addClass('invalid-feedback');\n\t\t\t\t\t\t\t\t\t\telement.closest('.form-widget').append(error);\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tsubmitHandler: MyAMS.core.getFunctionByName(data.amsValidateSubmitHandler) ||\n\t\t\t\t\t\t\t\t\t(form.attr('data-async') !== undefined ?\n\t\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\t\tMyAMS.require('form').then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.form.submit(form);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t: () => {\n\t\t\t\t\t\t\t\t\t\t\tform.get(0).submit();\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t$('[data-ams-validate-rules]', form).each((idx, elt) => {\n\t\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\t\tdataOptions.rules = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdataOptions.rules[$(elt).attr('name')] = $(elt).data('ams-validate-rules');\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('[data-ams-validate-messages]', form).each((idx, elt) => {\n\t\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\t\tdataOptions.messages = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdataOptions.messages[$(elt).attr('name')] = $(elt).data('ams-validate-messages');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsValidateOptions || data.amsOptions);\n\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsValidateInitCallback ||\n\t\t\t\t\t\t\tdata.amsInit, document, form, settings) || settings;\n\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\tform.trigger('before-init.ams.validate', [form, settings, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst plugin = form.validate(settings);\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsValidateAfterInitCallback ||\n\t\t\t\t\t\t\tdata.amsAfterInit, document, form, plugin, settings);\n\t\t\t\t\t\tform.trigger('after-init.ams.validate', [form, plugin]);\n\t\t\t\t\t});\n\t\t\t\t}, reject).then(() => {\n\t\t\t\t\tresolve(forms);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t}\n\t});\n}\n\n\n/**\n * Global module initialization\n */\n\nif (window.MyAMS) {\n\n\t// register loaded plug-ins\n\tMyAMS.registry.register(checker, 'checker');\n\tMyAMS.registry.register(contextMenu, 'contextMenu');\n\tMyAMS.registry.register(datatables, 'datatables');\n\tMyAMS.registry.register(datetime, 'datetime');\n\tMyAMS.registry.register(dragdrop, 'dragdrop');\n\tMyAMS.registry.register(editor, 'editor');\n\tMyAMS.registry.register(fileInput, 'fileInput');\n\tMyAMS.registry.register(imgAreaSelect, 'imgAreaSelect');\n\tMyAMS.registry.register(select2, 'select2');\n\tMyAMS.registry.register(svgPlugin, 'svg');\n\tMyAMS.registry.register(switcher, 'switcher');\n\tMyAMS.registry.register(tinymce, 'tinymce');\n\tMyAMS.registry.register(treeview, 'treeview');\n\tMyAMS.registry.register(validate, 'validate');\n\n\t// register module\n\tMyAMS.config.modules.push('plugins');\n\tif (!MyAMS.env.bundle) {\n\t\tconsole.debug(\"MyAMS: plugins module loaded...\");\n\t}\n}\n"],"file":"mod-plugins-dev.js"}