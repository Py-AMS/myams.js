{"version":3,"file":"mod-plugins-dev.js","names":["$","MyAMS","templates","jsrender","require","CHECKER_TEMPLATE_STRING","CHECKER_TEMPLATE","markup","checker","element","Promise","resolve","checkers","length","each","idx","elt","legend","data","amsChecker","fieldset","parent","state","amsCheckerState","amsState","checked","hasClass","fieldName","amsCheckerFieldname","amsFieldname","core","generateId","fieldId","replace","prefix","amsCheckerHiddenPrefix","amsHiddenPrefix","marker","amsCheckerMarker","amsMarker","checkerMode","amsCheckerMode","amsMode","checkedValue","amsCheckerValueOn","amsValueOn","uncheckedValue","amsCheckerValueOff","amsValueOff","value","amsCheckerValue","amsValue","readonly","amsCheckerReadonly","amsReadonly","props","text","veto","trigger","html","render","change","evt","input","target","is","prop","executeFunctionByName","amsCheckerChangeHandler","amsChangeHandler","document","amsCheckerCancelDefault","amsCancelDefault","siblings","removeClass","val","addClass","closest","on","click","contextMenu","reject","menus","then","menu","options","menuSelector","amsContextmenuSelector","amsMenuSelector","settings","extend","amsContextmenuOptions","amsOptions","amsContextmenuInitCallback","amsInit","plugin","amsContextmenuAfterInitCallback","amsAfterInit","_datatablesHelpers","init","types","fn","dataTable","ext","type","detect","unshift","match","order","a","b","x","y","parseFloat","trimmed","trim","frDate","split","frDateTime","frTime","preReorder","node","table","reorderRows","dtTable","DataTable","amsReorderInputTarget","url","amsReorderUrl","ids","rows","getter","getFunctionByName","amsReorderData","makeArray","map","listattr","separator","amsReorderSeparator","exists","join","startsWith","window","location","protocol","postData","amsReorderPostData","attr","amsReorderPostAttr","ajax","post","result","status","xhr","removeData","row","parents","get","invalidate","draw","callback","amsReorderCallback","results","apply","handleJSON","datatables","baseJS","env","baseURL","baseCSS","tables","check","extext","firstLoad","required","push","getScript","getCSS","when","css","bases","extensions","depends","loaded","buttons","autoFill","AutoFill","Buttons","isArray","indexOf","buttons_print","print","buttons_excel","excelHtml5","buttons_pdf","pdfMake","buttons_colvis","colvis","colReorder","ColReorder","fixedColumns","FixedColumns","fixedHeader","FixedHeader","keyTable","KeyTable","responsive","Responsive","rowGroup","RowGroup","rowReorder","RowReorder","scroller","Scroller","searchBuilder","SearchBuilder","searchPanes","SearchPanes","select","name","Object","entries","isDataTable","dom","amsDatatableDom","amsDom","searching","lengthChange","info","paging","defaultOptions","language","amsDatatableLanguage","amsLanguage","i18n","plugins","amsDatatableOrder","amsOrder","orders","col","colOrder","parseInt","heads","columns","th","sortables","iterator","sortable","undefined","JSON","parse","stype","amsDatatableOptions","amsDatatableInitCallback","setTimeout","amsDatatableAfterInitCallback","amsDatatablePreReorder","amsPreReorder","amsDatatableReordered","amsReordered","datetime","inputs","moment","datetimepicker","locale","amsDatetimeLanguage","icons","time","date","up","down","previous","next","today","clear","close","format","amsDatetimeFormat","amsFormat","datetimeOptions","amsDatetimeInitCallback","amsDatetimeIsoTarget","amsIsoTarget","source","currentTarget","toISOString","dragdrop","dragitems","draggable","item","dragOptions","cursor","amsDraggableCursor","containment","amsDraggableContainment","handle","amsDraggableHandle","connectToSortable","amsDraggableConnectSortable","helper","amsDraggableHelper","start","amsDraggableStart","stop","amsDraggableStop","amsDraggableOptions","amsDraggableInitCallback","disableSelection","amsDraggableAfterInitCallback","dropOptions","accept","amsDroppableAccept","amsAccept","drop","amsDroppableDrop","amsDroppableOptions","amsDroppableInitCallback","droppable","amsDroppableAfterInitCallback","sortOptions","items","amsSortableItems","amsSortableHandle","amsSortableHelper","connectWith","amsSortableConnectwith","amsSortableContainment","placeholder","amsSortablePlaceholder","amsSortableStart","over","amsSortableOver","amsSortableStop","amsSortableOptions","amsSortableInitCallback","amsSortableAfterInitCallback","resizeOptions","autoHide","amsResizableAutohide","amsResizableContainment","grid","amsResizableGrid","handles","amsResizableHandles","amsResizableStart","resize","amsResizableResize","amsResizableStop","amsResizableOptions","amsResizableInitCallback","resizable","amsResizableAfterInitCallback","editor","editors","ace","deferred","config","set","textarea","widget","modeList","mode","amsEditorMode","getModeForPath","amsEditorFilename","amsFilename","textEditor","position","width","height","insertBefore","fontSize","tabSize","useSoftTabs","showGutter","showLineNumbers","printMargin","showInvisibles","amsEditorOptions","amsEditorInitCallback","edit","setOptions","theme","setTheme","session","setValue","setReadOnly","getValue","amsEditorAfterEditCallback","fileInput","bsCustomFileInput","inputId","inputSelector","form","formId","formSelector","imgAreaSelect","images","image","parentSelector","amsImgareaselectParent","amsParent","instance","x1","amsImgareaselectX1","amsX1","y1","amsImgareaselectY1","amsY1","x2","amsImgareaselectX2","amsX2","amsImgareaselectImageWidth","amsImageWidth","y2","amsImgareaselectY2","amsY2","amsImgareaselectImageHeight","amsImageHeight","imageWidth","imageHeight","imgWidth","amsImgareaselectThumbWidth","amsThumbWidth","imgHeight","amsImgareaselectThumbHeight","amsThumbHeight","minWidth","minHeight","aspectRatio","amsImgareaselectAspectRatio","amsAspectRatio","onSelectEnd","amsImgareaselectSelectEnd","amsSelectedEnd","img","selection","amsImgareaselectTargetField","amsTargetField","amsImgareaselectOptions","amsImgareaselectInitCallback","_select2Helpers","select2UpdateHiddenField","values","find","children","title","select2AjaxParamsHelper","params","assign","select2","selects","amsSelect2Theme","amsTheme","amsSelect2Language","escapeMarkup","amsSelect2EscapeMarkup","amsEscapeMarkup","matcher","amsSelect2Matcher","amsMatcher","sorter","amsSelect2Sorter","amsSorter","templateResult","amsSelect2TemplateResult","amsTemplateResult","templateSelection","amsSelect2TemplateSelection","amsTemplateSelection","tokenizer","amsSelect2Tokenizer","amsTokenizer","ajaxUrl","amsSelect2AjaxUrl","amsAjaxUrl","ajaxParamsHelper","ajaxParams","amsSelect2AjaxParams","amsAjaxParams","amsSelect2AjaxData","amsAjaxData","processResults","amsSelect2AjaxProcessResults","amsAjaxProcessResults","transport","amsSelect2AjaxTransport","amsAjaxTransport","minimumInputLength","amsSelect2MinimumInputLength","amsMinimumInputLength","hidden","insertAfter","amsSelect2Separator","removeAttr","amsSelect2Options","amsSelect2InitCallback","modal","first","zIndex","$dropdown","dropdown","focus","update","id","option","helpers","moveElementToParentEnd","amsSelect2AfterInitCallback","svgPlugin","svgs","container","svg","setAttribute","Math","round","switcher","switchers","amsSwitcherState","minusClass","amsSwitcherMinusClass","amsMinusClass","plusClass","amsSwitcherPlusClass","amsPlusClass","amsSwitcher","prependTo","preventDefault","switchIcon","tinymce","devmode","suffix","stopImmediatePropagation","editorId","remove","selector","base_url","amsTinymceTheme","menubar","amsTinymceMenubar","amsMenubar","statusbar","amsTinymceStatusbar","amsStatusbar","amsTinymcePlugins","amsPlugins","toolbar","amsTinymceToolbar","amsToolbar","toolbar1","amsTinymceToolbar1","amsToolbar1","toolbar2","amsTinymceToolbar2","amsToolbar2","content_css","amsTinymceContentCss","amsContentCss","formats","amsTinymceFormats","amsFormats","style_formats","amsTinymceStyleFormats","amsStyleFormats","block_formats","amsTinymceBlockFormats","amsBlockFormats","valid_classes","amsTinymceValidClasses","amsValidClasses","image_advtab","image_list","amsTinymceImageList","amsImageList","image_class_list","amsTinymceImageClassList","amsImageClassList","link_list","amsTinymceLinkList","amsLinkList","link_class_list","amsTinymceLinkClassList","amsLinkClassList","paste_as_text","amsTinymcePasteAsText","amsPasteAsText","paste_auto_cleanup_on_paste","amsTinymcePasteAutoCleanup","amsPasteAutoCleanup","paste_strip_class_attributes","amsTinymcePasteStripClassAttributes","amsPasteStripClassAttributes","paste_remove_spans","amsTinymcePasteRemoveSpans","amsPasteRemoveSpans","paste_remove_styles","amsTinymcePasteRemoveStyles","amsPasteRemoveStyles","amsTinymceHeight","amsHeight","min_height","autoresize_min_height","autoresize_max_height","amsTinymceExternalPlugins","amsExternalPlugins","names","src","PluginManager","load","getSource","amsTinymceOptions","amsTinymceInitCallback","amsTinymceAfterInitCallback","treeview","trees","treview","dataOptions","amsTreeviewData","levels","amsTreeviewLevels","injectStyle","amsTreeviewInjectStyle","expandIcon","amsTreeviewExpandIcon","collapseIcon","amsTreeviewCollaspeIcon","emptyIcon","amsTreeviewEmptyIcon","nodeIcon","amsTreeviewNodeIcon","selectedIcon","amsTreeviewSelectedIcon","checkedIcon","amsTreeviewCheckedIcon","uncheckedIcon","amsTreeviewUncheckedIcon","color","amsTreeviewColor","backColor","amsTreeviewBackColor","borderColor","amsTreeviewBorderColor","onHoverColor","amsTreeviewHoverColor","selectedColor","amsTreeviewSelectedColor","selectedBackColor","amsTreeviewSelectedBackColor","unselectableColor","amsTreeviewUnselectableColor","unselectableBackColor","amsTreeviewUnselectableBackColor","enableLinks","amsTreeviewEnableLinks","highlightSelected","amsTreeviewHighlightSelected","highlightSearchResults","amsTreeviewhighlightSearchResults","showBorder","amsTreeviewShowBorder","showIcon","amsTreeviewShowIcon","showCheckbox","amsTreeviewShowCheckbox","showTags","amsTreeviewShowTags","toggleUnselectable","amsTreeviewToggleUnselectable","multiSelect","amsTreeviewMultiSelect","onNodeChecked","amsTreeviewNodeChecked","onNodeCollapsed","amsTreeviewNodeCollapsed","onNodeDisabled","amsTreeviewNodeDisabled","onNodeEnabled","amsTreeviewNodeEnabled","onNodeExpanded","amsTreeviewNodeExpanded","onNodeSelected","amsTreeviewNodeSelected","onNodeUnchecked","amsTreeviewNodeUnchecked","onNodeUnselected","amsTreeviewNodeUnselected","onSearchComplete","amsTreeviewSearchComplete","onSearchCleared","amsTreeviewSearchCleared","amsTreeviewOptions","amsTreeviewInitcallback","amsTreeviewAfterInitCallback","validate","forms","ignore","invalidHandler","amsValidateInvalidHandler","validator","error","errorList","panels","fieldsets","panel","tabs","index","errorElement","amsValidateErrorElement","errorClass","amsValidateErrorClass","errorPlacement","amsValidateErrorPlacement","append","submitHandler","amsValidateSubmitHandler","submit","rules","messages","amsValidateOptions","amsValidateInitCallback","amsValidateAfterInitCallback","registry","register","modules","bundle","console","debug"],"sources":["mod-plugins.js"],"sourcesContent":["/* global MyAMS, bsCustomFileInput */\n/**\n * MyAMS standard plugins\n */\n\nconst $ = MyAMS.$;\n\nif (!$.templates) {\n\tconst jsrender = require('jsrender');\n\t$.templates = jsrender.templates;\n}\n\n\n/**\n * Fieldset checker plug-in\n *\n * A checker is like a simple switcher, but also provides a checkbox which is used\n * as \"switcher\" input field.\n *\n * The \"checker\" class is applied to the fieldset legend; checkbox is created automatically\n * by the plug-in.\n * Check options are given as data attributes, all prefixed with \"ams-checker-\":\n *  - state: is 'off' by default; can be set to 'on' to automatically activate the checker\n *  - mode: is 'hide' by default, which make the fieldset hidden when the checker is not activated;\n *    you cna set it to \"disable\" to make fieldset content visible but disabled when the checker\n *    is not activated\n *  - fieldname: is the name of the input checkbox created by the plug-in\n *  - value: this is the \"checked\" value of the main checkbox field\n *  - readonly: if \"true\", the checkbox is disabled and in read-only mode\n *  - hidden-prefix: if not null, this is a prefix which will be assigned to an additional\n *    hidden input field, updated automatically when the checker is switched; the name of the\n *    hidden input if made of this prefix, followed by the \"fieldname\" value\n *  - value-on: this is the \"checked\" value of the hidden input; \"true\" by default\n *  - value-off: this is the \"unchecked\" value of the hidden input; \"false\" by default\n *  - marker: if not null, another hidden input with a fixed value of 1 will be created; the name\n *    of this input will be the \"fieldname\" value followed by this \"marker\" value\n *  - change-handler: this optional handler will be called on checker switch\n *  - cancel-default: if \"true\", the default behaviour will not be executed on checker switch\n */\n\nconst CHECKER_TEMPLATE_STRING = `\n\t<span class=\"custom-control custom-switch\">\n\t\t<input type=\"checkbox\"\n\t\t\t   id=\"{{: fieldId }}\" name=\"{{: fieldName }}\"\n\t\t\t   class=\"custom-control-input checker\"\n\t\t\t   {{if checked}}checked{{/if}}\n\t\t\t   {{if readonly}}disabled{{/if}}\n\t\t\t   value=\"{{: value }}\" />\n\t\t{{if prefix}}\n\t\t<input type=\"hidden\" class=\"prefix\"\n\t\t\t   id=\"{{: prefix}}{{: fieldName}}_prefix\"\n\t\t\t   name=\"{{: prefix}}{{: fieldName}}\"\n\t\t\t   value=\"{{if state==='on'}}{{: checkedValue}}{{else}}{{: uncheckedValue}}{{/if}}\" />\n\t\t{{else marker}}\n\t\t<input type=\"hidden\" class=\"marker\"\n\t\t\t   name=\"{{: fieldName}}{{: marker}}\"\n\t\t\t   value=\"1\" />\n\t\t{{/if}}\n\t\t<label for=\"{{: fieldId }}\"\n\t\t\t   class=\"custom-control-label\">\n\t\t\t{{: legend }}\n\t\t</label>\n\t</span>\n`;\n\nconst CHECKER_TEMPLATE = $.templates({\n\tmarkup: CHECKER_TEMPLATE_STRING\n});\n\nexport function checker(element) {\n\treturn new Promise((resolve) => {\n\t\tconst checkers = $('legend.checker', element);\n\t\tif (checkers.length > 0) {\n\t\t\tcheckers.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tlegend = $(elt),\n\t\t\t\t\tdata = legend.data();\n\t\t\t\tif (!data.amsChecker) {\n\t\t\t\t\tconst\n\t\t\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\t\t\tstate = data.amsCheckerState || data.amsState,\n\t\t\t\t\t\tchecked = fieldset.hasClass('switched') || (state === 'on'),\n\t\t\t\t\t\tfieldName = data.amsCheckerFieldname || data.amsFieldname || `checker_${MyAMS.core.generateId()}`,\n\t\t\t\t\t\tfieldId = fieldName.replace(/\\./g, '_'),\n\t\t\t\t\t\tprefix = data.amsCheckerHiddenPrefix || data.amsHiddenPrefix,\n\t\t\t\t\t\tmarker = data.amsCheckerMarker || data.amsMarker || false,\n\t\t\t\t\t\tcheckerMode = data.amsCheckerMode || data.amsMode || 'hide',\n\t\t\t\t\t\tcheckedValue = data.amsCheckerValueOn || data.amsValueOn || 'true',\n\t\t\t\t\t\tuncheckedValue = data.amsCheckerValueOff || data.amsValueOff || 'false',\n\t\t\t\t\t\tvalue = data.amsCheckerValue || data.amsValue,\n\t\t\t\t\t\treadonly = data.amsCheckerReadonly || data.amsReadonly,\n\t\t\t\t\t\tprops = {\n\t\t\t\t\t\t\tlegend: legend.text(),\n\t\t\t\t\t\t\tfieldName: fieldName,\n\t\t\t\t\t\t\tfieldId: fieldId,\n\t\t\t\t\t\t\tvalue: value || true,\n\t\t\t\t\t\t\tchecked: checked,\n\t\t\t\t\t\t\treadonly: readonly,\n\t\t\t\t\t\t\tprefix: prefix,\n\t\t\t\t\t\t\tstate: state,\n\t\t\t\t\t\t\tcheckedValue: checkedValue,\n\t\t\t\t\t\t\tuncheckedValue: uncheckedValue,\n\t\t\t\t\t\t\tmarker: marker\n\t\t\t\t\t\t},\n\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\tlegend.trigger('before-init.ams.checker', [legend, props, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlegend.html(CHECKER_TEMPLATE.render(props));\n\t\t\t\t\t$('input', legend).change((evt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tinput = $(evt.target),\n\t\t\t\t\t\t\tchecked = input.is(':checked'),\n\t\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\t\tlegend.trigger('before-switch.ams.checker', [legend, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\tinput.prop('checked', !checked);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsCheckerChangeHandler ||\n\t\t\t\t\t\t\tdata.amsChangeHandler, document, legend, checked);\n\t\t\t\t\t\tif (!data.amsCheckerCancelDefault && !data.amsCancelDefault) {\n\t\t\t\t\t\t\tconst prefix = input.siblings('.prefix');\n\t\t\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\t\t\tprefix.val(checkedValue);\n\t\t\t\t\t\t\t\t\tlegend.trigger('opened.ams.checker', [legend]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\t\t\tprefix.val(uncheckedValue);\n\t\t\t\t\t\t\t\t\tlegend.trigger('closed.ams.checker', [legend]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfieldset.prop('disabled', !checked);\n\t\t\t\t\t\t\t\tprefix.val(checked ? checkedValue : uncheckedValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tlegend.closest('form').on('reset', () => {\n\t\t\t\t\t\tconst checker = $('.checker', legend);\n\t\t\t\t\t\tif (checker.prop('checked') !== checked) {\n\t\t\t\t\t\t\tchecker.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!checked) {\n\t\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.prop('disabled', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlegend.trigger('after-init.ams.checker', [legend]);\n\t\t\t\t\tlegend.data('ams-checker', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tresolve(checkers);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Context menu plug-in\n */\n\nexport function contextMenu(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst menus = $('.context-menu', element);\n\t\tif (menus.length > 0) {\n\t\t\tMyAMS.require('menu').then(() => {\n\t\t\t\tmenus.each((idx, elt) => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tmenu = $(elt),\n\t\t\t\t\t\tdata = menu.data(),\n\t\t\t\t\t\toptions = {\n\t\t\t\t\t\t\tmenuSelector: data.amsContextmenuSelector || data.amsMenuSelector\n\t\t\t\t\t\t};\n\t\t\t\t\tlet settings = $.extend({}, options, data.amsContextmenuOptions || data.amsOptions);\n\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsContextmenuInitCallback || data.amsInit,\n\t\t\t\t\t\tdocument, menu, settings) || settings;\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\tmenu.trigger('before-init.ams.contextmenu', [menu, settings, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst plugin = menu.contextMenu(settings);\n\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsContextmenuAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\tdocument, menu, plugin, settings);\n\t\t\t\t\tmenu.trigger('after-init.ams.contextmenu', [menu, plugin]);\n\t\t\t\t});\n\t\t\t}, reject).then(() => {\n\t\t\t\tresolve(menus);\n\t\t\t});\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * JQuery Datatable plug-in\n */\n\nconst _datatablesHelpers = {\n\n\tinit: () => {\n\n\t\t// Add autodetect formats\n\t\tconst types = $.fn.dataTable.ext.type;\n\n\t\ttypes.detect.unshift((data) => {\n\t\t\tif (data !== null && data.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\\/(0[1-9]|1[0-2])\\/[0-3][0-9]{3}$/)) {\n\t\t\t\treturn 'date-euro';\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\ttypes.detect.unshift((data) => {\n\t\t\tif (data !== null && data.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\\/(0[1-9]|1[0-2])\\/[0-3][0-9]{3} - ([0-1][0-9]|2[0-3]):[0-5][0-9]$/)) {\n\t\t\t\treturn 'datetime-euro';\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\t// Add sorting methods\n\t\t$.extend(types.order, {\n\n\t\t\t// numeric values using commas separators\n\t\t\t\"numeric-comma-asc\": (a, b) => {\n\t\t\t\tlet x = a.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tlet y = b.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tx = parseFloat(x);\n\t\t\t\ty = parseFloat(y);\n\t\t\t\treturn ((x < y) ? -1 : ((x > y) ? 1 : 0));\n\t\t\t},\n\t\t\t\"numeric-comma-desc\": (a, b) => {\n\t\t\t\tlet x = a.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tlet y = b.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tx = parseFloat(x);\n\t\t\t\ty = parseFloat(y);\n\t\t\t\treturn ((x < y) ? 1 : ((x > y) ? -1 : 0));\n\t\t\t},\n\n\t\t\t// date-euro column sorter\n\t\t\t\"date-euro-pre\": (a) => {\n\t\t\t\tconst trimmed = $.trim(a);\n\t\t\t\tlet x;\n\t\t\t\tif (trimmed !== '') {\n\t\t\t\t\tconst frDate = trimmed.split('/');\n\t\t\t\t\tx = (frDate[2] + frDate[1] + frDate[0]) * 1;\n\t\t\t\t} else {\n\t\t\t\t\tx = 10000000; // = l'an 1000 ...\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t},\n\t\t\t\"date-euro-asc\": (a, b) => {\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\t\"date-euro-desc\": (a, b) => {\n\t\t\t\treturn b - a;\n\t\t\t},\n\n\t\t\t// datetime-euro column sorter\n\t\t\t\"datetime-euro-pre\": (a) => {\n\t\t\t\tconst trimmed = $.trim(a);\n\t\t\t\tlet x;\n\t\t\t\tif (trimmed !== '') {\n\t\t\t\t\tconst frDateTime = trimmed.split(' - ');\n\t\t\t\t\tconst frDate = frDateTime[0].split('/');\n\t\t\t\t\tconst frTime = frDateTime[1].split(':');\n\t\t\t\t\tx = (frDate[2] + frDate[1] + frDate[0] + frTime[0] + frTime[1]) * 1;\n\t\t\t\t} else {\n\t\t\t\t\tx = 100000000000; // = l'an 1000 ...\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t},\n\t\t\t\"datetime-euro-asc\": (a, b) => {\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\t\"datetime-euro-desc\": (a, b) => {\n\t\t\t\treturn b - a;\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Store reorder source before reorder\n\t *\n\t * @param evt: original event\n\t * @param node: source node\n\t */\n\tpreReorder: function(evt, node) {\n\t\tconst table = $(evt.target);\n\t\ttable.data('ams-reorder-source', node);\n\t},\n\n\t/**\n\t * Handle table rows reordering\n\t *\n\t * @param evt: original event\n\t */\n\treorderRows: function(evt) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst\n\t\t\t\ttable = $(evt.target),\n\t\t\t\tdtTable = table.DataTable(),\n\t\t\t\tdata = table.data();\n\t\t\t// extract target and URL\n\t\t\tlet target = data.amsReorderInputTarget,\n\t\t\t\turl = data.amsReorderUrl,\n\t\t\t\tids;\n\t\t\tif (!(target || url)) {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\t// extract reordered rows IDs\n\t\t\tconst\n\t\t\t\trows = $('tbody tr', table),\n\t\t\t\tgetter = MyAMS.core.getFunctionByName(data.amsReorderData) || 'data-ams-row-value';\n\t\t\tif (typeof getter === 'function') {\n\t\t\t\tids = $.makeArray(rows).map(getter);\n\t\t\t} else {\n\t\t\t\tids = rows.listattr(getter);\n\t\t\t}\n\t\t\t// set target input value (if any)\n\t\t\tconst separator = data.amsReorderSeparator || ';';\n\t\t\tif (target) {\n\t\t\t\ttarget = $(target);\n\t\t\t\tif (target.exists()) {\n\t\t\t\t\ttarget.val(ids.join(separator));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tids = ids.join(separator);\n\t\t\t}\n\t\t\t// call target URL (if any)\n\t\t\tif (url) {\n\t\t\t\turl = MyAMS.core.executeFunctionByName(url, document, table) || url;\n\t\t\t\tif (!(url.startsWith(window.location.protocol) || url.startsWith('/'))) {\n\t\t\t\t\tconst location = table.data('ams-location');\n\t\t\t\t\turl = `${location || ''}/${url}`;\n\t\t\t\t}\n\t\t\t\tif (ids.length > 0) {\n\t\t\t\t\tlet postData;\n\t\t\t\t\tif (data.amsReorderPostData) {\n\t\t\t\t\t\tpostData = MyAMS.core.executeFunctionByName(data.amsReorderPostData,\n\t\t\t\t\t\t\tdocument, table, ids);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst attr = data.amsReorderPostAttr || 'order';\n\t\t\t\t\t\tpostData = {};\n\t\t\t\t\t\tpostData[attr] = ids;\n\t\t\t\t\t}\n\t\t\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\t\t\tMyAMS.ajax.post(url, postData).then((result, status, xhr) => {\n\t\t\t\t\t\t\t$('td.sorter', table).each((idx, elt) => {\n\t\t\t\t\t\t\t\t$(elt).removeData().attr('data-order', idx);\n\t\t\t\t\t\t\t\tdtTable.row($(elt).parents('tr').get(0)).invalidate().draw();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconst callback = data.amsReorderCallback;\n\t\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(callback, document,\n\t\t\t\t\t\t\t\t\ttable, result, status, xhr).then((...results) => {\n\t\t\t\t\t\t\t\t\tresolve.apply(table, ...results);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tMyAMS.ajax\n\t\t\t\t\t\t\t\t\t.handleJSON(result, table.parents('.dataTables_wrapper'))\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n\nexport function datatables(element) {\n\tconst\n\t\tbaseJS = `${MyAMS.env.baseURL}../ext/datatables/`,\n\t\tbaseCSS = `${MyAMS.env.baseURL}../../css/ext/datatables/`;\n\treturn new Promise((resolve, reject) => {\n\t\tconst tables = $('.datatable', element);\n\t\tif (tables.length > 0) {\n\t\t\tMyAMS.ajax.check($.fn.dataTable,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/datatables/dataTables${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\tconst required = [];\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\trequired.push(MyAMS.core.getScript(`${baseJS}dataTables-bootstrap4${MyAMS.env.extext}.js`));\n\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${baseCSS}dataTables-bootstrap4${MyAMS.env.extext}.css`, 'datatables-bs4'));\n\t\t\t\t}\n\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tcss = {},\n\t\t\t\t\t\tbases = [],\n\t\t\t\t\t\textensions = [],\n\t\t\t\t\t\tdepends = [],\n\t\t\t\t\t\tloaded = {};\n\t\t\t\t\ttables.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\ttable = $(elt),\n\t\t\t\t\t\t\tdata = table.data();\n\t\t\t\t\t\tif (data.buttons === 'default') {\n\t\t\t\t\t\t\ttable.attr('data-buttons', '[\"copy\", \"print\"]');\n\t\t\t\t\t\t\ttable.removeData('buttons');\n\t\t\t\t\t\t\tdata.buttons = table.data('buttons');\n\t\t\t\t\t\t} else if (data.buttons === 'all') {\n\t\t\t\t\t\t\ttable.attr('data-buttons', '[\"copy\", \"csv\", \"excel\", \"print\", \"pdf\", \"colvis\"]');\n\t\t\t\t\t\t\ttable.removeData('buttons');\n\t\t\t\t\t\t\tdata.buttons = table.data('buttons');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.autoFill && !loaded.autoFill && !$.fn.dataTable.AutoFill) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}autoFill${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}autoFill-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-autofill-bs4'] = `${baseCSS}autoFill-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.autoFill = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.buttons) {\n\t\t\t\t\t\t\tif (!loaded.buttons && !$.fn.dataTable.Buttons) {\n\t\t\t\t\t\t\t\tbases.push(`${baseJS}buttons${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}buttons-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}buttons-html5${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\tcss['dt-buttons-bs4'] = `${baseCSS}buttons-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\t\tloaded.buttons = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ($.isArray(data.buttons)) {\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('print') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_print && !$.fn.dataTable.ext.buttons.print) {\n\t\t\t\t\t\t\t\t\t\tdepends.push(`${baseJS}buttons-print${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_print = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('excel') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_excel && !$.fn.dataTable.ext.buttons.excelHtml5) {\n\t\t\t\t\t\t\t\t\t\tbases.push(`${baseJS}jszip${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_excel = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('pdf') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_pdf && !window.pdfMake) {\n\t\t\t\t\t\t\t\t\t\tbases.push(`${baseJS}pdfmake${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\textensions.push(`${baseJS}vfs_fonts${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_pdf = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (data.buttons.indexOf('colvis') >= 0) {\n\t\t\t\t\t\t\t\t\tif (!loaded.buttons_colvis && !$.fn.dataTable.ext.buttons.colvis) {\n\t\t\t\t\t\t\t\t\t\tdepends.push(`${baseJS}buttons-colVis${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\tloaded.buttons_colvis = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.colReorder && !loaded.colReorder && !$.fn.dataTable.ColReorder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}colReorder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}colReorder-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-colreorder-bs4'] = `${baseCSS}colReorder-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.colReorder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.fixedColumns && !loaded.fixedColumns && !$.fn.dataTable.FixedColumns) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}fixedColumns${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}fixedColumns-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-fixedcolumns-bs4'] = `${baseCSS}fixedColumns-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.fixedColumns = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.fixedHeader && !loaded.fixedHeader && !$.fn.dataTable.FixedHeader) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}fixedHeader${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}fixedHeader-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-fixedheader-bs4'] = `${baseCSS}fixedHeader-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.fixedHeader = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.keyTable && !loaded.keyTable && !$.fn.dataTable.KeyTable) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}keyTable${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}keyTable-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-keytable-bs4'] = `${baseCSS}keyTable-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.keyTable = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((data.responsive !== false) && !loaded.responsive && !$.fn.dataTable.Responsive) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}responsive${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}responsive-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-responsive-bs4'] = `${baseCSS}responsive-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.responsive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.rowGroup && !loaded.rowGroup && !$.fn.dataTable.RowGroup) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}rowGroup${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}rowGroup-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-rowgroup-bs4'] = `${baseCSS}rowGroup-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.rowGroup = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.rowReorder && !loaded.rowReorder && !$.fn.dataTable.RowReorder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}rowReorder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}rowReorder-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-rowreorder-bs4'] = `${baseCSS}rowReorder-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.rowReorder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.scroller && !loaded.scroller && !$.fn.dataTable.Scroller) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}scroller${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}scroller-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-scroller-bs4'] = `${baseCSS}scroller-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.scroller = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.searchBuilder && !loaded.searchBuilder && !$.fn.dataTable.SearchBuilder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}searchBuilder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}searchBuilder-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-searchbuilder-bs4'] = `${baseCSS}searchBuilder-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.searchBuilder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.searchPanes && !loaded.searchPanes && !$.fn.dataTable.SearchPanes) {\n\t\t\t\t\t\t\tif (!loaded.select && !$.fn.dataTable.select) {\n\t\t\t\t\t\t\t\tbases.push(`${baseJS}select${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}select-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\tcss['dt-select-bs4'] = `${baseCSS}select-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\t\tloaded.select = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\textensions.push(`${baseJS}searchPanes${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tdepends.push(`${baseJS}searchPanes-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-searchpanes-bs4'] = `${baseCSS}searchPanes-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.searchPanes = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.select && !loaded.select && !$.fn.dataTable.select) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}select${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}select-bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-select-bs4'] = `${baseCSS}select-bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.select = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$.when.apply($, bases.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\treturn $.when.apply($, extensions.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\t\treturn $.when.apply($, depends.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\t\t\t\t_datatablesHelpers.init();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (const [name, url] of Object.entries(css)) {\n\t\t\t\t\t\t\t\t\tMyAMS.core.getCSS(url, name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttables.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\tconst table = $(elt);\n\t\t\t\t\t\t\t\t\tif ($.fn.dataTable.isDataTable(table)) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst data = table.data();\n\n\t\t\t\t\t\t\t\t\t// initialize dom property\n\t\t\t\t\t\t\t\t\tlet dom = data.amsDatatableDom || data.amsDom || data.dom || '';\n\t\t\t\t\t\t\t\t\tif (!dom) {\n\t\t\t\t\t\t\t\t\t\tif (data.buttons) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"B\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searchBuilder) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"Q\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searchPanes) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"P\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searching !== false || data.lengthChange !== false) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-2'\";\n\t\t\t\t\t\t\t\t\t\t\tif (data.searching !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-6 col-md-8'f>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (data.lengthChange !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-6 col-md-4'l>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdom += \">\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdom += \"<'row'<'col-sm-12'tr>>\";\n\t\t\t\t\t\t\t\t\t\tif (data.info !== false || data.paging !== false) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-2 py-1'\";\n\t\t\t\t\t\t\t\t\t\t\tif (data.info !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-12 col-md-5'i>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (data.paging !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-12 col-md-7'p>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdom += \">\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!data.buttons && !data.searchBuilder && !data.searchPanes &&\n\t\t\t\t\t\t\t\t\t\t(data.searching === false) || (data.lengthChange === false)) {\n\t\t\t\t\t\t\t\t\t\ttable.siblings('h3').addClass('mb-0');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// initialize default options\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\t\t\tlanguage: data.amsDatatableLanguage || data.amsLanguage ||\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.i18n.plugins.datatables,\n\t\t\t\t\t\t\t\t\t\t\tresponsive: true,\n\t\t\t\t\t\t\t\t\t\t\tdom: dom\n\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t// initialize sorting\n\t\t\t\t\t\t\t\t\tlet order = data.amsDatatableOrder || data.amsOrder;\n\t\t\t\t\t\t\t\t\tif (typeof order === 'string') {\n\t\t\t\t\t\t\t\t\t\tconst orders = order.split(';');\n\t\t\t\t\t\t\t\t\t\torder = [];\n\t\t\t\t\t\t\t\t\t\tfor (const col of orders) {\n\t\t\t\t\t\t\t\t\t\t\tconst colOrder = col.split(',');\n\t\t\t\t\t\t\t\t\t\t\tcolOrder[0] = parseInt(colOrder[0]);\n\t\t\t\t\t\t\t\t\t\t\torder.push(colOrder);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (order) {\n\t\t\t\t\t\t\t\t\t\tdefaultOptions.order = order;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// initialize columns definition based on header settings\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\theads = $('thead th', table),\n\t\t\t\t\t\t\t\t\t\tcolumns = [];\n\t\t\t\t\t\t\t\t\theads.each((idx, th) => {\n\t\t\t\t\t\t\t\t\t\tcolumns[idx] = $(th).data('ams-column') || {};\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tconst sortables = heads.listattr('data-ams-sortable');\n\t\t\t\t\t\t\t\t\tfor (const iterator of sortables.entries()) {\n\t\t\t\t\t\t\t\t\t\tconst [idx, sortable] = iterator;\n\t\t\t\t\t\t\t\t\t\tif (data.rowReorder) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].sortable = false;\n\t\t\t\t\t\t\t\t\t\t} else if (sortable !== undefined) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].sortable =\n\t\t\t\t\t\t\t\t\t\t\t\ttypeof sortable === 'string' ? JSON.parse(sortable) : sortable;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst types = heads.listattr('data-ams-type');\n\t\t\t\t\t\t\t\t\tfor (const iterator of types.entries()) {\n\t\t\t\t\t\t\t\t\t\tconst [idx, stype] = iterator;\n\t\t\t\t\t\t\t\t\t\tif (stype !==  undefined) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].type = stype;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdefaultOptions.columns = columns;\n\n\t\t\t\t\t\t\t\t\t// initialize final settings and initialize plug-in\n\t\t\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsDatatableOptions || data.amsOptions);\n\t\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsDatatableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\t\t\tdocument, table, settings) || settings;\n\t\t\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\t\t\ttable.trigger('before-init.ams.datatable', [table, settings, veto]);\n\t\t\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tconst plugin = table.DataTable(settings);\n\t\t\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\t\t\tdocument, table, plugin, settings);\n\t\t\t\t\t\t\t\t\t\ttable.trigger('after-init.ams.datatable', [table, plugin]);\n\n\t\t\t\t\t\t\t\t\t\t// set reorder events\n\t\t\t\t\t\t\t\t\t\tif (settings.rowReorder) {\n\t\t\t\t\t\t\t\t\t\t\tplugin.on('pre-row-reorder', MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatablePreReorder || data.amsPreReorder) ||\n\t\t\t\t\t\t\t\t\t\t\t\t_datatablesHelpers.preReorder);\n\t\t\t\t\t\t\t\t\t\t\tplugin.on('row-reorder', MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatableReordered || data.amsReordered) ||\n\t\t\t\t\t\t\t\t\t\t\t\t_datatablesHelpers.reorderRows);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tresolve(tables);\n\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap 4 Tempus/Dominus date/time picker\n */\n\nexport function datetime(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.datetime', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.ajax.check(window.moment,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/moment${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.datetimepicker,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/tempusdominus-bootstrap4${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/tempusdominus-bootstrap4${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'tempusdominus'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\t\tdata = input.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tlocale: data.amsDatetimeLanguage || data.amsLanguage || MyAMS.i18n.language,\n\t\t\t\t\t\t\t\t\ticons: {\n\t\t\t\t\t\t\t\t\t\ttime: 'far fa-clock',\n\t\t\t\t\t\t\t\t\t\tdate: 'far fa-calendar',\n\t\t\t\t\t\t\t\t\t\tup: 'fas fa-arrow-up',\n\t\t\t\t\t\t\t\t\t\tdown: 'fas fa-arrow-down',\n\t\t\t\t\t\t\t\t\t\tprevious: 'fas fa-chevron-left',\n\t\t\t\t\t\t\t\t\t\tnext: 'fas fa-chevron-right',\n\t\t\t\t\t\t\t\t\t\ttoday: 'far fa-calendar-check-o',\n\t\t\t\t\t\t\t\t\t\tclear: 'far fa-trash',\n\t\t\t\t\t\t\t\t\t\tclose: 'far fa-times'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tdate: input.val(),\n\t\t\t\t\t\t\t\t\tformat: data.amsDatetimeFormat || data.amsFormat\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.datetimeOptions || data.options);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDatetimeInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, input, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tinput.trigger('before-init.ams.datetime', [input, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinput.datetimepicker(settings);\n\t\t\t\t\t\t\tconst plugin = input.data('datetimepicker');\n\t\t\t\t\t\t\tif (data.amsDatetimeIsoTarget || data.amsIsoTarget) {\n\t\t\t\t\t\t\t\tinput.on('change.datetimepicker', (evt) => {\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tsource = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\tdata = source.data(),\n\t\t\t\t\t\t\t\t\t\ttarget = $(data.amsDatetimeIsoTarget || data.amsIsoTarget);\n\t\t\t\t\t\t\t\t\ttarget.val(evt.date ? evt.date.toISOString(true) : null);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinput.trigger('after-init.ams.datetime', [input, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}, reject).then(() => {\n\t\t\t\t\tresolve(inputs);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * JQuery-UI drag and drop plug-ins\n */\n\nexport function dragdrop(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst dragitems = $('.draggable, .droppable, .sortable, .resizable', element);\n\t\tif (dragitems.length > 0) {\n\t\t\tMyAMS.ajax.check($.fn.draggable,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tMyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/jquery-ui.structure${MyAMS.env.extext}.css`, 'jquery-ui').then(() => {\n\t\t\t\t\tdragitems.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\titem = $(elt),\n\t\t\t\t\t\t\tdata = item.data();\n\t\t\t\t\t\t// draggable components\n\t\t\t\t\t\tif (item.hasClass('draggable')) {\n\t\t\t\t\t\t\tconst dragOptions = {\n\t\t\t\t\t\t\t\tcursor: data.amsDraggableCursor || 'move',\n\t\t\t\t\t\t\t\tcontainment: data.amsDraggableContainment,\n\t\t\t\t\t\t\t\thandle: data.amsDraggableHandle,\n\t\t\t\t\t\t\t\tconnectToSortable: data.amsDraggableConnectSortable,\n\t\t\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsDraggableHelper) || data.amsDraggableHelper,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsDraggableStart),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsDraggableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dragOptions,\n\t\t\t\t\t\t\t\tdata.amsDraggableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDraggableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.draggable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.draggable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDraggableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.draggable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// droppable components\n\t\t\t\t\t\tif (item.hasClass('droppable')) {\n\t\t\t\t\t\t\tconst dropOptions = {\n\t\t\t\t\t\t\t\taccept: data.amsDroppableAccept || data.amsAccept,\n\t\t\t\t\t\t\t\tdrop: MyAMS.core.getFunctionByName(data.amsDroppableDrop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dropOptions,\n\t\t\t\t\t\t\t\tdata.amsDroppableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDroppableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.droppable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.droppable(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDroppableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.droppable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// sortable components\n\t\t\t\t\t\tif (item.hasClass('sortable')) {\n\t\t\t\t\t\t\tconst sortOptions = {\n\t\t\t\t\t\t\t\titems: data.amsSortableItems,\n\t\t\t\t\t\t\t\thandle: data.amsSortableHandle,\n\t\t\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsSortableHelper) || data.amsSortableHelper,\n\t\t\t\t\t\t\t\tconnectWith: data.amsSortableConnectwith,\n\t\t\t\t\t\t\t\tcontainment: data.amsSortableContainment,\n\t\t\t\t\t\t\t\tplaceholder: data.amsSortablePlaceholder,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsSortableStart),\n\t\t\t\t\t\t\t\tover: MyAMS.core.getFunctionByName(data.amsSortableOver),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsSortableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, sortOptions,\n\t\t\t\t\t\t\t\tdata.amsSortableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSortableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.sortable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.sortable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSortableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.sortable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// resizable components\n\t\t\t\t\t\tif (item.hasClass('resizable')) {\n\t\t\t\t\t\t\tconst resizeOptions = {\n\t\t\t\t\t\t\t\tautoHide: data.amsResizableAutohide === false ? true : data.amsResizableAutohide,\n\t\t\t\t\t\t\t\tcontainment: data.amsResizableContainment,\n\t\t\t\t\t\t\t\tgrid: data.amsResizableGrid,\n\t\t\t\t\t\t\t\thandles: data.amsResizableHandles,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsResizableStart),\n\t\t\t\t\t\t\t\tresize: MyAMS.core.getFunctionByName(data.amsResizableResize),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsResizableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, resizeOptions,\n\t\t\t\t\t\t\t\tdata.amsResizableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsResizableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.resizable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.resizable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsResizableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.resizable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, reject).then(() => {\n\t\t\t\tresolve(dragitems);\n\t\t\t});\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * ACE text editor\n */\n\nexport function editor(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst editors = $('.editor textarea', element);\n\t\tif (editors.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check(window.ace,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/ace/ace${MyAMS.env.extext}.js`).then((firstLoad) => {\n\n\t\t\t\t\tconst\n\t\t\t\t\t\tace = window.ace,\n\t\t\t\t\t\tdeferred = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\tace.config.set('basePath', `${MyAMS.env.baseURL}../ext/ace`);\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/ace/ext-modelist${MyAMS.env.extext}.js`));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, deferred).then(() => {\n\t\t\t\t\t\teditors.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\ttextarea = $(elt),\n\t\t\t\t\t\t\t\twidget = textarea.parents('.editor'),\n\t\t\t\t\t\t\t\tdata = textarea.data(),\n\t\t\t\t\t\t\t\tmodeList = ace.require('ace/ext/modelist'),\n\t\t\t\t\t\t\t\tmode = data.amsEditorMode || data.amsMode ||\n\t\t\t\t\t\t\t\t\tmodeList.getModeForPath(data.amsEditorFilename || data.amsFilename || 'text.txt').mode;\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t// create editor DIV\n\t\t\t\t\t\t\t\tconst textEditor = $('<div>', {\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\twidth: textarea.width(),\n\t\t\t\t\t\t\t\t\theight: textarea.height(),\n\t\t\t\t\t\t\t\t\t'class': textarea.attr('class')\n\t\t\t\t\t\t\t\t}).insertBefore(textarea);\n\t\t\t\t\t\t\t\ttextarea.css('display', 'none');\n\t\t\t\t\t\t\t\t// initialize editor\n\t\t\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\t\t\tmode: mode,\n\t\t\t\t\t\t\t\t\tfontSize: 12,\n\t\t\t\t\t\t\t\t\ttabSize: 4,\n\t\t\t\t\t\t\t\t\tuseSoftTabs: false,\n\t\t\t\t\t\t\t\t\tshowGutter: true,\n\t\t\t\t\t\t\t\t\tshowLineNumbers: true,\n\t\t\t\t\t\t\t\t\tprintMargin: 132,\n\t\t\t\t\t\t\t\t\tshowInvisibles: true\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsEditorOptions || data.amsOptions);\n\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsEditorInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\t\tdocument, textarea, settings) || settings;\n\t\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\t\ttextarea.trigger('before-init.ams.editor', [textarea, settings, veto]);\n\t\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst editor = ace.edit(textEditor[0]);\n\t\t\t\t\t\t\t\teditor.setOptions(settings);\n\t\t\t\t\t\t\t\tif (MyAMS.theme === 'darkmode') {\n\t\t\t\t\t\t\t\t\teditor.setTheme('ace/theme/dracula');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\teditor.setTheme('ace/theme/textmate');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\teditor.session.setValue(textarea.val());\n\t\t\t\t\t\t\t\tif (textarea.attr('disabled')) {\n\t\t\t\t\t\t\t\t\teditor.setReadOnly(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\teditor.session.on('change', () => {\n\t\t\t\t\t\t\t\t\ttextarea.val(editor.session.getValue());\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twidget.data('editor', editor);\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsEditorAfterEditCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\tdocument, textarea, editor, settings);\n\t\t\t\t\t\t\t\ttextarea.trigger('after-init.ams.editor', [textarea, editor]);\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, reject).then(() => {\n\t\t\t\tresolve(editors);\n\t\t\t})\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap custom file input manager\n */\n\nexport function fileInput(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.custom-file-input', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check(window.bsCustomFileInput,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bs-custom-file-input${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\tinputId = input.attr('id'),\n\t\t\t\t\t\t\tinputSelector = inputId ? `#${inputId}` : input.attr('name'),\n\t\t\t\t\t\t\tform = $(elt.form),\n\t\t\t\t\t\t\tformId = form.attr('id'),\n\t\t\t\t\t\t\tformSelector = formId ? `#${formId}` : form.attr('name'),\n\t\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\t\tinput.trigger('before-init.ams.fileinput', [input, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbsCustomFileInput.init(inputSelector, formSelector);\n\t\t\t\t\t\tinput.trigger('after-init.ams.fileinput', [input]);\n\t\t\t\t\t});\n\t\t\t\t}, reject).then(() => {\n\t\t\t\t\tresolve(inputs);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Image area select plug-in integration\n */\n\nexport function imgAreaSelect(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst images = $('.imgareaselect', element);\n\t\tif (images.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.imgAreaSelect,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-imgareaselect${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/imgareaselect-animated${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'imgareaselect'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\timages.each((idx, elt) => {\n\t\t\t\t\t\t\tconst image = $(elt);\n\t\t\t\t\t\t\tif (image.data('imgAreaSelect')) {\n\t\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tdata = image.data(),\n\t\t\t\t\t\t\t\tparentSelector = data.amsImgareaselectParent || data.amsParent,\n\t\t\t\t\t\t\t\tparent = parentSelector ? image.parents(parentSelector) : 'body',\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tinstance: true,\n\t\t\t\t\t\t\t\t\thandles: true,\n\t\t\t\t\t\t\t\t\tparent: parent,\n\t\t\t\t\t\t\t\t\tx1: data.amsImgareaselectX1 || data.amsX1 || 0,\n\t\t\t\t\t\t\t\t\ty1: data.amsImgareaselectY1 || data.amsY1 || 0,\n\t\t\t\t\t\t\t\t\tx2: data.amsImgareaselectX2 || data.amsX2 ||\n\t\t\t\t\t\t\t\t\t\tdata.amsImgareaselectImageWidth || data.amsImageWidth,\n\t\t\t\t\t\t\t\t\ty2: data.amsImgareaselectY2 || data.amsY2 ||\n\t\t\t\t\t\t\t\t\t\tdata.amsImgareaselectImageHeight || data.amsImageHeight,\n\t\t\t\t\t\t\t\t\timageWidth: data.amsImgareaselectImageWidth || data.amsImageWidth,\n\t\t\t\t\t\t\t\t\timageHeight: data.amsImgareaselectImageHeight || data.amsImageHeight,\n\t\t\t\t\t\t\t\t\timgWidth: data.amsImgareaselectThumbWidth || data.amsThumbWidth,\n\t\t\t\t\t\t\t\t\timgHeight: data.amsImgareaselectThumbHeight || data.amsThumbHeight,\n\t\t\t\t\t\t\t\t\tminWidth: 128,\n\t\t\t\t\t\t\t\t\tminHeight: 128,\n\t\t\t\t\t\t\t\t\taspectRatio: data.amsImgareaselectAspectRatio || data.amsAspectRatio,\n\t\t\t\t\t\t\t\t\tonSelectEnd: MyAMS.core.getFunctionByName(data.amsImgareaselectSelectEnd || data.amsSelectedEnd) || function(img, selection) {\n\t\t\t\t\t\t\t\t\t\tconst target = data.amsImgareaselectTargetField || data.amsTargetField || 'image_';\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}x1\"]`, parent).val(selection.x1);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}y1\"]`, parent).val(selection.y1);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}x2\"]`, parent).val(selection.x2);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}y2\"]`, parent).val(selection.y2);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsImgareaselectOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsImgareaselectInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, image, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\timage.trigger('before-init.ams.imgareaselect', [image, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// add timeout to update plug-in if displayed into a modal dialog\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst plugin = image.imgAreaSelect(settings);\n\t\t\t\t\t\t\t\timage.trigger('after-init.ams.imgareaselect', [image, plugin]);\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, reject).then(() => {\n\t\t\t\t\t\tresolve(images);\n\t\t\t\t\t})\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Select2 plug-in integration\n */\n\nconst _select2Helpers = {\n\n\tselect2UpdateHiddenField: (input) => {\n\t\tconst values = [];\n\t\tinput.parent().find('ul.select2-selection__rendered').children('li[title]').each((idx, elt) => {\n\t\t\tvalues.push(input.children(`option[data-content=\"${elt.title}\"]`).attr('value'));\n\t\t});\n\t\tinput.data('select2-target').val(values.join(input.data('ams-select2-separator') || ','));\n\t},\n\n\tselect2AjaxParamsHelper: (params, data) => {\n\t\treturn Object.assign({}, params, data);\n\t}\n};\n\nexport function select2(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst selects = $('.select2', element);\n\t\tif (selects.length > 0) {\n\t\t\tMyAMS.require('ajax', 'helpers').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.select2,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/select2/select2${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/select2/i18n/${MyAMS.i18n.language}.js`));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tselects.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tselect = $(elt),\n\t\t\t\t\t\t\t\tdata = select.data();\n\t\t\t\t\t\t\tif (data.select2) {\n\t\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\t\ttheme: data.amsSelect2Theme || data.amsTheme || 'bootstrap4',\n\t\t\t\t\t\t\t\tlanguage: data.amsSelect2Language || data.amsLanguage || MyAMS.i18n.language,\n\t\t\t\t\t\t\t\tescapeMarkup: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2EscapeMarkup || data.amsEscapeMarkup),\n\t\t\t\t\t\t\t\tmatcher: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Matcher || data.amsMatcher),\n\t\t\t\t\t\t\t\tsorter: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Sorter || data.amsSorter),\n\t\t\t\t\t\t\t\ttemplateResult: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2TemplateResult || data.amsTemplateResult),\n\t\t\t\t\t\t\t\ttemplateSelection: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2TemplateSelection || data.amsTemplateSelection),\n\t\t\t\t\t\t\t\ttokenizer: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Tokenizer || data.amsTokenizer)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst ajaxUrl = data.amsSelect2AjaxUrl || data.amsAjaxUrl || data['ajax-Url'];\n\t\t\t\t\t\t\tif (ajaxUrl) {\n\t\t\t\t\t\t\t\t// check AJAX data helper function\n\t\t\t\t\t\t\t\tlet ajaxParamsHelper;\n\t\t\t\t\t\t\t\tconst ajaxParams = MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxParams || data.amsAjaxParams || data['ajax-Params']) ||\n\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxParams || data.amsAjaxParams || data['ajax-Params'];\n\t\t\t\t\t\t\t\tif (typeof ajaxParams === 'function') {\n\t\t\t\t\t\t\t\t\tajaxParamsHelper = ajaxParams;\n\t\t\t\t\t\t\t\t} else if (ajaxParams) {\n\t\t\t\t\t\t\t\t\tajaxParamsHelper = (params) => {\n\t\t\t\t\t\t\t\t\t\treturn _select2Helpers.select2AjaxParamsHelper(params, ajaxParams);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdefaultOptions.ajax = {\n\t\t\t\t\t\t\t\t\turl: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxUrl || data.amsAjaxUrl) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxUrl || data.amsAjaxUrl,\n\t\t\t\t\t\t\t\t\tdata: ajaxParamsHelper || MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxData || data.amsAjaxData) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxData || data.amsAjaxData,\n\t\t\t\t\t\t\t\t\tprocessResults: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxProcessResults || data.amsAjaxProcessResults) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxProcessResults || data.amsAjaxProcessResults,\n\t\t\t\t\t\t\t\t\ttransport: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxTransport || data.amsAjaxTransport) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxTransport || data.amsAjaxTransport\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tdefaultOptions.minimumInputLength = data.amsSelect2MinimumInputLength ||\n\t\t\t\t\t\t\t\t\tdata.amsMinimumInputLength || data.minimumInputLength || 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t\t// create hidden input for sortable selections\n\t\t\t\t\t\t\t\tconst hidden = $(`<input type=\"hidden\" name=\"${select.attr('name')}\">`).insertAfter(select);\n\t\t\t\t\t\t\t\thidden.val($('option:selected', select).listattr('value').join(data.amsSelect2Separator || ','));\n\t\t\t\t\t\t\t\tselect.data('select2-target', hidden)\n\t\t\t\t\t\t\t\t\t.removeAttr('name');\n\t\t\t\t\t\t\t\tdefaultOptions.templateSelection = (data) => {\n\t\t\t\t\t\t\t\t\tconst elt = $(data.element);\n\t\t\t\t\t\t\t\t\telt.attr('data-content', elt.html());\n\t\t\t\t\t\t\t\t\treturn data.text;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsSelect2Options || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSelect2InitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, select, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tselect.trigger('before-init.ams.select2', [select, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = select.select2(settings);\n\t\t\t\t\t\t\tselect.on('select2:opening select2:selecting select2:unselecting select2:clearing', (evt) => {\n\t\t\t\t\t\t\t\t// handle disabled selects\n\t\t\t\t\t\t\t\tif ($(evt.target).is(':disabled')) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tselect.on('select2:opening', (evt) => {\n\t\t\t\t\t\t\t\t// handle z-index in modals\n\t\t\t\t\t\t\t\tconst modal = $(evt.currentTarget).parents('.modal').first();\n\t\t\t\t\t\t\t\tif (modal.exists()) {\n\t\t\t\t\t\t\t\t\tconst zIndex = parseInt(modal.css('z-index'));\n\t\t\t\t\t\t\t\t\tplugin.data('select2').$dropdown.css('z-index', zIndex + 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tselect.on('select2:open', () => {\n\t\t\t\t\t\t\t\t// handle dropdown automatic focus\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tconst dropdown = $('.select2-search__field', plugin.data('select2').$dropdown);\n\t\t\t\t\t\t\t\t\tif (dropdown.exists()) {\n\t\t\t\t\t\t\t\t\t\tdropdown.get(0).focus();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}, 50);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t\tMyAMS.ajax.check($.fn.sortable,\n\t\t\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t\t\t\tselect.parent().find('ul.select2-selection__rendered').sortable({\n\t\t\t\t\t\t\t\t\t\tcontainment: 'parent',\n\t\t\t\t\t\t\t\t\t\tupdate: () => {\n\t\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(select);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tselect.on('select2:select select2:unselect', (evt) => {\n\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\tid = evt.params.data.id,\n\t\t\t\t\t\t\t\t\t\t\ttarget = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\t\toption = target.children(`option[value=\"${id}\"]`);\n\t\t\t\t\t\t\t\t\t\tMyAMS.helpers.moveElementToParentEnd(option);\n\t\t\t\t\t\t\t\t\t\ttarget.trigger('change');\n\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(target);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSelect2AfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, select, plugin, settings);\n\t\t\t\t\t\t\tselect.trigger('after-init.ams.select2', [select, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, reject).then(() => {\n\t\t\t\t\t\tresolve(selects);\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * SVG image plug-in\n */\n\nexport function svgPlugin(element) {\n\treturn new Promise((resolve) => {\n\t\tconst svgs = $('.svg-container', element);\n\t\tif (svgs.length > 0) {\n\t\t\tsvgs.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tcontainer = $(elt),\n\t\t\t\t\tsvg = $('svg', container),\n\t\t\t\t\twidth = svg.attr('width'),\n\t\t\t\t\theight = svg.attr('height');\n\t\t\t\tif (width && height) {\n\t\t\t\t\telt.setAttribute('viewBox',\n\t\t\t\t\t\t`0 0 ${Math.round(parseFloat(width))} ${Math.round(parseFloat(height))}`);\n\t\t\t\t}\n\t\t\t\tsvg.attr('width', '100%').attr('height', 'auto');\n\t\t\t});\n\t\t\tresolve(svgs);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Fieldset switcher plug-in\n *\n * A switcher is a simple fieldset with a \"switch\" icon in it's legend, which can\n * be used to hide or show fieldset content.\n */\n\nexport function switcher(element) {\n\treturn new Promise((resolve) => {\n\t\tconst switchers = $('legend.switcher', element);\n\t\tif (switchers.length > 0) {\n\t\t\tswitchers.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tlegend = $(elt),\n\t\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\t\tdata = legend.data(),\n\t\t\t\t\tstate = data.amsSwitcherState || data.amsState,\n\t\t\t\t\tminusClass = data.amsSwitcherMinusClass || data.amsMinusClass || 'minus',\n\t\t\t\t\tplusClass = data.amsSwitcherPlusClass || data.amsPlusClass || 'plus';\n\t\t\t\tif (!data.amsSwitcher) {\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\tlegend.trigger('before-init.ams.switcher', [legend, data, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t$(`<i class=\"fa fa-${state === 'open' ? minusClass : plusClass} mr-2\"></i>`)\n\t\t\t\t\t\t.prependTo(legend);\n\t\t\t\t\tlegend.on('click', (evt) => {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\tconst veto = {};\n\t\t\t\t\t\tlegend.trigger('before-switch.ams.switcher', [legend, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fieldset.hasClass('switched')) {\n\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), plusClass, minusClass);\n\t\t\t\t\t\t\tlegend.trigger('opened.ams.switcher', [legend]);\n\t\t\t\t\t\t\tconst id = legend.attr('id');\n\t\t\t\t\t\t\tif (id) {\n\t\t\t\t\t\t\t\t$(`legend.switcher[data-ams-switcher-sync=\"${id}\"]`, fieldset).each((idx, elt) => {\n\t\t\t\t\t\t\t\t\tconst switcher = $(elt);\n\t\t\t\t\t\t\t\t\tif (switcher.parents('fieldset').hasClass('switched')) {\n\t\t\t\t\t\t\t\t\t\tswitcher.click();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), minusClass, plusClass);\n\t\t\t\t\t\t\tlegend.trigger('closed.ams.switcher', [legend]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (state !== 'open') {\n\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t}\n\t\t\t\t\tlegend.trigger('after-init.ams.switcher', [legend]);\n\t\t\t\t\tlegend.data('ams-switcher', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tresolve(switchers);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * TinyMCE HTML editor plug-in\n */\n\nexport function tinymce(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst editors = $('.tinymce', element);\n\t\tif (editors.length > 0) {\n\t\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\t\tconst baseURL = `${MyAMS.env.baseURL}../ext/tinymce${MyAMS.env.devmode ? '/dev': ''}`;\n\t\t\t\tMyAMS.ajax.check(window.tinymce,\n\t\t\t\t\t`${baseURL}/tinymce${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst deferred = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\ttinymce.baseURL = baseURL;\n\t\t\t\t\t\ttinymce.suffix = MyAMS.env.extext;\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(`${baseURL}/jquery.tinymce.min.js`));\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(`${baseURL}/themes/silver/theme${MyAMS.env.extext}.js`));\n\t\t\t\t\t\t// Prevent Bootstrap dialog from blocking focusin\n\t\t\t\t\t\t$(document).on('focusin', (evt) => {\n\t\t\t\t\t\t\tif ($(evt.target).closest(\".tox-tinymce, .tox-tinymce-aux, \" +\n\t\t\t\t\t\t\t\t\".moxman-window, .tam-assetmanager-root\").length) {\n\t\t\t\t\t\t\t\tevt.stopImmediatePropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Remove editor before cleaning content\n\t\t\t\t\t\t$(document).on('clear.ams.content', (evt, veto, element) => {\n\t\t\t\t\t\t\t$('.tinymce', element).each((idx, elt) => {\n\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\teditorId = $(elt).attr('id'),\n\t\t\t\t\t\t\t\t\teditor = window.tinymce.get(editorId);\n\t\t\t\t\t\t\t\tif (editor !== null) {\n\t\t\t\t\t\t\t\t\teditor.remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, deferred).then(() => {\n\t\t\t\t\t\teditors.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\teditor = $(elt),\n\t\t\t\t\t\t\t\tdata = editor.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tselector: `textarea#${editor.attr('id')}`,\n\t\t\t\t\t\t\t\t\tbase_url: baseURL,\n\t\t\t\t\t\t\t\t\ttheme: data.amsTinymceTheme || data.amsTheme || 'silver',\n\t\t\t\t\t\t\t\t\tlanguage: MyAMS.i18n.language,\n\t\t\t\t\t\t\t\t\tmenubar: (data.amsTinymceMenubar !== false) && (data.amsMenubar !== false),\n\t\t\t\t\t\t\t\t\tstatusbar: (data.amsTinymceStatusbar !== false) && (data.amsStatusbar !== false),\n\t\t\t\t\t\t\t\t\tplugins: data.amsTinymcePlugins || data.amsPlugins || [\n\t\t\t\t\t\t\t\t\t\t\"advlist autosave autolink lists link charmap print preview hr anchor pagebreak\",\n\t\t\t\t\t\t\t\t\t\t\"searchreplace wordcount visualblocks visualchars code fullscreen\",\n\t\t\t\t\t\t\t\t\t\t\"insertdatetime nonbreaking save table contextmenu directionality\",\n\t\t\t\t\t\t\t\t\t\t\"emoticons paste textcolor colorpicker textpattern autoresize\"\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ttoolbar: data.amsTinymceToolbar || data.amsToolbar,\n\t\t\t\t\t\t\t\t\ttoolbar1: ((data.amsTinymceToolbar1 === false) || (data.amsToolbar1 === false)) ? false :\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceToolbar1 || data.amsToolbar1 ||\n\t\t\t\t\t\t\t\t\t\t\"undo redo | pastetext | styleselect | bold italic | \" +\n\t\t\t\t\t\t\t\t\t\t\"alignleft aligncenter alignright alignjustify | \" +\n\t\t\t\t\t\t\t\t\t\t\"bullist numlist outdent indent\",\n\t\t\t\t\t\t\t\t\ttoolbar2: ((data.amsTinymceToolbar2 === false) || (data.amsToolbar2 === false)) ? false :\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceToolbar2 || data.amsToolbar2 ||\n\t\t\t\t\t\t\t\t\t\t\"forecolor backcolor emoticons | charmap link image media | \" +\n\t\t\t\t\t\t\t\t\t\t\"fullscreen preview print | code\",\n\t\t\t\t\t\t\t\t\tcontent_css: data.amsTinymceContentCss || data.amsContentCss,\n\t\t\t\t\t\t\t\t\tformats: data.amsTinymceFormats || data.amsFormats,\n\t\t\t\t\t\t\t\t\tstyle_formats: data.amsTinymceStyleFormats || data.amsStyleFormats,\n\t\t\t\t\t\t\t\t\tblock_formats: data.amsTinymceBlockFormats || data.amsBlockFormats,\n\t\t\t\t\t\t\t\t\tvalid_classes: data.amsTinymceValidClasses || data.amsValidClasses,\n\t\t\t\t\t\t\t\t\timage_advtab: true,\n\t\t\t\t\t\t\t\t\timage_list: MyAMS.core.getFunctionByName(data.amsTinymceImageList || data.amsImageList) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceImageList || data.amsImageList,\n\t\t\t\t\t\t\t\t\timage_class_list: data.amsTinymceImageClassList || data.amsImageClassList,\n\t\t\t\t\t\t\t\t\tlink_list: MyAMS.core.getFunctionByName(data.amsTinymceLinkList || data.amsLinkList) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceLinkList || data.amsLinkList,\n\t\t\t\t\t\t\t\t\tlink_class_list: data.amsTinymceLinkClassList || data.amsLinkClassList,\n\t\t\t\t\t\t\t\t\tpaste_as_text: ((data.amsTinymcePasteAsText === undefined) && (data.amsPasteAsText === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteAsText || data.amsPasteAsText,\n\t\t\t\t\t\t\t\t\tpaste_auto_cleanup_on_paste: ((data.amsTinymcePasteAutoCleanup === undefined) && (data.amsPasteAutoCleanup === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteAutoCleanup || data.amsPasteAutoCleanup,\n\t\t\t\t\t\t\t\t\tpaste_strip_class_attributes: data.amsTinymcePasteStripClassAttributes || data.amsPasteStripClassAttributes || 'all',\n\t\t\t\t\t\t\t\t\tpaste_remove_spans: ((data.amsTinymcePasteRemoveSpans === undefined) && (data.amsPasteRemoveSpans === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteRemoveSpans || data.amsPasteRemoveSpans,\n\t\t\t\t\t\t\t\t\tpaste_remove_styles: ((data.amsTinymcePasteRemoveStyles === undefined) || (data.amsPasteRemoveStyles === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteRemoveStyles || data.amsPasteRemoveStyles,\n\t\t\t\t\t\t\t\t\theight: data.amsTinymceHeight || data.amsHeight || 50,\n\t\t\t\t\t\t\t\t\tmin_height: 50,\n\t\t\t\t\t\t\t\t\tresize: true,\n\t\t\t\t\t\t\t\t\tautoresize_min_height: 50,\n\t\t\t\t\t\t\t\t\tautoresize_max_height: 500\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst plugins = data.amsTinymceExternalPlugins || data.amsExternalPlugins;\n\t\t\t\t\t\t\tif (plugins) {\n\t\t\t\t\t\t\t\tconst names = plugins.split(/\\s+/);\n\t\t\t\t\t\t\t\tfor (const name of names) {\n\t\t\t\t\t\t\t\t\tconst src = editor.data(`ams-tinymce-plugin-${name}`) || editor.data(`ams-plugin-${name}`);\n\t\t\t\t\t\t\t\t\twindow.tinymce.PluginManager.load(name, MyAMS.core.getSource(src));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsTinymceOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsTinymceInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, editor, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\teditor.trigger('before-init.ams.tinymce', [editor, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst plugin = editor.tinymce(settings);\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsTinymceAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\tdocument, editor, plugin, settings);\n\t\t\t\t\t\t\t\teditor.trigger('after-init.ams.tinymce', [editor, settings]);\n\t\t\t\t\t\t\t}, 250);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, reject).then(() => {\n\t\t\t\t\t\tresolve(editors);\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap treeview plug-in\n */\n\nexport function treeview(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst trees = $('.treeview', element);\n\t\tif (trees.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.treview,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bootstrap-treeview${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/bootstrap-treeview${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'treeview'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\ttrees.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\ttreeview = $(elt),\n\t\t\t\t\t\t\t\tdata = treeview.data(),\n\t\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\t\tdata: data.amsTreeviewData,\n\t\t\t\t\t\t\t\t\tlevels: data.amsTreeviewLevels,\n\t\t\t\t\t\t\t\t\tinjectStyle: data.amsTreeviewInjectStyle,\n\t\t\t\t\t\t\t\t\texpandIcon: data.amsTreeviewExpandIcon || 'far fa-fw fa-plus-square',\n\t\t\t\t\t\t\t\t\tcollapseIcon: data.amsTreeviewCollaspeIcon || 'far fa-fw fa-minus-square',\n\t\t\t\t\t\t\t\t\temptyIcon: data.amsTreeviewEmptyIcon,\n\t\t\t\t\t\t\t\t\tnodeIcon: data.amsTreeviewNodeIcon,\n\t\t\t\t\t\t\t\t\tselectedIcon: data.amsTreeviewSelectedIcon,\n\t\t\t\t\t\t\t\t\tcheckedIcon: data.amsTreeviewCheckedIcon || 'far fa-fw fa-check-square',\n\t\t\t\t\t\t\t\t\tuncheckedIcon: data.amsTreeviewUncheckedIcon || 'far fa-fw fa-square',\n\t\t\t\t\t\t\t\t\tcolor: data.amsTreeviewColor,\n\t\t\t\t\t\t\t\t\tbackColor: data.amsTreeviewBackColor,\n\t\t\t\t\t\t\t\t\tborderColor: data.amsTreeviewBorderColor,\n\t\t\t\t\t\t\t\t\tonHoverColor: data.amsTreeviewHoverColor,\n\t\t\t\t\t\t\t\t\tselectedColor: data.amsTreeviewSelectedColor,\n\t\t\t\t\t\t\t\t\tselectedBackColor: data.amsTreeviewSelectedBackColor,\n\t\t\t\t\t\t\t\t\tunselectableColor: data.amsTreeviewUnselectableColor || 'rgba(1,1,1,0.25)',\n\t\t\t\t\t\t\t\t\tunselectableBackColor: data.amsTreeviewUnselectableBackColor || 'rgba(1,1,1,0.25)',\n\t\t\t\t\t\t\t\t\tenableLinks: data.amsTreeviewEnableLinks,\n\t\t\t\t\t\t\t\t\thighlightSelected: data.amsTreeviewHighlightSelected,\n\t\t\t\t\t\t\t\t\thighlightSearchResults: data.amsTreeviewhighlightSearchResults,\n\t\t\t\t\t\t\t\t\tshowBorder: data.amsTreeviewShowBorder,\n\t\t\t\t\t\t\t\t\tshowIcon: data.amsTreeviewShowIcon,\n\t\t\t\t\t\t\t\t\tshowCheckbox: data.amsTreeviewShowCheckbox,\n\t\t\t\t\t\t\t\t\tshowTags: data.amsTreeviewShowTags,\n\t\t\t\t\t\t\t\t\ttoggleUnselectable: data.amsTreeviewToggleUnselectable,\n\t\t\t\t\t\t\t\t\tmultiSelect: data.amsTreeviewMultiSelect,\n\t\t\t\t\t\t\t\t\tonNodeChecked: MyAMS.core.getFunctionByName(data.amsTreeviewNodeChecked),\n\t\t\t\t\t\t\t\t\tonNodeCollapsed: MyAMS.core.getFunctionByName(data.amsTreeviewNodeCollapsed),\n\t\t\t\t\t\t\t\t\tonNodeDisabled: MyAMS.core.getFunctionByName(data.amsTreeviewNodeDisabled),\n\t\t\t\t\t\t\t\t\tonNodeEnabled: MyAMS.core.getFunctionByName(data.amsTreeviewNodeEnabled),\n\t\t\t\t\t\t\t\t\tonNodeExpanded: MyAMS.core.getFunctionByName(data.amsTreeviewNodeExpanded),\n\t\t\t\t\t\t\t\t\tonNodeSelected: MyAMS.core.getFunctionByName(data.amsTreeviewNodeSelected),\n\t\t\t\t\t\t\t\t\tonNodeUnchecked: MyAMS.core.getFunctionByName(data.amsTreeviewNodeUnchecked),\n\t\t\t\t\t\t\t\t\tonNodeUnselected: MyAMS.core.getFunctionByName(data.amsTreeviewNodeUnselected),\n\t\t\t\t\t\t\t\t\tonSearchComplete: MyAMS.core.getFunctionByName(data.amsTreeviewSearchComplete),\n\t\t\t\t\t\t\t\t\tonSearchCleared: MyAMS.core.getFunctionByName(data.amsTreeviewSearchCleared)\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsTreeviewOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsTreeviewInitcallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, treeview, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\ttreeview.trigger('before-init.ams.treeview', [treeview, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = treeview.treeview(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsTreeviewAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, treeview, plugin, settings);\n\t\t\t\t\t\t\ttreeview.trigger('after-init.ams.treeview', [treeview, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(trees);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Form validation plug-in\n */\n\nexport function validate(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst forms = $('form:not([novalidate])', element);\n\t\tif (forms.length > 0) {\n\t\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.validate,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/validate/jquery-validate${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tif (firstLoad && (MyAMS.i18n.language !== 'en')) {\n\t\t\t\t\t\tMyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/validate/i18n/messages_${MyAMS.i18n.language}${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tforms.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tform = $(elt),\n\t\t\t\t\t\t\tdata = form.data(),\n\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\tignore: null,\n\t\t\t\t\t\t\t\tinvalidHandler: MyAMS.core.getFunctionByName(data.amsValidateInvalidHandler) || (\n\t\t\t\t\t\t\t\t\t(evt, validator) => {\n\t\t\t\t\t\t\t\t\t\t// automatically display hidden fields with errors!\n\t\t\t\t\t\t\t\t\t\t$('span.is-invalid', form).remove();\n\t\t\t\t\t\t\t\t\t\t$('.is-invalid', form).removeClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\tfor (const error of validator.errorList) {\n\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\telement = $(error.element),\n\t\t\t\t\t\t\t\t\t\t\t\tpanels = element.parents('.tab-pane'),\n\t\t\t\t\t\t\t\t\t\t\t\tfieldsets = element.parents('fieldset.switched');\n\t\t\t\t\t\t\t\t\t\t\tfieldsets.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t\t$('legend.switcher', elt).click();\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\tpanels.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\t\tpanel = $(elt),\n\t\t\t\t\t\t\t\t\t\t\t\t\ttabs = panel.parents('.tab-content')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.siblings('.nav-tabs');\n\t\t\t\t\t\t\t\t\t\t\t\t$(`li:nth-child(${panel.index() + 1})`, tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.addClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\t\t\t$('li.is-invalid:first a', tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.click();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\terrorElement: data.amsValidateErrorElement || 'span',\n\t\t\t\t\t\t\t\terrorClass: data.amsValidateErrorClass || 'is-invalid',\n\t\t\t\t\t\t\t\terrorPlacement: MyAMS.core.getFunctionByName(data.amsValidateErrorPlacement) ||\n\t\t\t\t\t\t\t\t\t((error, element) => {\n\t\t\t\t\t\t\t\t\t\terror.addClass('invalid-feedback');\n\t\t\t\t\t\t\t\t\t\telement.closest('.form-widget').append(error);\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tsubmitHandler: MyAMS.core.getFunctionByName(data.amsValidateSubmitHandler) ||\n\t\t\t\t\t\t\t\t\t(form.attr('data-async') !== undefined ?\n\t\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\t\tMyAMS.require('form').then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.form.submit(form);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t: () => {\n\t\t\t\t\t\t\t\t\t\t\tform.get(0).submit();\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t$('[data-ams-validate-rules]', form).each((idx, elt) => {\n\t\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\t\tdataOptions.rules = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdataOptions.rules[$(elt).attr('name')] = $(elt).data('ams-validate-rules');\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('[data-ams-validate-messages]', form).each((idx, elt) => {\n\t\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\t\tdataOptions.messages = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdataOptions.messages[$(elt).attr('name')] = $(elt).data('ams-validate-messages');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsValidateOptions || data.amsOptions);\n\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsValidateInitCallback ||\n\t\t\t\t\t\t\tdata.amsInit, document, form, settings) || settings;\n\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\tform.trigger('before-init.ams.validate', [form, settings, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst plugin = form.validate(settings);\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsValidateAfterInitCallback ||\n\t\t\t\t\t\t\tdata.amsAfterInit, document, form, plugin, settings);\n\t\t\t\t\t\tform.trigger('after-init.ams.validate', [form, plugin]);\n\t\t\t\t\t});\n\t\t\t\t}, reject).then(() => {\n\t\t\t\t\tresolve(forms);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t}\n\t});\n}\n\n\n/**\n * Global module initialization\n */\n\nif (window.MyAMS) {\n\n\t// register loaded plug-ins\n\tMyAMS.registry.register(checker, 'checker');\n\tMyAMS.registry.register(contextMenu, 'contextMenu');\n\tMyAMS.registry.register(datatables, 'datatables');\n\tMyAMS.registry.register(datetime, 'datetime');\n\tMyAMS.registry.register(dragdrop, 'dragdrop');\n\tMyAMS.registry.register(editor, 'editor');\n\tMyAMS.registry.register(fileInput, 'fileInput');\n\tMyAMS.registry.register(imgAreaSelect, 'imgAreaSelect');\n\tMyAMS.registry.register(select2, 'select2');\n\tMyAMS.registry.register(svgPlugin, 'svg');\n\tMyAMS.registry.register(switcher, 'switcher');\n\tMyAMS.registry.register(tinymce, 'tinymce');\n\tMyAMS.registry.register(treeview, 'treeview');\n\tMyAMS.registry.register(validate, 'validate');\n\n\t// register module\n\tMyAMS.config.modules.push('plugins');\n\tif (!MyAMS.env.bundle) {\n\t\tconsole.debug(\"MyAMS: plugins module loaded...\");\n\t}\n}\n"],"mappings":"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"}