{"version":3,"file":"mod-plugins-dev.js","names":["$","MyAMS","templates","jsrender","require","calendar","element","Promise","resolve","reject","calendars","length","ajax","check","window","FullCalendar","env","baseURL","extext","then","firstLoad","each","idx","elt","data","defaultOptions","plugins","initialView","themeSystem","locale","attr","headerToolbar","start","center","right","bootstrapFontAwesome","prev","next","firstDay","weekNumberCalculation","settings","extend","calendarOptions","options","core","executeFunctionByName","amsCalendarInitCallback","amsInit","document","veto","trigger","Calendar","render","CHECKER_TEMPLATE_STRING","CHECKER_TEMPLATE","markup","checker","checkers","legend","amsChecker","fieldset","parent","state","amsCheckerState","amsState","checked","hasClass","fieldName","amsCheckerFieldname","amsFieldname","generateId","fieldId","replace","prefix","amsCheckerHiddenPrefix","amsHiddenPrefix","marker","amsCheckerMarker","amsMarker","checkerMode","amsCheckerMode","amsMode","checkedValue","amsCheckerValueOn","amsValueOn","uncheckedValue","amsCheckerValueOff","amsValueOff","value","amsCheckerValue","amsValue","readonly","amsCheckerReadonly","amsReadonly","props","text","html","change","evt","input","target","is","prop","amsCheckerChangeHandler","amsChangeHandler","amsCheckerCancelDefault","amsCancelDefault","siblings","removeClass","val","addClass","closest","on","click","colorPicker","inputs","fn","colorpicker","required","push","getCSS","when","apply","dataOptions","format","amsColorpickerFormat","amsFormat","useHashPrefix","amsColorpickerUseHashPrefix","amsUseHashPrefix","useAlpha","amsColorpickerUseAlpha","amsUseAlpha","getFunctionByName","amsColorpickerChange","amsChange","colorpickerChange","amsColorpickerPickerChange","amsPickerChange","colorpickerCreate","amsColorpickerPickerCreate","amsPickerCreate","colorpickerDestroy","amsColorpickerPickerDestroy","amsPickerDestroy","colorpickerEnable","amsColorpickerPickerEnable","amsPickerEnable","colorpickerDisable","amsColorpickerPickerDisable","amsPickerDisable","colorpickerHide","amsColorpickerPickerHide","amsPickerHide","colorpickerInvalid","amsColorpickerPickerInvalid","amsPickerInvalid","colorpickerShow","amsColorpickerPickerShow","amsPickerShow","colorpickerUpdate","amsColorpickerPickerUpdate","amsPickerUpdate","mousemove","amsColorpickerMousemove","amsMousemove","amsColorpickerOptions","amsOptions","amsColorpickerInitCallback","plugin","amsColorpickerAfterInitCallback","amsAfterInit","contextMenu","menus","menu","menuSelector","amsContextmenuSelector","amsMenuSelector","amsContextmenuOptions","amsContextmenuInitCallback","amsContextmenuAfterInitCallback","_datatablesHelpers","init","types","dataTable","ext","type","detect","unshift","match","order","numeric-comma-asc","a","b","x","y","parseFloat","numeric-comma-desc","trimmed","trim","frDate","split","date-euro-asc","date-euro-desc","frDateTime","frTime","datetime-euro-asc","datetime-euro-desc","preReorder","node","table","reorderRows","dtTable","DataTable","amsReorderInputTarget","url","amsReorderUrl","ids","rows","getter","amsReorderData","makeArray","map","listattr","separator","amsReorderSeparator","exists","join","startsWith","location","protocol","postData","amsReorderPostData","amsReorderPostAttr","post","result","status","xhr","removeData","row","parents","get","invalidate","draw","callback","amsReorderCallback","_len","arguments","results","Array","_key","handleJSON","datatables","baseJS","baseCSS","tables","getScript","css","bases","extensions","depends","loaded","buttons","autoFill","AutoFill","Buttons","isArray","buttonDefs","button","exportOptions","columns","buttons_excel","excelHtml5","buttons_pdf","pdfMake","buttons_print","print","buttons_colvis","colvis","colReorder","ColReorder","fixedColumns","FixedColumns","fixedHeader","FixedHeader","keyTable","KeyTable","responsive","Responsive","rowGroup","RowGroup","rowReorder","RowReorder","scroller","Scroller","searchBuilder","SearchBuilder","searchPanes","SearchPanes","select","stateRestore","dataTables","name","Object","entries","isDataTable","dom","amsDatatableDom","amsDom","searching","lengthChange","info","paging","language","amsDatatableLanguage","amsLanguage","i18n","amsDatatableOrder","amsOrder","orders","col","colOrder","parseInt","heads","th","sortables","iterator","sortable","undefined","JSON","parse","stype","amsDatatableOptions","amsDatatableInitCallback","setTimeout","defaults","className","amsDatatableButtonsClassname","amsButtonsClassname","amsDatatableAfterInitCallback","amsDatatablePreReorder","amsPreReorder","amsDatatableReordered","amsReordered","datetime","moment","datetimepicker","amsDatetimeLanguage","icons","time","date","up","down","previous","today","clear","close","amsDatetimeFormat","datetimeOptions","amsDatetimeInitCallback","amsDatetimeIsoTarget","amsIsoTarget","source","currentTarget","toISOString","dragdrop","dragitems","draggable","item","dragOptions","axis","amsDraggableAxis","amsAxis","cursor","amsDraggableCursor","containment","amsDraggableContainment","amsContainment","delay","amsDraggableDelay","amsDelay","handle","amsDraggableHandle","amsHandle","connectToSortable","amsDraggableConnectSortable","amsConnectSortable","revert","amsDraggableRevert","amsRevert","revertDuration","amsDraggableRevertDuration","amsRevertDuration","helper","amsDraggableHelper","amsDraggableStart","ui","stop","amsDraggableStop","amsDraggableOptions","amsDraggableInitCallback","disableSelection","amsDraggableAfterInitCallback","dropOptions","accept","amsDroppableAccept","amsAccept","classes","amsDroppableClasses","drop","amsDroppableDrop","amsDroppableOptions","amsDroppableInitCallback","droppable","amsDroppableAfterInitCallback","sortOptions","items","amsSortableItems","amsSortableHandle","amsSortableHelper","connectWith","amsSortableConnectwith","amsSortableContainment","placeholder","amsSortablePlaceholder","amsSortableStart","over","amsSortableOver","amsSortableStop","amsSortableOptions","amsSortableInitCallback","amsSortableAfterInitCallback","resizeOptions","autoHide","amsResizableAutohide","amsResizableContainment","grid","amsResizableGrid","handles","amsResizableHandles","amsResizableStart","resize","amsResizableResize","amsResizableStop","amsResizableOptions","amsResizableInitCallback","resizable","amsResizableAfterInitCallback","dropzone","paramName","amsDropzoneParamName","amsParamName","amsDropzoneUrl","amsUrl","uploadMultiple","amsDropzoneUploadMultiple","amsUploadMultiple","parallelUploads","amsDropzoneParallelUploads","amsParallelUploads","maxFilesize","amsDropzoneMaxFilesize","amsMaxFilesize","thumbnailWidth","amsDropzoneThumbnailWidth","amsThumbnailWidth","thumbnailHeight","amsDropzoneThumbnailHeight","amsThumbnailHeight","thumbnailMethod","amsDropzoneThumbnailMethod","amsThumbnailMethod","clickable","amsDropzoneClickable","amsCLickable","acceptedFiles","amsDropzoneAcceptedFiles","amsAcceptedFiles","success","amsDropzoneSuccess","amsSuccess","file","amsDropzoneOptions","amsDropzoneInitCallback","editor","editors","ace","deferred","config","set","textarea","widget","modeList","mode","amsEditorMode","getModeForPath","amsEditorFilename","amsFilename","textEditor","position","width","height","insertBefore","fontSize","tabSize","useSoftTabs","showGutter","showLineNumbers","printMargin","showInvisibles","amsEditorOptions","amsEditorInitCallback","edit","setOptions","theme","setTheme","session","setValue","setReadOnly","getValue","amsEditorAfterEditCallback","fileInput","bsCustomFileInput","inputId","inputSelector","form","formId","formSelector","imgAreaSelect","images","image","parentSelector","amsImgareaselectParent","amsParent","instance","x1","amsImgareaselectX1","amsX1","y1","amsImgareaselectY1","amsY1","x2","amsImgareaselectX2","amsX2","amsImgareaselectImageWidth","amsImageWidth","y2","amsImgareaselectY2","amsY2","amsImgareaselectImageHeight","amsImageHeight","imageWidth","imageHeight","imgWidth","amsImgareaselectThumbWidth","amsThumbWidth","imgHeight","amsImgareaselectThumbHeight","amsThumbHeight","minWidth","minHeight","aspectRatio","amsImgareaselectAspectRatio","amsAspectRatio","onSelectEnd","amsImgareaselectSelectEnd","amsSelectedEnd","img","selection","amsImgareaselectTargetField","amsTargetField","amsImgareaselectOptions","amsImgareaselectInitCallback","inputMask","inputmask","mask","toString","amsInputMaskOptions","amsInputmaskInitCallback","amsInputmaskAfterInitCallback","_select2Helpers","select2UpdateHiddenField","values","find","children","title","select2AjaxParamsHelper","params","assign","select2","selects","amsSelect2Theme","amsTheme","amsSelect2Language","escapeMarkup","amsSelect2EscapeMarkup","amsEscapeMarkup","matcher","amsSelect2Matcher","amsMatcher","sorter","amsSelect2Sorter","amsSorter","templateResult","amsSelect2TemplateResult","amsTemplateResult","templateSelection","amsSelect2TemplateSelection","amsTemplateSelection","tokenizer","amsSelect2Tokenizer","amsTokenizer","ajaxUrl","amsSelect2AjaxUrl","amsAjaxUrl","ajaxParamsHelper","ajaxParams","amsSelect2AjaxParams","amsAjaxParams","amsSelect2AjaxData","amsAjaxData","processResults","amsSelect2AjaxProcessResults","amsAjaxProcessResults","transport","amsSelect2AjaxTransport","amsAjaxTransport","minimumInputLength","amsSelect2MinimumInputLength","amsMinimumInputLength","hidden","insertAfter","amsSelect2Separator","removeAttr","amsSelect2Options","amsSelect2InitCallback","modal","first","zIndex","$dropdown","dropdown","focus","update","id","option","helpers","moveElementToParentEnd","amsSelect2AfterInitCallback","svgPlugin","svgs","container","svg","setAttribute","Math","round","switcher","switchers","amsSwitcherState","minusClass","amsSwitcherMinusClass","amsMinusClass","plusClass","amsSwitcherPlusClass","amsPlusClass","amsSwitcher","prependTo","preventDefault","switchIcon","tinymce","devmode","suffix","stopImmediatePropagation","editorId","remove","selector","base_url","amsTinymceTheme","menubar","amsTinymceMenubar","amsMenubar","statusbar","amsTinymceStatusbar","amsStatusbar","amsTinymcePlugins","amsPlugins","toolbar","amsTinymceToolbar","amsToolbar","toolbar1","amsTinymceToolbar1","amsToolbar1","toolbar2","amsTinymceToolbar2","amsToolbar2","content_css","amsTinymceContentCss","amsContentCss","formats","amsTinymceFormats","amsFormats","style_formats","amsTinymceStyleFormats","amsStyleFormats","block_formats","amsTinymceBlockFormats","amsBlockFormats","valid_classes","amsTinymceValidClasses","amsValidClasses","relative_urls","remove_script_host","convert_urls","image_advtab","image_list","amsTinymceImageList","amsImageList","image_class_list","amsTinymceImageClassList","amsImageClassList","link_list","amsTinymceLinkList","amsLinkList","link_class_list","amsTinymceLinkClassList","amsLinkClassList","paste_as_text","amsTinymcePasteAsText","amsPasteAsText","paste_auto_cleanup_on_paste","amsTinymcePasteAutoCleanup","amsPasteAutoCleanup","paste_strip_class_attributes","amsTinymcePasteStripClassAttributes","amsPasteStripClassAttributes","paste_remove_spans","amsTinymcePasteRemoveSpans","amsPasteRemoveSpans","paste_remove_styles","amsTinymcePasteRemoveStyles","amsPasteRemoveStyles","amsTinymceHeight","amsHeight","min_height","autoresize_min_height","autoresize_max_height","amsTinymceExternalPlugins","amsExternalPlugins","names","src","PluginManager","load","getSource","amsTinymceOptions","amsTinymceInitCallback","amsTinymceAfterInitCallback","treeview","trees","treview","amsTreeviewData","levels","amsTreeviewLevels","injectStyle","amsTreeviewInjectStyle","expandIcon","amsTreeviewExpandIcon","collapseIcon","amsTreeviewCollaspeIcon","emptyIcon","amsTreeviewEmptyIcon","nodeIcon","amsTreeviewNodeIcon","selectedIcon","amsTreeviewSelectedIcon","checkedIcon","amsTreeviewCheckedIcon","uncheckedIcon","amsTreeviewUncheckedIcon","color","amsTreeviewColor","backColor","amsTreeviewBackColor","borderColor","amsTreeviewBorderColor","onHoverColor","amsTreeviewHoverColor","selectedColor","amsTreeviewSelectedColor","selectedBackColor","amsTreeviewSelectedBackColor","unselectableColor","amsTreeviewUnselectableColor","unselectableBackColor","amsTreeviewUnselectableBackColor","enableLinks","amsTreeviewEnableLinks","highlightSelected","amsTreeviewHighlightSelected","highlightSearchResults","amsTreeviewhighlightSearchResults","showBorder","amsTreeviewShowBorder","showIcon","amsTreeviewShowIcon","showCheckbox","amsTreeviewShowCheckbox","showTags","amsTreeviewShowTags","toggleUnselectable","amsTreeviewToggleUnselectable","multiSelect","amsTreeviewMultiSelect","onNodeChecked","amsTreeviewNodeChecked","onNodeCollapsed","amsTreeviewNodeCollapsed","onNodeDisabled","amsTreeviewNodeDisabled","onNodeEnabled","amsTreeviewNodeEnabled","onNodeExpanded","amsTreeviewNodeExpanded","onNodeSelected","amsTreeviewNodeSelected","onNodeUnchecked","amsTreeviewNodeUnchecked","onNodeUnselected","amsTreeviewNodeUnselected","onSearchComplete","amsTreeviewSearchComplete","onSearchCleared","amsTreeviewSearchCleared","amsTreeviewOptions","amsTreeviewInitCallback","amsTreeviewAfterInitCallback","validate","forms","ignore","invalidHandler","amsValidateInvalidHandler","validator","error","errorList","panels","fieldsets","panel","tabs","index","errorElement","amsValidateErrorElement","errorClass","amsValidateErrorClass","errorPlacement","amsValidateErrorPlacement","append","submitHandler","amsValidateSubmitHandler","submit","rules","messages","amsValidateOptions","amsValidateInitCallback","amsValidateAfterInitCallback","registry","register","modules","bundle","console","debug"],"sources":["mod-plugins.js"],"sourcesContent":["/* global MyAMS, bsCustomFileInput */\n/**\n * MyAMS standard plugins\n */\n\nconst $ = MyAMS.$;\n\nif (!$.templates) {\n\tconst jsrender = require('jsrender');\n\t$.templates = jsrender.templates;\n}\n\n\n/**\n * FullCalendar plugin\n */\nexport function calendar(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst calendars = $('.calendar', element);\n\t\tif (calendars.length > 0) {\n\t\t\tMyAMS.ajax.check(window.FullCalendar,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/fullcalendar-global${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\tcalendars.each((idx, elt) => {\n\t\t\t\t\tconst\n\t\t\t\t\t\telement = $(elt),\n\t\t\t\t\t\tdata = element.data(),\n\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\tplugins: [],\n\t\t\t\t\t\t\tinitialView: 'dayGridMonth',\n\t\t\t\t\t\t\tthemeSystem: 'bootstrap',\n\t\t\t\t\t\t\tlocale: $('html').attr('lang'),\n\t\t\t\t\t\t\theaderToolbar: {\n\t\t\t\t\t\t\t\tstart: 'title',\n\t\t\t\t\t\t\t\tcenter: 'today',\n\t\t\t\t\t\t\t\tright: 'prev,next'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbootstrapFontAwesome: {\n\t\t\t\t\t\t\t\tprev: 'fa-chevron-left',\n\t\t\t\t\t\t\t\tnext: 'fa-chevron-right'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfirstDay: 1,\n\t\t\t\t\t\t\tweekNumberCalculation: 'ISO'\n\t\t\t\t\t\t};\n\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.calendarOptions || data.options);\n\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsCalendarInitCallback || data.amsInit,\n\t\t\t\t\t\tdocument, element, settings) || settings;\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\telement.trigger('before-init.ams.calendar', [element, settings, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst calendar = new FullCalendar.Calendar(elt, settings);\n\t\t\t\t\telement.trigger('after-init.ams.calendar', [element, calendar]);\n\t\t\t\t\tcalendar.render();\n\t\t\t\t});\n\t\t\t\tresolve(calendars);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Fieldset checker plug-in\n *\n * A checker is like a simple switcher, but also provides a checkbox which is used\n * as \"switcher\" input field.\n *\n * The \"checker\" class is applied to the fieldset legend; checkbox is created automatically\n * by the plug-in.\n * Check options are given as data attributes, all prefixed with \"ams-checker-\":\n *  - state: is 'off' by default; can be set to 'on' to automatically activate the checker\n *  - mode: is 'hide' by default, which make the fieldset hidden when the checker is not activated;\n *    you cna set it to \"disable\" to make fieldset content visible but disabled when the checker\n *    is not activated\n *  - fieldname: is the name of the input checkbox created by the plug-in\n *  - value: this is the \"checked\" value of the main checkbox field\n *  - readonly: if \"true\", the checkbox is disabled and in read-only mode\n *  - hidden-prefix: if not null, this is a prefix which will be assigned to an additional\n *    hidden input field, updated automatically when the checker is switched; the name of the\n *    hidden input if made of this prefix, followed by the \"fieldname\" value\n *  - value-on: this is the \"checked\" value of the hidden input; \"true\" by default\n *  - value-off: this is the \"unchecked\" value of the hidden input; \"false\" by default\n *  - marker: if not null, another hidden input with a fixed value of 1 will be created; the name\n *    of this input will be the \"fieldname\" value followed by this \"marker\" value\n *  - change-handler: this optional handler will be called on checker switch\n *  - cancel-default: if \"true\", the default behaviour will not be executed on checker switch\n */\n\nconst CHECKER_TEMPLATE_STRING = `\n\t<span class=\"custom-control custom-switch\">\n\t\t<input type=\"checkbox\"\n\t\t\t   id=\"{{: fieldId }}\" name=\"{{: fieldName }}\"\n\t\t\t   class=\"custom-control-input checker\"\n\t\t\t   {{if checked}}checked{{/if}}\n\t\t\t   {{if readonly}}disabled{{/if}}\n\t\t\t   value=\"{{: value }}\" />\n\t\t{{if prefix}}\n\t\t<input type=\"hidden\" class=\"prefix\"\n\t\t\t   id=\"{{: prefix}}{{: fieldName}}_prefix\"\n\t\t\t   name=\"{{: prefix}}{{: fieldName}}\"\n\t\t\t   value=\"{{if state==='on'}}{{: checkedValue}}{{else}}{{: uncheckedValue}}{{/if}}\" />\n\t\t{{else marker}}\n\t\t<input type=\"hidden\" class=\"marker\"\n\t\t\t   name=\"{{: fieldName}}{{: marker}}\"\n\t\t\t   value=\"1\" />\n\t\t{{/if}}\n\t\t<label for=\"{{: fieldId }}\"\n\t\t\t   class=\"custom-control-label\">\n\t\t\t{{: legend }}\n\t\t</label>\n\t</span>\n`;\n\nconst CHECKER_TEMPLATE = $.templates({\n\tmarkup: CHECKER_TEMPLATE_STRING\n});\n\nexport function checker(element) {\n\treturn new Promise((resolve) => {\n\t\tconst checkers = $('legend.checker', element);\n\t\tif (checkers.length > 0) {\n\t\t\tcheckers.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tlegend = $(elt),\n\t\t\t\t\tdata = legend.data();\n\t\t\t\tif (!data.amsChecker) {\n\t\t\t\t\tconst\n\t\t\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\t\t\tstate = data.amsCheckerState || data.amsState,\n\t\t\t\t\t\tchecked = fieldset.hasClass('switched') || (state === 'on'),\n\t\t\t\t\t\tfieldName = data.amsCheckerFieldname || data.amsFieldname || `checker_${MyAMS.core.generateId()}`,\n\t\t\t\t\t\tfieldId = fieldName.replace(/\\./g, '_'),\n\t\t\t\t\t\tprefix = data.amsCheckerHiddenPrefix || data.amsHiddenPrefix,\n\t\t\t\t\t\tmarker = data.amsCheckerMarker || data.amsMarker || false,\n\t\t\t\t\t\tcheckerMode = data.amsCheckerMode || data.amsMode || 'hide',\n\t\t\t\t\t\tcheckedValue = data.amsCheckerValueOn || data.amsValueOn || 'true',\n\t\t\t\t\t\tuncheckedValue = data.amsCheckerValueOff || data.amsValueOff || 'false',\n\t\t\t\t\t\tvalue = data.amsCheckerValue || data.amsValue,\n\t\t\t\t\t\treadonly = data.amsCheckerReadonly || data.amsReadonly,\n\t\t\t\t\t\tprops = {\n\t\t\t\t\t\t\tlegend: legend.text(),\n\t\t\t\t\t\t\tfieldName: fieldName,\n\t\t\t\t\t\t\tfieldId: fieldId,\n\t\t\t\t\t\t\tvalue: value || true,\n\t\t\t\t\t\t\tchecked: checked,\n\t\t\t\t\t\t\treadonly: readonly,\n\t\t\t\t\t\t\tprefix: prefix,\n\t\t\t\t\t\t\tstate: state,\n\t\t\t\t\t\t\tcheckedValue: checkedValue,\n\t\t\t\t\t\t\tuncheckedValue: uncheckedValue,\n\t\t\t\t\t\t\tmarker: marker\n\t\t\t\t\t\t},\n\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\tlegend.trigger('before-init.ams.checker', [legend, props, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlegend.html(CHECKER_TEMPLATE.render(props));\n\t\t\t\t\t$('input', legend).change((evt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tinput = $(evt.target),\n\t\t\t\t\t\t\tchecked = input.is(':checked'),\n\t\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\t\tlegend.trigger('before-switch.ams.checker', [legend, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\tinput.prop('checked', !checked);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsCheckerChangeHandler ||\n\t\t\t\t\t\t\tdata.amsChangeHandler, document, legend, checked);\n\t\t\t\t\t\tif (!data.amsCheckerCancelDefault && !data.amsCancelDefault) {\n\t\t\t\t\t\t\tconst prefix = input.siblings('.prefix');\n\t\t\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\t\t\tprefix.val(checkedValue);\n\t\t\t\t\t\t\t\t\tlegend.trigger('opened.ams.checker', [legend]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\t\t\tprefix.val(uncheckedValue);\n\t\t\t\t\t\t\t\t\tlegend.trigger('closed.ams.checker', [legend]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfieldset.prop('disabled', !checked);\n\t\t\t\t\t\t\t\tprefix.val(checked ? checkedValue : uncheckedValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tlegend.closest('form').on('reset', () => {\n\t\t\t\t\t\tconst checker = $('.checker', legend);\n\t\t\t\t\t\tif (checker.prop('checked') !== checked) {\n\t\t\t\t\t\t\tchecker.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!checked) {\n\t\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.prop('disabled', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlegend.trigger('after-init.ams.checker', [legend]);\n\t\t\t\t\tlegend.data('ams-checker', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tresolve(checkers);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Colorpicker menu plug-in\n */\n\nexport function colorPicker(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.color', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.colorpicker,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bootstrap-colorpicker${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/bootstrap-colorpicker${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'colorpicker'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\t\tdata = input.data(),\n\t\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\t\tformat: data.amsColorpickerFormat || data.amsFormat || 'hex',\n\t\t\t\t\t\t\t\t\tuseHashPrefix: (data.amsColorpickerUseHashPrefix || data.amsUseHashPrefix || false) !== false,\n\t\t\t\t\t\t\t\t\tuseAlpha: (data.amsColorpickerUseAlpha || data.amsUseAlpha || false) !== false,\n\t\t\t\t\t\t\t\t\tchange: MyAMS.core.getFunctionByName(data.amsColorpickerChange || data.amsChange),\n\t\t\t\t\t\t\t\t\tcolorpickerChange: MyAMS.core.getFunctionByName(data.amsColorpickerPickerChange || data.amsPickerChange),\n\t\t\t\t\t\t\t\t\tcolorpickerCreate: MyAMS.core.getFunctionByName(data.amsColorpickerPickerCreate || data.amsPickerCreate),\n\t\t\t\t\t\t\t\t\tcolorpickerDestroy: MyAMS.core.getFunctionByName(data.amsColorpickerPickerDestroy || data.amsPickerDestroy),\n\t\t\t\t\t\t\t\t\tcolorpickerEnable: MyAMS.core.getFunctionByName(data.amsColorpickerPickerEnable || data.amsPickerEnable),\n\t\t\t\t\t\t\t\t\tcolorpickerDisable: MyAMS.core.getFunctionByName(data.amsColorpickerPickerDisable || data.amsPickerDisable),\n\t\t\t\t\t\t\t\t\tcolorpickerHide: MyAMS.core.getFunctionByName(data.amsColorpickerPickerHide || data.amsPickerHide),\n\t\t\t\t\t\t\t\t\tcolorpickerInvalid: MyAMS.core.getFunctionByName(data.amsColorpickerPickerInvalid || data.amsPickerInvalid),\n\t\t\t\t\t\t\t\t\tcolorpickerShow: MyAMS.core.getFunctionByName(data.amsColorpickerPickerShow || data.amsPickerShow),\n\t\t\t\t\t\t\t\t\tcolorpickerUpdate: MyAMS.core.getFunctionByName(data.amsColorpickerPickerUpdate || data.amsPickerUpdate),\n\t\t\t\t\t\t\t\t\tmousemove: MyAMS.core.getFunctionByName(data.amsColorpickerMousemove || data.amsMousemove),\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsColorpickerOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsColorpickerInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, input, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tinput.trigger('before-init.ams.colorpicker', [input, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = input.colorpicker(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsColorpickerAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, input, plugin, settings);\n\t\t\t\t\t\t\tinput.trigger('after-init.ams.colorpicker', [input, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(inputs);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Context menu plug-in\n */\n\nexport function contextMenu(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst menus = $('.context-menu', element);\n\t\tif (menus.length > 0) {\n\t\t\tMyAMS.require('menu').then(() => {\n\t\t\t\tmenus.each((idx, elt) => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tmenu = $(elt),\n\t\t\t\t\t\tdata = menu.data(),\n\t\t\t\t\t\toptions = {\n\t\t\t\t\t\t\tmenuSelector: data.amsContextmenuSelector || data.amsMenuSelector\n\t\t\t\t\t\t};\n\t\t\t\t\tlet settings = $.extend({}, options, data.amsContextmenuOptions || data.amsOptions);\n\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsContextmenuInitCallback || data.amsInit,\n\t\t\t\t\t\tdocument, menu, settings) || settings;\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\tmenu.trigger('before-init.ams.contextmenu', [menu, settings, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst plugin = menu.contextMenu(settings);\n\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\tdata.amsContextmenuAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\tdocument, menu, plugin, settings);\n\t\t\t\t\tmenu.trigger('after-init.ams.contextmenu', [menu, plugin]);\n\t\t\t\t});\n\t\t\t\tresolve(menus);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * JQuery Datatable plug-in\n */\n\nconst _datatablesHelpers = {\n\n\tinit: () => {\n\n\t\t// Add autodetect formats\n\t\tconst types = $.fn.dataTable.ext.type;\n\n\t\ttypes.detect.unshift((data) => {\n\t\t\tif (data !== null && data.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\\/(0[1-9]|1[0-2])\\/[0-3][0-9]{3}$/)) {\n\t\t\t\treturn 'date-euro';\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\ttypes.detect.unshift((data) => {\n\t\t\tif (data !== null && data.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\\/(0[1-9]|1[0-2])\\/[0-3][0-9]{3} - ([0-1][0-9]|2[0-3]):[0-5][0-9]$/)) {\n\t\t\t\treturn 'datetime-euro';\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\n\t\t// Add sorting methods\n\t\t$.extend(types.order, {\n\n\t\t\t// numeric values using commas separators\n\t\t\t\"numeric-comma-asc\": (a, b) => {\n\t\t\t\tlet x = a.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tlet y = b.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tx = parseFloat(x);\n\t\t\t\ty = parseFloat(y);\n\t\t\t\treturn ((x < y) ? -1 : ((x > y) ? 1 : 0));\n\t\t\t},\n\t\t\t\"numeric-comma-desc\": (a, b) => {\n\t\t\t\tlet x = a.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tlet y = b.replace(/,/, \".\").replace(/ /g, '');\n\t\t\t\tx = parseFloat(x);\n\t\t\t\ty = parseFloat(y);\n\t\t\t\treturn ((x < y) ? 1 : ((x > y) ? -1 : 0));\n\t\t\t},\n\n\t\t\t// date-euro column sorter\n\t\t\t\"date-euro-pre\": (a) => {\n\t\t\t\tconst trimmed = $.trim(a);\n\t\t\t\tlet x;\n\t\t\t\tif (trimmed !== '') {\n\t\t\t\t\tconst frDate = trimmed.split('/');\n\t\t\t\t\tx = (frDate[2] + frDate[1] + frDate[0]) * 1;\n\t\t\t\t} else {\n\t\t\t\t\tx = 10000000; // = l'an 1000 ...\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t},\n\t\t\t\"date-euro-asc\": (a, b) => {\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\t\"date-euro-desc\": (a, b) => {\n\t\t\t\treturn b - a;\n\t\t\t},\n\n\t\t\t// datetime-euro column sorter\n\t\t\t\"datetime-euro-pre\": (a) => {\n\t\t\t\tconst trimmed = $.trim(a);\n\t\t\t\tlet x;\n\t\t\t\tif (trimmed !== '') {\n\t\t\t\t\tconst frDateTime = trimmed.split(' - ');\n\t\t\t\t\tconst frDate = frDateTime[0].split('/');\n\t\t\t\t\tconst frTime = frDateTime[1].split(':');\n\t\t\t\t\tx = (frDate[2] + frDate[1] + frDate[0] + frTime[0] + frTime[1]) * 1;\n\t\t\t\t} else {\n\t\t\t\t\tx = 100000000000; // = l'an 1000 ...\n\t\t\t\t}\n\t\t\t\treturn x;\n\t\t\t},\n\t\t\t\"datetime-euro-asc\": (a, b) => {\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\t\"datetime-euro-desc\": (a, b) => {\n\t\t\t\treturn b - a;\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Store reorder source before reorder\n\t *\n\t * @param evt: original event\n\t * @param node: source node\n\t */\n\tpreReorder: function(evt, node) {\n\t\tconst table = $(evt.target);\n\t\ttable.data('ams-reorder-source', node);\n\t},\n\n\t/**\n\t * Handle table rows reordering\n\t *\n\t * @param evt: original event\n\t */\n\treorderRows: function(evt) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst\n\t\t\t\ttable = $(evt.target),\n\t\t\t\tdtTable = table.DataTable(),\n\t\t\t\tdata = table.data();\n\t\t\t// extract target and URL\n\t\t\tlet target = data.amsReorderInputTarget,\n\t\t\t\turl = data.amsReorderUrl,\n\t\t\t\tids;\n\t\t\tif (!(target || url)) {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\t// extract reordered rows IDs\n\t\t\tconst\n\t\t\t\trows = $('>tbody >tr', table),\n\t\t\t\tgetter = MyAMS.core.getFunctionByName(data.amsReorderData) || 'data-ams-row-value';\n\t\t\tif (typeof getter === 'function') {\n\t\t\t\tids = $.makeArray(rows).map(getter);\n\t\t\t} else {\n\t\t\t\tids = rows.listattr(getter);\n\t\t\t}\n\t\t\t// set target input value (if any)\n\t\t\tconst separator = data.amsReorderSeparator || ';';\n\t\t\tif (target) {\n\t\t\t\ttarget = $(target);\n\t\t\t\tif (target.exists()) {\n\t\t\t\t\ttarget.val(ids.join(separator));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tids = ids.join(separator);\n\t\t\t}\n\t\t\t// call target URL (if any)\n\t\t\tif (url) {\n\t\t\t\turl = MyAMS.core.executeFunctionByName(url, document, table) || url;\n\t\t\t\tif (!(url.startsWith(window.location.protocol) || url.startsWith('/'))) {\n\t\t\t\t\tconst location = table.data('ams-location');\n\t\t\t\t\turl = `${location || ''}/${url}`;\n\t\t\t\t}\n\t\t\t\tif (ids.length > 0) {\n\t\t\t\t\tlet postData;\n\t\t\t\t\tif (data.amsReorderPostData) {\n\t\t\t\t\t\tpostData = MyAMS.core.executeFunctionByName(data.amsReorderPostData,\n\t\t\t\t\t\t\tdocument, table, ids);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst attr = data.amsReorderPostAttr || 'order';\n\t\t\t\t\t\tpostData = {};\n\t\t\t\t\t\tpostData[attr] = ids;\n\t\t\t\t\t}\n\t\t\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\t\t\tMyAMS.ajax.post(url, postData).then((result, status, xhr) => {\n\t\t\t\t\t\t\t$('td.sorter', table).each((idx, elt) => {\n\t\t\t\t\t\t\t\t$(elt).removeData().attr('data-order', idx);\n\t\t\t\t\t\t\t\tdtTable.row($(elt).parents('tr').get(0)).invalidate().draw();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconst callback = data.amsReorderCallback;\n\t\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(callback, document,\n\t\t\t\t\t\t\t\t\ttable, result, status, xhr).then((...results) => {\n\t\t\t\t\t\t\t\t\tresolve.apply(table, ...results);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tMyAMS.ajax\n\t\t\t\t\t\t\t\t\t.handleJSON(result, table.parents('.dataTables_wrapper'))\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n\nexport function datatables(element) {\n\tconst\n\t\tbaseJS = `${MyAMS.env.baseURL}../ext/datatables/`,\n\t\tbaseCSS = `${MyAMS.env.baseURL}../../css/ext/datatables/`;\n\treturn new Promise((resolve, reject) => {\n\t\tconst tables = $('.datatable', element);\n\t\tif (tables.length > 0) {\n\t\t\tMyAMS.ajax.check($.fn.dataTable,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/datatables/jquery.dataTables${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\tconst required = [];\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\trequired.push(MyAMS.core.getScript(`${baseJS}dataTables.bootstrap4${MyAMS.env.extext}.js`));\n\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${baseCSS}dataTables.bootstrap4${MyAMS.env.extext}.css`, 'datatables-bs4'));\n\t\t\t\t}\n\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tcss = {},\n\t\t\t\t\t\tbases = [],\n\t\t\t\t\t\textensions = [],\n\t\t\t\t\t\tdepends = [],\n\t\t\t\t\t\tloaded = {};\n\t\t\t\t\ttables.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\ttable = $(elt),\n\t\t\t\t\t\t\tdata = table.data();\n\t\t\t\t\t\tif (data.buttons === 'default') {\n\t\t\t\t\t\t\ttable.attr('data-buttons', '[\"copy\", \"print\"]');\n\t\t\t\t\t\t\ttable.removeData('buttons');\n\t\t\t\t\t\t\tdata.buttons = table.data('buttons');\n\t\t\t\t\t\t} else if (data.buttons === 'all') {\n\t\t\t\t\t\t\ttable.attr('data-buttons', '[\"copy\", \"csv\", \"excel\", \"print\", \"pdf\", \"colvis\"]');\n\t\t\t\t\t\t\ttable.removeData('buttons');\n\t\t\t\t\t\t\tdata.buttons = table.data('buttons');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.autoFill && !loaded.autoFill && !$.fn.dataTable.AutoFill) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.autoFill${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}autoFill.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-autofill-bs4'] = `${baseCSS}autoFill.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.autoFill = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.buttons) {\n\t\t\t\t\t\t\tif (!loaded.buttons && !$.fn.dataTable.Buttons) {\n\t\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.buttons${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}buttons.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}buttons.html5${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\tcss['dt-buttons-bs4'] = `${baseCSS}buttons.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\t\tloaded.buttons = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ($.isArray(data.buttons)) {\n\t\t\t\t\t\t\t\tconst buttonDefs = [];\n\t\t\t\t\t\t\t\tfor (const button of data.buttons) {\n\t\t\t\t\t\t\t\t\tswitch (button) {\n\t\t\t\t\t\t\t\t\t\tcase 'copy':\n\t\t\t\t\t\t\t\t\t\t\tbuttonDefs.push({\n\t\t\t\t\t\t\t\t\t\t\t\textend: 'copyHtml5',\n\t\t\t\t\t\t\t\t\t\t\t\texportOptions: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns: \":not(.no-export):visible\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'csv':\n\t\t\t\t\t\t\t\t\t\t\tbuttonDefs.push({\n\t\t\t\t\t\t\t\t\t\t\t\textend: 'csvHtml5',\n\t\t\t\t\t\t\t\t\t\t\t\texportOptions: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns: \":not(.no-export):visible\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'excel':\n\t\t\t\t\t\t\t\t\t\t\tif (!loaded.buttons_excel && !$.fn.dataTable.ext.buttons.excelHtml5) {\n\t\t\t\t\t\t\t\t\t\t\t\tbases.push(`${baseJS}jszip${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\t\t\tloaded.buttons_excel = true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tbuttonDefs.push({\n\t\t\t\t\t\t\t\t\t\t\t\textend: 'excelHtml5',\n\t\t\t\t\t\t\t\t\t\t\t\texportOptions: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns: \":not(.no-export):visible\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'pdf':\n\t\t\t\t\t\t\t\t\t\t\tif (!loaded.buttons_pdf && !window.pdfMake) {\n\t\t\t\t\t\t\t\t\t\t\t\tbases.push(`${baseJS}pdfmake${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\t\t\textensions.push(`${baseJS}vfs_fonts${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\t\t\tloaded.buttons_pdf = true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tbuttonDefs.push({\n\t\t\t\t\t\t\t\t\t\t\t\textend: 'pdfHtml5',\n\t\t\t\t\t\t\t\t\t\t\t\texportOptions: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns: \":not(.no-export):visible\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'print':\n\t\t\t\t\t\t\t\t\t\t\tif (!loaded.buttons_print && !$.fn.dataTable.ext.buttons.print) {\n\t\t\t\t\t\t\t\t\t\t\t\tdepends.push(`${baseJS}buttons.print${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\t\t\tloaded.buttons_print = true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tbuttonDefs.push({\n\t\t\t\t\t\t\t\t\t\t\t\textend: 'print',\n\t\t\t\t\t\t\t\t\t\t\t\texportOptions: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolumns: \":not(.no-export):visible\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'colvis':\n\t\t\t\t\t\t\t\t\t\t\tif (!loaded.buttons_colvis && !$.fn.dataTable.ext.buttons.colvis) {\n\t\t\t\t\t\t\t\t\t\t\t\tdepends.push(`${baseJS}buttons.colVis${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\t\t\t\t\tloaded.buttons_colvis = true;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tbuttonDefs.push({\n\t\t\t\t\t\t\t\t\t\t\t\textend: 'colvis'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdata.buttons = buttonDefs;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.colReorder && !loaded.colReorder && !$.fn.dataTable.ColReorder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.colReorder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}colReorder.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-colreorder-bs4'] = `${baseCSS}colReorder.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.colReorder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.fixedColumns && !loaded.fixedColumns && !$.fn.dataTable.FixedColumns) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.fixedColumns${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}fixedColumns.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-fixedcolumns-bs4'] = `${baseCSS}fixedColumns.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.fixedColumns = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.fixedHeader && !loaded.fixedHeader && !$.fn.dataTable.FixedHeader) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.fixedHeader${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}fixedHeader.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-fixedheader-bs4'] = `${baseCSS}fixedHeader.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.fixedHeader = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.keyTable && !loaded.keyTable && !$.fn.dataTable.KeyTable) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.keyTable${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}keyTable.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-keytable-bs4'] = `${baseCSS}keyTable.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.keyTable = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((data.responsive !== false) && !loaded.responsive && !$.fn.dataTable.Responsive) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.responsive${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}responsive.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-responsive-bs4'] = `${baseCSS}responsive.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.responsive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.rowGroup && !loaded.rowGroup && !$.fn.dataTable.RowGroup) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.rowGroup${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}rowGroup.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-rowgroup-bs4'] = `${baseCSS}rowGroup.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.rowGroup = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.rowReorder && !loaded.rowReorder && !$.fn.dataTable.RowReorder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.rowReorder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}rowReorder.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-rowreorder-bs4'] = `${baseCSS}rowReorder.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.rowReorder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.scroller && !loaded.scroller && !$.fn.dataTable.Scroller) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.scroller${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}scroller.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-scroller-bs4'] = `${baseCSS}scroller.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.scroller = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.searchBuilder && !loaded.searchBuilder && !$.fn.dataTable.SearchBuilder) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.searchBuilder${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}searchBuilder.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-searchbuilder-bs4'] = `${baseCSS}searchBuilder.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.searchBuilder = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.searchPanes && !loaded.searchPanes && !$.fn.dataTable.SearchPanes) {\n\t\t\t\t\t\t\tif (!loaded.select && !$.fn.dataTable.select) {\n\t\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.select${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\textensions.push(`${baseJS}select.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\t\tcss['dt-select-bs4'] = `${baseCSS}select.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\t\tloaded.select = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\textensions.push(`${baseJS}dataTables.searchPanes${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tdepends.push(`${baseJS}searchPanes.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-searchpanes-bs4'] = `${baseCSS}searchPanes.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.searchPanes = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.select && !loaded.select && !$.fn.dataTable.select) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.select${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}select.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-select-bs4'] = `${baseCSS}select.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.select = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (data.stateRestore && !loaded.stateRestore && !$.fn.dataTables.stateRestore) {\n\t\t\t\t\t\t\tbases.push(`${baseJS}dataTables.stateRestore${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\textensions.push(`${baseJS}stateRestore.bootstrap4${MyAMS.env.extext}.js`);\n\t\t\t\t\t\t\tcss['dt-staterestore-bs4'] = `${baseCSS}stateRestore.bootstrap4${MyAMS.env.extext}.css`;\n\t\t\t\t\t\t\tloaded.stateRestore = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$.when.apply($, bases.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\treturn $.when.apply($, extensions.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\t\treturn $.when.apply($, depends.map(MyAMS.core.getScript)).then(() => {\n\t\t\t\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\t\t\t\t_datatablesHelpers.init();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (const [name, url] of Object.entries(css)) {\n\t\t\t\t\t\t\t\t\tMyAMS.core.getCSS(url, name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttables.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\tconst table = $(elt);\n\t\t\t\t\t\t\t\t\tif ($.fn.dataTable.isDataTable(table)) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst data = table.data();\n\n\t\t\t\t\t\t\t\t\t// initialize dom property\n\t\t\t\t\t\t\t\t\tlet dom = data.amsDatatableDom || data.amsDom || data.dom || '';\n\t\t\t\t\t\t\t\t\tif (!dom) {\n\t\t\t\t\t\t\t\t\t\tif (data.buttons) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-4 float-right'B>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searchBuilder) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"Q\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searchPanes) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"P\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (data.searching !== false || data.lengthChange !== false) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-2'\";\n\t\t\t\t\t\t\t\t\t\t\tif (data.searching !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-6 col-md-8'f>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (data.lengthChange !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-6 col-md-4'l>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdom += \">\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdom += \"<'row'<'col-sm-12'tr>>\";\n\t\t\t\t\t\t\t\t\t\tif (data.info !== false || data.paging !== false) {\n\t\t\t\t\t\t\t\t\t\t\tdom += \"<'row px-2 py-1'\";\n\t\t\t\t\t\t\t\t\t\t\tif (data.info !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-12 col-md-5'i>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (data.paging !== false) {\n\t\t\t\t\t\t\t\t\t\t\t\tdom += \"<'col-sm-12 col-md-7'p>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdom += \">\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!data.buttons && !data.searchBuilder && !data.searchPanes &&\n\t\t\t\t\t\t\t\t\t\t(data.searching === false) || (data.lengthChange === false)) {\n\t\t\t\t\t\t\t\t\t\ttable.siblings('h3').addClass('mb-0');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// initialize default options\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\t\t\tlanguage: data.amsDatatableLanguage || data.amsLanguage ||\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.i18n.plugins.datatables,\n\t\t\t\t\t\t\t\t\t\t\tresponsive: true,\n\t\t\t\t\t\t\t\t\t\t\tdom: dom\n\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t// initialize sorting\n\t\t\t\t\t\t\t\t\tlet order = data.amsDatatableOrder || data.amsOrder;\n\t\t\t\t\t\t\t\t\tif (typeof order === 'string') {\n\t\t\t\t\t\t\t\t\t\tconst orders = order.split(';');\n\t\t\t\t\t\t\t\t\t\torder = [];\n\t\t\t\t\t\t\t\t\t\tfor (const col of orders) {\n\t\t\t\t\t\t\t\t\t\t\tconst colOrder = col.split(',');\n\t\t\t\t\t\t\t\t\t\t\tcolOrder[0] = parseInt(colOrder[0]);\n\t\t\t\t\t\t\t\t\t\t\torder.push(colOrder);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (order) {\n\t\t\t\t\t\t\t\t\t\tdefaultOptions.order = order;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// initialize columns definition based on header settings\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\theads = $('thead th', table),\n\t\t\t\t\t\t\t\t\t\tcolumns = [];\n\t\t\t\t\t\t\t\t\theads.each((idx, th) => {\n\t\t\t\t\t\t\t\t\t\tcolumns[idx] = $(th).data('ams-column') || {};\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tconst sortables = heads.listattr('data-ams-sortable');\n\t\t\t\t\t\t\t\t\tfor (const iterator of sortables.entries()) {\n\t\t\t\t\t\t\t\t\t\tconst [idx, sortable] = iterator;\n\t\t\t\t\t\t\t\t\t\tif (data.rowReorder) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].sortable = false;\n\t\t\t\t\t\t\t\t\t\t} else if (sortable !== undefined) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].sortable =\n\t\t\t\t\t\t\t\t\t\t\t\ttypeof sortable === 'string' ? JSON.parse(sortable) : sortable;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst types = heads.listattr('data-ams-type');\n\t\t\t\t\t\t\t\t\tfor (const iterator of types.entries()) {\n\t\t\t\t\t\t\t\t\t\tconst [idx, stype] = iterator;\n\t\t\t\t\t\t\t\t\t\tif (stype !==  undefined) {\n\t\t\t\t\t\t\t\t\t\t\tcolumns[idx].type = stype;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdefaultOptions.columns = columns;\n\n\t\t\t\t\t\t\t\t\t// initialize final settings and initialize plug-in\n\t\t\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsDatatableOptions || data.amsOptions);\n\t\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsDatatableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\t\t\tdocument, table, settings) || settings;\n\t\t\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\t\t\ttable.trigger('before-init.ams.datatable', [table, settings, veto]);\n\t\t\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tif ($.fn.dataTable.Buttons) {\n\t\t\t\t\t\t\t\t\t\t\t$.fn.dataTable.Buttons.defaults.dom.button.className = data.amsDatatableButtonsClassname ||\n\t\t\t\t\t\t\t\t\t\t\t\tdata.amsButtonsClassname || 'btn btn-sm btn-secondary';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tconst plugin = table.DataTable(settings);\n\t\t\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\t\t\tdocument, table, plugin, settings);\n\t\t\t\t\t\t\t\t\t\ttable.trigger('after-init.ams.datatable', [table, plugin]);\n\n\t\t\t\t\t\t\t\t\t\t// set reorder events\n\t\t\t\t\t\t\t\t\t\tif (settings.rowReorder) {\n\t\t\t\t\t\t\t\t\t\t\tplugin.on('pre-row-reorder', MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatablePreReorder || data.amsPreReorder) ||\n\t\t\t\t\t\t\t\t\t\t\t\t_datatablesHelpers.preReorder);\n\t\t\t\t\t\t\t\t\t\t\tplugin.on('row-reorder', MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata.amsDatatableReordered || data.amsReordered) ||\n\t\t\t\t\t\t\t\t\t\t\t\t_datatablesHelpers.reorderRows);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tresolve(tables);\n\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t}, reject);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap 4 Tempus/Dominus date/time picker\n */\nexport function datetime(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.datetime', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.ajax.check(window.moment,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/moment${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.datetimepicker,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/tempusdominus-bootstrap4${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/tempusdominus-bootstrap4${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'tempusdominus'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\t\tdata = input.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tlocale: data.amsDatetimeLanguage || data.amsLanguage || MyAMS.i18n.language,\n\t\t\t\t\t\t\t\t\ticons: {\n\t\t\t\t\t\t\t\t\t\ttime: 'far fa-clock',\n\t\t\t\t\t\t\t\t\t\tdate: 'far fa-calendar',\n\t\t\t\t\t\t\t\t\t\tup: 'fas fa-arrow-up',\n\t\t\t\t\t\t\t\t\t\tdown: 'fas fa-arrow-down',\n\t\t\t\t\t\t\t\t\t\tprevious: 'fas fa-chevron-left',\n\t\t\t\t\t\t\t\t\t\tnext: 'fas fa-chevron-right',\n\t\t\t\t\t\t\t\t\t\ttoday: 'far fa-calendar-check-o',\n\t\t\t\t\t\t\t\t\t\tclear: 'far fa-trash',\n\t\t\t\t\t\t\t\t\t\tclose: 'far fa-times'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tdate: input.val(),\n\t\t\t\t\t\t\t\t\tformat: data.amsDatetimeFormat || data.amsFormat\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.datetimeOptions || data.options);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDatetimeInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, input, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tinput.trigger('before-init.ams.datetime', [input, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinput.datetimepicker(settings);\n\t\t\t\t\t\t\tconst plugin = input.data('datetimepicker');\n\t\t\t\t\t\t\tif (data.amsDatetimeIsoTarget || data.amsIsoTarget) {\n\t\t\t\t\t\t\t\tinput.on('change.datetimepicker', (evt) => {\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tsource = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\tdata = source.data(),\n\t\t\t\t\t\t\t\t\t\ttarget = $(data.amsDatetimeIsoTarget || data.amsIsoTarget);\n\t\t\t\t\t\t\t\t\ttarget.val(evt.date ? evt.date.toISOString(true) : null);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinput.trigger('after-init.ams.datetime', [input, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(inputs);\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * JQuery-UI drag and drop plug-ins\n */\n\nexport function dragdrop(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst dragitems = $('.draggable, .droppable, .sortable, .resizable', element);\n\t\tif (dragitems.length > 0) {\n\t\t\tMyAMS.ajax.check($.fn.draggable,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tMyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/jquery-ui.structure${MyAMS.env.extext}.css`, 'jquery-ui').then(() => {\n\t\t\t\t\tdragitems.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\titem = $(elt),\n\t\t\t\t\t\t\tdata = item.data();\n\t\t\t\t\t\t// draggable components\n\t\t\t\t\t\tif (item.hasClass('draggable')) {\n\t\t\t\t\t\t\tconst dragOptions = {\n\t\t\t\t\t\t\t\taxis: data.amsDraggableAxis || data.amsAxis,\n\t\t\t\t\t\t\t\tcursor: data.amsDraggableCursor || 'move',\n\t\t\t\t\t\t\t\tcontainment: data.amsDraggableContainment || data.amsContainment,\n\t\t\t\t\t\t\t\tdelay: data.amsDraggableDelay || data.amsDelay,\n\t\t\t\t\t\t\t\thandle: data.amsDraggableHandle || data.amsHandle,\n\t\t\t\t\t\t\t\tconnectToSortable: data.amsDraggableConnectSortable || data.amsConnectSortable,\n\t\t\t\t\t\t\t\trevert: data.amsDraggableRevert || data.amsRevert,\n\t\t\t\t\t\t\t\trevertDuration: data.amsDraggableRevertDuration || data.amsRevertDuration,\n\t\t\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsDraggableHelper) || data.amsDraggableHelper,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsDraggableStart) || function(evt, ui) {\n\t\t\t\t\t\t\t\t\t$(evt.currentTarget).data('is-dragging', true);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsDraggableStop) || function(evt, ui) {\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t$(evt.currentTarget).data('is-dragging', false);\n\t\t\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dragOptions,\n\t\t\t\t\t\t\t\tdata.amsDraggableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDraggableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.draggable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.draggable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDraggableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.draggable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// droppable components\n\t\t\t\t\t\tif (item.hasClass('droppable')) {\n\t\t\t\t\t\t\tconst dropOptions = {\n\t\t\t\t\t\t\t\taccept: data.amsDroppableAccept || data.amsAccept,\n\t\t\t\t\t\t\t\tclasses: data.amsDroppableClasses,\n\t\t\t\t\t\t\t\tdrop: MyAMS.core.getFunctionByName(data.amsDroppableDrop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dropOptions,\n\t\t\t\t\t\t\t\tdata.amsDroppableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDroppableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.droppable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.droppable(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDroppableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.droppable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// sortable components\n\t\t\t\t\t\tif (item.hasClass('sortable')) {\n\t\t\t\t\t\t\tconst sortOptions = {\n\t\t\t\t\t\t\t\titems: data.amsSortableItems,\n\t\t\t\t\t\t\t\thandle: data.amsSortableHandle,\n\t\t\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsSortableHelper) || data.amsSortableHelper,\n\t\t\t\t\t\t\t\tconnectWith: data.amsSortableConnectwith,\n\t\t\t\t\t\t\t\tcontainment: data.amsSortableContainment,\n\t\t\t\t\t\t\t\tplaceholder: data.amsSortablePlaceholder,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsSortableStart),\n\t\t\t\t\t\t\t\tover: MyAMS.core.getFunctionByName(data.amsSortableOver),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsSortableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, sortOptions,\n\t\t\t\t\t\t\t\tdata.amsSortableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSortableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.sortable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.sortable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSortableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.sortable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// resizable components\n\t\t\t\t\t\tif (item.hasClass('resizable')) {\n\t\t\t\t\t\t\tconst resizeOptions = {\n\t\t\t\t\t\t\t\tautoHide: data.amsResizableAutohide === false ? true : data.amsResizableAutohide,\n\t\t\t\t\t\t\t\tcontainment: data.amsResizableContainment,\n\t\t\t\t\t\t\t\tgrid: data.amsResizableGrid,\n\t\t\t\t\t\t\t\thandles: data.amsResizableHandles,\n\t\t\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsResizableStart),\n\t\t\t\t\t\t\t\tresize: MyAMS.core.getFunctionByName(data.amsResizableResize),\n\t\t\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsResizableStop)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, resizeOptions,\n\t\t\t\t\t\t\t\tdata.amsResizableOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsResizableInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, item, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\titem.trigger('before-init.ams.resizable', [item, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = item.resizable(settings);\n\t\t\t\t\t\t\titem.disableSelection();\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsResizableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, item, plugin, settings);\n\t\t\t\t\t\t\titem.trigger('after-init.ams.resizable', [item, plugin]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tresolve(dragitems);\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Dropzone drag&drop file input\n */\n\nexport function dropzone(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.dropzone', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.dropzone,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/dropzone.min.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/dropzone${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'dropzone'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\t\tdata = input.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tparamName: data.amsDropzoneParamName || data.amsParamName || 'form.widgets.data',\n\t\t\t\t\t\t\t\t\turl: data.amsDropzoneUrl || data.amsUrl || 'upload-file.json',\n\t\t\t\t\t\t\t\t\tuploadMultiple: data.amsDropzoneUploadMultiple !== false && data.amsUploadMultiple !== false,\n\t\t\t\t\t\t\t\t\tparallelUploads: data.amsDropzoneParallelUploads || data.amsParallelUploads || 10,\n\t\t\t\t\t\t\t\t\tmaxFilesize: data.amsDropzoneMaxFilesize || data.amsMaxFilesize,\n\t\t\t\t\t\t\t\t\tthumbnailWidth: data.amsDropzoneThumbnailWidth || data.amsThumbnailWidth || 128,\n\t\t\t\t\t\t\t\t\tthumbnailHeight: data.amsDropzoneThumbnailHeight || data.amsThumbnailHeight || 128,\n\t\t\t\t\t\t\t\t\tthumbnailMethod: data.amsDropzoneThumbnailMethod || data.amsThumbnailMethod || 'contain',\n\t\t\t\t\t\t\t\t\tclickable: data.amsDropzoneClickable != false && data.amsCLickable !== false,\n\t\t\t\t\t\t\t\t\tacceptedFiles: data.amsDropzoneAcceptedFiles || data.amsAcceptedFiles,\n\t\t\t\t\t\t\t\t\tsuccess: MyAMS.core.getFunctionByName(data.amsDropzoneSuccess || data.amsSuccess) || function (file, result, evt) {\n\t\t\t\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsDropzoneOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsDropzoneInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, input, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tinput.trigger('before-init.ams.dropzone', [input, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = input.dropzone(settings);\n\t\t\t\t\t\t\tinput.trigger('after-init.ams.dropzone', [input, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(inputs);\n\t\t\t\t\t});\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * ACE text editor\n */\n\nexport function editor(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst editors = $('.editor textarea', element);\n\t\tif (editors.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check(window.ace,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/ace/ace${MyAMS.env.extext}.js`).then((firstLoad) => {\n\n\t\t\t\t\tconst\n\t\t\t\t\t\tace = window.ace,\n\t\t\t\t\t\tdeferred = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\tace.config.set('basePath', `${MyAMS.env.baseURL}../ext/ace`);\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/ace/ext-modelist${MyAMS.env.extext}.js`));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, deferred).then(() => {\n\t\t\t\t\t\teditors.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\ttextarea = $(elt),\n\t\t\t\t\t\t\t\twidget = textarea.parents('.editor'),\n\t\t\t\t\t\t\t\tdata = textarea.data(),\n\t\t\t\t\t\t\t\tmodeList = ace.require('ace/ext/modelist'),\n\t\t\t\t\t\t\t\tmode = data.amsEditorMode || data.amsMode ||\n\t\t\t\t\t\t\t\t\tmodeList.getModeForPath(data.amsEditorFilename || data.amsFilename || 'text.txt').mode;\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t// create editor DIV\n\t\t\t\t\t\t\t\tconst textEditor = $('<div>', {\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\twidth: textarea.width(),\n\t\t\t\t\t\t\t\t\theight: textarea.height(),\n\t\t\t\t\t\t\t\t\t'class': textarea.attr('class')\n\t\t\t\t\t\t\t\t}).insertBefore(textarea);\n\t\t\t\t\t\t\t\ttextarea.css('display', 'none');\n\t\t\t\t\t\t\t\t// initialize editor\n\t\t\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\t\t\tmode: mode,\n\t\t\t\t\t\t\t\t\tfontSize: '12px',\n\t\t\t\t\t\t\t\t\ttabSize: 4,\n\t\t\t\t\t\t\t\t\tuseSoftTabs: false,\n\t\t\t\t\t\t\t\t\tshowGutter: true,\n\t\t\t\t\t\t\t\t\tshowLineNumbers: true,\n\t\t\t\t\t\t\t\t\tprintMargin: 132,\n\t\t\t\t\t\t\t\t\tshowInvisibles: true\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsEditorOptions || data.amsOptions);\n\t\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsEditorInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\t\tdocument, textarea, settings) || settings;\n\t\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\t\ttextarea.trigger('before-init.ams.editor', [textarea, settings, veto]);\n\t\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst editor = ace.edit(textEditor[0]);\n\t\t\t\t\t\t\t\teditor.setOptions(settings);\n\t\t\t\t\t\t\t\tif (MyAMS.theme === 'darkmode') {\n\t\t\t\t\t\t\t\t\teditor.setTheme('ace/theme/dracula');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\teditor.setTheme('ace/theme/textmate');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\teditor.session.setValue(textarea.val());\n\t\t\t\t\t\t\t\tif (textarea.attr('disabled')) {\n\t\t\t\t\t\t\t\t\teditor.setReadOnly(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\teditor.session.on('change', () => {\n\t\t\t\t\t\t\t\t\ttextarea.val(editor.session.getValue());\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twidget.data('editor', editor);\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsEditorAfterEditCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\tdocument, textarea, editor, settings);\n\t\t\t\t\t\t\t\ttextarea.trigger('after-init.ams.editor', [textarea, editor]);\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(editors);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap custom file input manager\n */\n\nexport function fileInput(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('.custom-file-input', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check(window.bsCustomFileInput,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bs-custom-file-input${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\tsetTimeout(() => {  // use timeout to handle file inputs in modals!\n\t\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\t\tinputId = input.attr('id'),\n\t\t\t\t\t\t\t\tinputSelector = inputId ? `#${inputId}` : input.attr('name'),\n\t\t\t\t\t\t\t\tform = $(elt.form),\n\t\t\t\t\t\t\t\tformId = form.attr('id'),\n\t\t\t\t\t\t\t\tformSelector = formId ? `#${formId}` : form.attr('name'),\n\t\t\t\t\t\t\t\tveto = {veto: false};\n\t\t\t\t\t\t\tinput.trigger('before-init.ams.fileinput', [input, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbsCustomFileInput.init(inputSelector, formSelector);\n\t\t\t\t\t\t\tinput.trigger('after-init.ams.fileinput', [input]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(inputs);\n\t\t\t\t\t}, 250);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Image area select plug-in integration\n */\n\nexport function imgAreaSelect(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst images = $('.imgareaselect', element);\n\t\tif (images.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.imgAreaSelect,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-imgareaselect${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../../css/ext/imgareaselect-animated${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'imgareaselect'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\timages.each((idx, elt) => {\n\t\t\t\t\t\t\tconst image = $(elt);\n\t\t\t\t\t\t\tif (image.data('imgAreaSelect')) {\n\t\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tdata = image.data(),\n\t\t\t\t\t\t\t\tparentSelector = data.amsImgareaselectParent || data.amsParent,\n\t\t\t\t\t\t\t\tparent = parentSelector ? image.parents(parentSelector) : 'body',\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tinstance: true,\n\t\t\t\t\t\t\t\t\thandles: true,\n\t\t\t\t\t\t\t\t\tparent: parent,\n\t\t\t\t\t\t\t\t\tx1: data.amsImgareaselectX1 || data.amsX1 || 0,\n\t\t\t\t\t\t\t\t\ty1: data.amsImgareaselectY1 || data.amsY1 || 0,\n\t\t\t\t\t\t\t\t\tx2: data.amsImgareaselectX2 || data.amsX2 ||\n\t\t\t\t\t\t\t\t\t\tdata.amsImgareaselectImageWidth || data.amsImageWidth,\n\t\t\t\t\t\t\t\t\ty2: data.amsImgareaselectY2 || data.amsY2 ||\n\t\t\t\t\t\t\t\t\t\tdata.amsImgareaselectImageHeight || data.amsImageHeight,\n\t\t\t\t\t\t\t\t\timageWidth: data.amsImgareaselectImageWidth || data.amsImageWidth,\n\t\t\t\t\t\t\t\t\timageHeight: data.amsImgareaselectImageHeight || data.amsImageHeight,\n\t\t\t\t\t\t\t\t\timgWidth: data.amsImgareaselectThumbWidth || data.amsThumbWidth,\n\t\t\t\t\t\t\t\t\timgHeight: data.amsImgareaselectThumbHeight || data.amsThumbHeight,\n\t\t\t\t\t\t\t\t\tminWidth: 128,\n\t\t\t\t\t\t\t\t\tminHeight: 128,\n\t\t\t\t\t\t\t\t\taspectRatio: data.amsImgareaselectAspectRatio || data.amsAspectRatio,\n\t\t\t\t\t\t\t\t\tonSelectEnd: MyAMS.core.getFunctionByName(data.amsImgareaselectSelectEnd || data.amsSelectedEnd) || function(img, selection) {\n\t\t\t\t\t\t\t\t\t\tconst target = data.amsImgareaselectTargetField || data.amsTargetField || 'image_';\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}x1\"]`, parent).val(selection.x1);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}y1\"]`, parent).val(selection.y1);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}x2\"]`, parent).val(selection.x2);\n\t\t\t\t\t\t\t\t\t\t$(`input[name=\"${target}y2\"]`, parent).val(selection.y2);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsImgareaselectOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsImgareaselectInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, image, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\timage.trigger('before-init.ams.imgareaselect', [image, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// add timeout to update plug-in if displayed into a modal dialog\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst plugin = image.imgAreaSelect(settings);\n\t\t\t\t\t\t\t\timage.trigger('after-init.ams.imgareaselect', [image, plugin]);\n\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(images);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Inputmask plug-in integration\n */\nexport function inputMask(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst inputs = $('input[data-input-mask]', element);\n\t\tif (inputs.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.inputmask,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-inputmask${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\t\tdata = input.data();\n\t\t\t\t\t\tlet options;\n\t\t\t\t\t\tif (typeof(data.inputMask) === 'object') {\n\t\t\t\t\t\t\toptions = data.inputMask;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toptions = {\n\t\t\t\t\t\t\t\tmask: data.inputMask.toString()\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet settings = $.extend({}, options, data.amsInputMaskOptions || data.amsOptions);\n\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsInputmaskInitCallback || data.amsInit,\n\t\t\t\t\t\t\tdocument, input, settings) || settings;\n\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\tinput.trigger('before-init.ams.inputmask', [input, settings, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst plugin = input.inputmask(settings);\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsInputmaskAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\tdocument, input, plugin, settings);\n\t\t\t\t\t\tinput.trigger('after-init.ams.inputmask', [input, plugin]);\n\t\t\t\t\t});\n\t\t\t\t\tresolve(inputs);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Select2 plug-in integration\n */\n\nconst _select2Helpers = {\n\n\tselect2UpdateHiddenField: (input) => {\n\t\tconst values = [];\n\t\tinput.parent().find('ul.select2-selection__rendered').children('li[title]').each((idx, elt) => {\n\t\t\tvalues.push(input.children(`option[data-content=\"${elt.title}\"]`).attr('value'));\n\t\t});\n\t\tinput.data('select2-target').val(values.join(input.data('ams-select2-separator') || ','));\n\t},\n\n\tselect2AjaxParamsHelper: (params, data) => {\n\t\treturn Object.assign({}, params, data);\n\t}\n};\n\nexport function select2(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst selects = $('.select2', element);\n\t\tif (selects.length > 0) {\n\t\t\tMyAMS.require('ajax', 'helpers').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.select2,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/select2/select2${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/select2/i18n/${MyAMS.i18n.language}.js`));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\tselects.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tselect = $(elt),\n\t\t\t\t\t\t\t\tdata = select.data();\n\t\t\t\t\t\t\tif (data.select2) {\n\t\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\t\ttheme: data.amsSelect2Theme || data.amsTheme || 'bootstrap4',\n\t\t\t\t\t\t\t\tlanguage: data.amsSelect2Language || data.amsLanguage || MyAMS.i18n.language,\n\t\t\t\t\t\t\t\tescapeMarkup: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2EscapeMarkup || data.amsEscapeMarkup),\n\t\t\t\t\t\t\t\tmatcher: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Matcher || data.amsMatcher),\n\t\t\t\t\t\t\t\tsorter: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Sorter || data.amsSorter),\n\t\t\t\t\t\t\t\ttemplateResult: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2TemplateResult || data.amsTemplateResult),\n\t\t\t\t\t\t\t\ttemplateSelection: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2TemplateSelection || data.amsTemplateSelection),\n\t\t\t\t\t\t\t\ttokenizer: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2Tokenizer || data.amsTokenizer)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst ajaxUrl = data.amsSelect2AjaxUrl || data.amsAjaxUrl || data['ajax-Url'];\n\t\t\t\t\t\t\tif (ajaxUrl) {\n\t\t\t\t\t\t\t\t// check AJAX data helper function\n\t\t\t\t\t\t\t\tlet ajaxParamsHelper;\n\t\t\t\t\t\t\t\tconst ajaxParams = MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxParams || data.amsAjaxParams || data['ajax-Params']) ||\n\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxParams || data.amsAjaxParams || data['ajax-Params'];\n\t\t\t\t\t\t\t\tif (typeof ajaxParams === 'function') {\n\t\t\t\t\t\t\t\t\tajaxParamsHelper = ajaxParams;\n\t\t\t\t\t\t\t\t} else if (ajaxParams) {\n\t\t\t\t\t\t\t\t\tajaxParamsHelper = (params) => {\n\t\t\t\t\t\t\t\t\t\treturn _select2Helpers.select2AjaxParamsHelper(params, ajaxParams);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdefaultOptions.ajax = {\n\t\t\t\t\t\t\t\t\turl: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxUrl || data.amsAjaxUrl) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxUrl || data.amsAjaxUrl,\n\t\t\t\t\t\t\t\t\tdata: ajaxParamsHelper || MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxData || data.amsAjaxData) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxData || data.amsAjaxData,\n\t\t\t\t\t\t\t\t\tprocessResults: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxProcessResults || data.amsAjaxProcessResults) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxProcessResults || data.amsAjaxProcessResults,\n\t\t\t\t\t\t\t\t\ttransport: MyAMS.core.getFunctionByName(\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxTransport || data.amsAjaxTransport) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsSelect2AjaxTransport || data.amsAjaxTransport\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tdefaultOptions.minimumInputLength = data.amsSelect2MinimumInputLength ||\n\t\t\t\t\t\t\t\t\tdata.amsMinimumInputLength || data.minimumInputLength;\n\t\t\t\t\t\t\t\tif (defaultOptions.minimumInputLength === undefined) {\n\t\t\t\t\t\t\t\t\tdefaultOptions.minimumInputLength = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t\t// create hidden input for sortable selections\n\t\t\t\t\t\t\t\tconst hidden = $(`<input type=\"hidden\" name=\"${select.attr('name')}\">`).insertAfter(select);\n\t\t\t\t\t\t\t\thidden.val($('option:selected', select).listattr('value').join(data.amsSelect2Separator || ','));\n\t\t\t\t\t\t\t\tselect.data('select2-target', hidden)\n\t\t\t\t\t\t\t\t\t.removeAttr('name');\n\t\t\t\t\t\t\t\tdefaultOptions.templateSelection = (data) => {\n\t\t\t\t\t\t\t\t\tconst elt = $(data.element);\n\t\t\t\t\t\t\t\t\telt.attr('data-content', elt.html());\n\t\t\t\t\t\t\t\t\treturn data.text;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsSelect2Options || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSelect2InitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, select, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\tselect.trigger('before-init.ams.select2', [select, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = select.select2(settings);\n\t\t\t\t\t\t\tselect.on('select2:opening select2:selecting select2:unselecting select2:clearing', (evt) => {\n\t\t\t\t\t\t\t\t// handle disabled selects\n\t\t\t\t\t\t\t\tif ($(evt.target).is(':disabled')) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tselect.on('select2:opening', (evt) => {\n\t\t\t\t\t\t\t\t// handle z-index in modals\n\t\t\t\t\t\t\t\tconst modal = $(evt.currentTarget).parents('.modal').first();\n\t\t\t\t\t\t\t\tif (modal.exists()) {\n\t\t\t\t\t\t\t\t\tconst zIndex = parseInt(modal.css('z-index'));\n\t\t\t\t\t\t\t\t\tplugin.data('select2').$dropdown.css('z-index', zIndex + 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tselect.on('select2:open', () => {\n\t\t\t\t\t\t\t\t// handle dropdown automatic focus\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tconst dropdown = $('.select2-search__field', plugin.data('select2').$dropdown);\n\t\t\t\t\t\t\t\t\tif (dropdown.exists()) {\n\t\t\t\t\t\t\t\t\t\tdropdown.get(0).focus();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}, 50);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t\tMyAMS.ajax.check($.fn.sortable,\n\t\t\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t\t\t\tselect.parent().find('ul.select2-selection__rendered').sortable({\n\t\t\t\t\t\t\t\t\t\tcontainment: 'parent',\n\t\t\t\t\t\t\t\t\t\tupdate: () => {\n\t\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(select);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tselect.on('select2:select select2:unselect', (evt) => {\n\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\tid = evt.params.data.id,\n\t\t\t\t\t\t\t\t\t\t\ttarget = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\t\toption = target.children(`option[value=\"${id}\"]`);\n\t\t\t\t\t\t\t\t\t\tMyAMS.helpers.moveElementToParentEnd(option);\n\t\t\t\t\t\t\t\t\t\ttarget.trigger('change');\n\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(target);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsSelect2AfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, select, plugin, settings);\n\t\t\t\t\t\t\tselect.trigger('after-init.ams.select2', [select, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(selects);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * SVG image plug-in\n */\n\nexport function svgPlugin(element) {\n\treturn new Promise((resolve) => {\n\t\tconst svgs = $('.svg-container', element);\n\t\tif (svgs.length > 0) {\n\t\t\tsvgs.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tcontainer = $(elt),\n\t\t\t\t\tsvg = $('svg', container),\n\t\t\t\t\twidth = svg.attr('width'),\n\t\t\t\t\theight = svg.attr('height');\n\t\t\t\tif (width && height) {\n\t\t\t\t\telt.setAttribute('viewBox',\n\t\t\t\t\t\t`0 0 ${Math.round(parseFloat(width))} ${Math.round(parseFloat(height))}`);\n\t\t\t\t}\n\t\t\t\tsvg.attr('width', '100%').attr('height', 'auto');\n\t\t\t});\n\t\t\tresolve(svgs);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Fieldset switcher plug-in\n *\n * A switcher is a simple fieldset with a \"switch\" icon in it's legend, which can\n * be used to hide or show fieldset content.\n */\n\nexport function switcher(element) {\n\treturn new Promise((resolve) => {\n\t\tconst switchers = $('legend.switcher', element);\n\t\tif (switchers.length > 0) {\n\t\t\tswitchers.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tlegend = $(elt),\n\t\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\t\tdata = legend.data(),\n\t\t\t\t\tstate = data.amsSwitcherState || data.amsState,\n\t\t\t\t\tminusClass = data.amsSwitcherMinusClass || data.amsMinusClass || 'chevron-down',\n\t\t\t\t\tplusClass = data.amsSwitcherPlusClass || data.amsPlusClass || 'chevron-right';\n\t\t\t\tif (!data.amsSwitcher) {\n\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\tlegend.trigger('before-init.ams.switcher', [legend, data, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t$(`<i class=\"fa fa-fw fa-${state === 'open' ? minusClass : plusClass} mr-2\"></i>`)\n\t\t\t\t\t\t.prependTo(legend);\n\t\t\t\t\tlegend.on('click', (evt) => {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\tconst veto = {};\n\t\t\t\t\t\tlegend.trigger('before-switch.ams.switcher', [legend, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fieldset.hasClass('switched')) {\n\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), plusClass, minusClass);\n\t\t\t\t\t\t\tlegend.trigger('opened.ams.switcher', [legend]);\n\t\t\t\t\t\t\tconst id = legend.attr('id');\n\t\t\t\t\t\t\tif (id) {\n\t\t\t\t\t\t\t\t$(`legend.switcher[data-ams-switcher-sync=\"${id}\"]`, fieldset).each((idx, elt) => {\n\t\t\t\t\t\t\t\t\tconst switcher = $(elt);\n\t\t\t\t\t\t\t\t\tif (switcher.parents('fieldset').hasClass('switched')) {\n\t\t\t\t\t\t\t\t\t\tswitcher.click();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), minusClass, plusClass);\n\t\t\t\t\t\t\tlegend.trigger('closed.ams.switcher', [legend]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (state !== 'open') {\n\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t}\n\t\t\t\t\tlegend.trigger('after-init.ams.switcher', [legend]);\n\t\t\t\t\tlegend.data('ams-switcher', true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tresolve(switchers);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * TinyMCE HTML editor plug-in\n */\n\nexport function tinymce(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst editors = $('.tinymce', element);\n\t\tif (editors.length > 0) {\n\t\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\t\tconst baseURL = `${MyAMS.env.baseURL}../ext/tinymce${MyAMS.env.devmode ? '/dev': ''}`;\n\t\t\t\tMyAMS.ajax.check(window.tinymce,\n\t\t\t\t\t`${baseURL}/tinymce${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst deferred = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\ttinymce.baseURL = baseURL;\n\t\t\t\t\t\ttinymce.suffix = MyAMS.env.extext;\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(`${baseURL}/jquery.tinymce.min.js`));\n\t\t\t\t\t\tdeferred.push(MyAMS.core.getScript(`${baseURL}/themes/silver/theme${MyAMS.env.extext}.js`));\n\t\t\t\t\t\t// Prevent Bootstrap dialog from blocking focusin\n\t\t\t\t\t\t$(document).on('focusin', (evt) => {\n\t\t\t\t\t\t\tif ($(evt.target).closest(\".tox-tinymce, .tox-tinymce-aux, \" +\n\t\t\t\t\t\t\t\t\".moxman-window, .tam-assetmanager-root\").length) {\n\t\t\t\t\t\t\t\tevt.stopImmediatePropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// Remove editor before cleaning content\n\t\t\t\t\t\t$(document).on('clear.ams.content', (evt, veto, element) => {\n\t\t\t\t\t\t\t$('.tinymce', element).each((idx, elt) => {\n\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\teditorId = $(elt).attr('id'),\n\t\t\t\t\t\t\t\t\teditor = window.tinymce.get(editorId);\n\t\t\t\t\t\t\t\tif (editor !== null) {\n\t\t\t\t\t\t\t\t\teditor.remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, deferred).then(() => {\n\t\t\t\t\t\teditors.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\teditor = $(elt),\n\t\t\t\t\t\t\t\tdata = editor.data(),\n\t\t\t\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\t\t\t\tselector: `textarea#${editor.attr('id')}`,\n\t\t\t\t\t\t\t\t\tbase_url: baseURL,\n\t\t\t\t\t\t\t\t\ttheme: data.amsTinymceTheme || data.amsTheme || 'silver',\n\t\t\t\t\t\t\t\t\tlanguage: MyAMS.i18n.language,\n\t\t\t\t\t\t\t\t\tmenubar: (data.amsTinymceMenubar !== false) && (data.amsMenubar !== false),\n\t\t\t\t\t\t\t\t\tstatusbar: (data.amsTinymceStatusbar !== false) && (data.amsStatusbar !== false),\n\t\t\t\t\t\t\t\t\tplugins: data.amsTinymcePlugins || data.amsPlugins || [\n\t\t\t\t\t\t\t\t\t\t\"advlist autosave autolink lists link charmap print preview hr anchor pagebreak\",\n\t\t\t\t\t\t\t\t\t\t\"searchreplace wordcount visualblocks visualchars code fullscreen\",\n\t\t\t\t\t\t\t\t\t\t\"insertdatetime nonbreaking save table contextmenu directionality\",\n\t\t\t\t\t\t\t\t\t\t\"emoticons paste textcolor colorpicker textpattern autoresize\"\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\ttoolbar: data.amsTinymceToolbar || data.amsToolbar,\n\t\t\t\t\t\t\t\t\ttoolbar1: ((data.amsTinymceToolbar1 === false) || (data.amsToolbar1 === false)) ? false :\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceToolbar1 || data.amsToolbar1 ||\n\t\t\t\t\t\t\t\t\t\t\"undo redo | pastetext | styleselect | bold italic | \" +\n\t\t\t\t\t\t\t\t\t\t\"alignleft aligncenter alignright alignjustify | \" +\n\t\t\t\t\t\t\t\t\t\t\"bullist numlist outdent indent\",\n\t\t\t\t\t\t\t\t\ttoolbar2: ((data.amsTinymceToolbar2 === false) || (data.amsToolbar2 === false)) ? false :\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceToolbar2 || data.amsToolbar2 ||\n\t\t\t\t\t\t\t\t\t\t\"forecolor backcolor emoticons | charmap link image media | \" +\n\t\t\t\t\t\t\t\t\t\t\"fullscreen preview print | code\",\n\t\t\t\t\t\t\t\t\tcontent_css: data.amsTinymceContentCss || data.amsContentCss,\n\t\t\t\t\t\t\t\t\tformats: data.amsTinymceFormats || data.amsFormats,\n\t\t\t\t\t\t\t\t\tstyle_formats: data.amsTinymceStyleFormats || data.amsStyleFormats,\n\t\t\t\t\t\t\t\t\tblock_formats: data.amsTinymceBlockFormats || data.amsBlockFormats,\n\t\t\t\t\t\t\t\t\tvalid_classes: data.amsTinymceValidClasses || data.amsValidClasses,\n\t\t\t\t\t\t\t\t\trelative_urls: false,\n\t\t\t\t\t\t\t\t\tremove_script_host: false,\n\t\t\t\t\t\t\t\t\tconvert_urls: false,\n\t\t\t\t\t\t\t\t\timage_advtab: true,\n\t\t\t\t\t\t\t\t\timage_list: MyAMS.core.getFunctionByName(data.amsTinymceImageList || data.amsImageList) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceImageList || data.amsImageList,\n\t\t\t\t\t\t\t\t\timage_class_list: data.amsTinymceImageClassList || data.amsImageClassList,\n\t\t\t\t\t\t\t\t\tlink_list: MyAMS.core.getFunctionByName(data.amsTinymceLinkList || data.amsLinkList) ||\n\t\t\t\t\t\t\t\t\t\tdata.amsTinymceLinkList || data.amsLinkList,\n\t\t\t\t\t\t\t\t\tlink_class_list: data.amsTinymceLinkClassList || data.amsLinkClassList,\n\t\t\t\t\t\t\t\t\tpaste_as_text: ((data.amsTinymcePasteAsText === undefined) && (data.amsPasteAsText === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteAsText || data.amsPasteAsText,\n\t\t\t\t\t\t\t\t\tpaste_auto_cleanup_on_paste: ((data.amsTinymcePasteAutoCleanup === undefined) && (data.amsPasteAutoCleanup === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteAutoCleanup || data.amsPasteAutoCleanup,\n\t\t\t\t\t\t\t\t\tpaste_strip_class_attributes: data.amsTinymcePasteStripClassAttributes || data.amsPasteStripClassAttributes || 'all',\n\t\t\t\t\t\t\t\t\tpaste_remove_spans: ((data.amsTinymcePasteRemoveSpans === undefined) && (data.amsPasteRemoveSpans === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteRemoveSpans || data.amsPasteRemoveSpans,\n\t\t\t\t\t\t\t\t\tpaste_remove_styles: ((data.amsTinymcePasteRemoveStyles === undefined) || (data.amsPasteRemoveStyles === undefined)) ?\n\t\t\t\t\t\t\t\t\t\ttrue : data.amsTinymcePasteRemoveStyles || data.amsPasteRemoveStyles,\n\t\t\t\t\t\t\t\t\theight: data.amsTinymceHeight || data.amsHeight || 50,\n\t\t\t\t\t\t\t\t\tmin_height: 50,\n\t\t\t\t\t\t\t\t\tresize: true,\n\t\t\t\t\t\t\t\t\tautoresize_min_height: 50,\n\t\t\t\t\t\t\t\t\tautoresize_max_height: 500\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst plugins = data.amsTinymceExternalPlugins || data.amsExternalPlugins;\n\t\t\t\t\t\t\tif (plugins) {\n\t\t\t\t\t\t\t\tconst names = plugins.split(/\\s+/);\n\t\t\t\t\t\t\t\tfor (const name of names) {\n\t\t\t\t\t\t\t\t\tconst src = editor.data(`ams-tinymce-plugin-${name}`) || editor.data(`ams-plugin-${name}`);\n\t\t\t\t\t\t\t\t\twindow.tinymce.PluginManager.load(name, MyAMS.core.getSource(src));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsTinymceOptions || data.amsOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\tdata.amsTinymceInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, editor, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\teditor.trigger('before-init.ams.tinymce', [editor, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst plugin = editor.tinymce(settings);\n\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\t\t\tdata.amsTinymceAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\t\tdocument, editor, plugin, settings);\n\t\t\t\t\t\t\t\teditor.trigger('after-init.ams.tinymce', [editor, settings]);\n\t\t\t\t\t\t\t}, 250);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(editors);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Bootstrap treeview plug-in\n */\n\nexport function treeview(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst trees = $('.treeview', element);\n\t\tif (trees.length > 0) {\n\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.treview,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/bootstrap-treeview${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tconst required = [];\n\t\t\t\t\tif (firstLoad) {\n\t\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/bootstrap-treeview${MyAMS.env.extext}.css`,\n\t\t\t\t\t\t\t'treeview'));\n\t\t\t\t\t}\n\t\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\t\ttrees.each((idx, elt) => {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\ttreeview = $(elt),\n\t\t\t\t\t\t\t\tdata = treeview.data(),\n\t\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\t\tdata: data.amsTreeviewData,\n\t\t\t\t\t\t\t\t\tlevels: data.amsTreeviewLevels,\n\t\t\t\t\t\t\t\t\tinjectStyle: data.amsTreeviewInjectStyle,\n\t\t\t\t\t\t\t\t\texpandIcon: data.amsTreeviewExpandIcon || 'far fa-fw fa-plus-square',\n\t\t\t\t\t\t\t\t\tcollapseIcon: data.amsTreeviewCollaspeIcon || 'far fa-fw fa-minus-square',\n\t\t\t\t\t\t\t\t\temptyIcon: data.amsTreeviewEmptyIcon,\n\t\t\t\t\t\t\t\t\tnodeIcon: data.amsTreeviewNodeIcon,\n\t\t\t\t\t\t\t\t\tselectedIcon: data.amsTreeviewSelectedIcon,\n\t\t\t\t\t\t\t\t\tcheckedIcon: data.amsTreeviewCheckedIcon || 'far fa-fw fa-check-square',\n\t\t\t\t\t\t\t\t\tuncheckedIcon: data.amsTreeviewUncheckedIcon || 'far fa-fw fa-square',\n\t\t\t\t\t\t\t\t\tcolor: data.amsTreeviewColor,\n\t\t\t\t\t\t\t\t\tbackColor: data.amsTreeviewBackColor,\n\t\t\t\t\t\t\t\t\tborderColor: data.amsTreeviewBorderColor,\n\t\t\t\t\t\t\t\t\tonHoverColor: data.amsTreeviewHoverColor,\n\t\t\t\t\t\t\t\t\tselectedColor: data.amsTreeviewSelectedColor,\n\t\t\t\t\t\t\t\t\tselectedBackColor: data.amsTreeviewSelectedBackColor,\n\t\t\t\t\t\t\t\t\tunselectableColor: data.amsTreeviewUnselectableColor || 'rgba(1,1,1,0.25)',\n\t\t\t\t\t\t\t\t\tunselectableBackColor: data.amsTreeviewUnselectableBackColor || 'rgba(1,1,1,0.25)',\n\t\t\t\t\t\t\t\t\tenableLinks: data.amsTreeviewEnableLinks,\n\t\t\t\t\t\t\t\t\thighlightSelected: data.amsTreeviewHighlightSelected,\n\t\t\t\t\t\t\t\t\thighlightSearchResults: data.amsTreeviewhighlightSearchResults,\n\t\t\t\t\t\t\t\t\tshowBorder: data.amsTreeviewShowBorder,\n\t\t\t\t\t\t\t\t\tshowIcon: data.amsTreeviewShowIcon,\n\t\t\t\t\t\t\t\t\tshowCheckbox: data.amsTreeviewShowCheckbox,\n\t\t\t\t\t\t\t\t\tshowTags: data.amsTreeviewShowTags,\n\t\t\t\t\t\t\t\t\ttoggleUnselectable: data.amsTreeviewToggleUnselectable,\n\t\t\t\t\t\t\t\t\tmultiSelect: data.amsTreeviewMultiSelect,\n\t\t\t\t\t\t\t\t\tonNodeChecked: MyAMS.core.getFunctionByName(data.amsTreeviewNodeChecked),\n\t\t\t\t\t\t\t\t\tonNodeCollapsed: MyAMS.core.getFunctionByName(data.amsTreeviewNodeCollapsed),\n\t\t\t\t\t\t\t\t\tonNodeDisabled: MyAMS.core.getFunctionByName(data.amsTreeviewNodeDisabled),\n\t\t\t\t\t\t\t\t\tonNodeEnabled: MyAMS.core.getFunctionByName(data.amsTreeviewNodeEnabled),\n\t\t\t\t\t\t\t\t\tonNodeExpanded: MyAMS.core.getFunctionByName(data.amsTreeviewNodeExpanded),\n\t\t\t\t\t\t\t\t\tonNodeSelected: MyAMS.core.getFunctionByName(data.amsTreeviewNodeSelected),\n\t\t\t\t\t\t\t\t\tonNodeUnchecked: MyAMS.core.getFunctionByName(data.amsTreeviewNodeUnchecked),\n\t\t\t\t\t\t\t\t\tonNodeUnselected: MyAMS.core.getFunctionByName(data.amsTreeviewNodeUnselected),\n\t\t\t\t\t\t\t\t\tonSearchComplete: MyAMS.core.getFunctionByName(data.amsTreeviewSearchComplete),\n\t\t\t\t\t\t\t\t\tonSearchCleared: MyAMS.core.getFunctionByName(data.amsTreeviewSearchCleared)\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsTreeviewOptions);\n\t\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsTreeviewInitCallback || data.amsInit,\n\t\t\t\t\t\t\t\tdocument, treeview, settings) || settings;\n\t\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\t\ttreeview.trigger('before-init.ams.treeview', [treeview, settings, veto]);\n\t\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst plugin = treeview.treeview(settings);\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsTreeviewAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\t\tdocument, treeview, plugin, settings);\n\t\t\t\t\t\t\ttreeview.trigger('after-init.ams.treeview', [treeview, plugin]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(trees);\n\t\t\t\t\t}, reject);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t} else {\n\t\t\tresolve(null);\n\t\t}\n\t});\n}\n\n\n/**\n * Form validation plug-in\n */\n\nexport function validate(element) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst forms = $('form:not([novalidate])', element);\n\t\tif (forms.length > 0) {\n\t\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\t\tMyAMS.ajax.check($.fn.validate,\n\t\t\t\t\t`${MyAMS.env.baseURL}../ext/validate/jquery-validate${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\t\tif (firstLoad && (MyAMS.i18n.language !== 'en')) {\n\t\t\t\t\t\tMyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/validate/i18n/messages_${MyAMS.i18n.language}${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tforms.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tform = $(elt),\n\t\t\t\t\t\t\tdata = form.data(),\n\t\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\t\tignore: null,\n\t\t\t\t\t\t\t\tinvalidHandler: MyAMS.core.getFunctionByName(data.amsValidateInvalidHandler) || (\n\t\t\t\t\t\t\t\t\t(evt, validator) => {\n\t\t\t\t\t\t\t\t\t\t// automatically display hidden fields with errors!\n\t\t\t\t\t\t\t\t\t\t$('span.is-invalid', form).remove();\n\t\t\t\t\t\t\t\t\t\t$('.is-invalid', form).removeClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\tfor (const error of validator.errorList) {\n\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\telement = $(error.element),\n\t\t\t\t\t\t\t\t\t\t\t\tpanels = element.parents('.tab-pane'),\n\t\t\t\t\t\t\t\t\t\t\t\tfieldsets = element.parents('fieldset.switched');\n\t\t\t\t\t\t\t\t\t\t\tfieldsets.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t\t$('legend.switcher', elt).click();\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\tpanels.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\t\tpanel = $(elt),\n\t\t\t\t\t\t\t\t\t\t\t\t\ttabs = panel.parents('.tab-content')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.siblings('.nav-tabs');\n\t\t\t\t\t\t\t\t\t\t\t\t$(`li:nth-child(${panel.index() + 1})`, tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.addClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\t\t\t$('li.is-invalid:first a', tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.click();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\terrorElement: data.amsValidateErrorElement || 'span',\n\t\t\t\t\t\t\t\terrorClass: data.amsValidateErrorClass || 'is-invalid',\n\t\t\t\t\t\t\t\terrorPlacement: MyAMS.core.getFunctionByName(data.amsValidateErrorPlacement) ||\n\t\t\t\t\t\t\t\t\t((error, element) => {\n\t\t\t\t\t\t\t\t\t\terror.addClass('invalid-feedback');\n\t\t\t\t\t\t\t\t\t\telement.closest('.form-widget').append(error);\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tsubmitHandler: MyAMS.core.getFunctionByName(data.amsValidateSubmitHandler) ||\n\t\t\t\t\t\t\t\t\t(form.attr('data-async') !== undefined ?\n\t\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\t\tMyAMS.require('form').then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.form.submit(form);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t: () => {\n\t\t\t\t\t\t\t\t\t\t\tform.get(0).submit();\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t$('[data-ams-validate-rules]', form).each((idx, elt) => {\n\t\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\t\tdataOptions.rules = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdataOptions.rules[$(elt).attr('name')] = $(elt).data('ams-validate-rules');\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('[data-ams-validate-messages]', form).each((idx, elt) => {\n\t\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\t\tdataOptions.messages = {};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdataOptions.messages[$(elt).attr('name')] = $(elt).data('ams-validate-messages');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsValidateOptions || data.amsOptions);\n\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsValidateInitCallback ||\n\t\t\t\t\t\t\tdata.amsInit, document, form, settings) || settings;\n\t\t\t\t\t\tconst veto = {veto: false};\n\t\t\t\t\t\tform.trigger('before-init.ams.validate', [form, settings, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst plugin = form.validate(settings);\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsValidateAfterInitCallback ||\n\t\t\t\t\t\t\tdata.amsAfterInit, document, form, plugin, settings);\n\t\t\t\t\t\tform.trigger('after-init.ams.validate', [form, plugin]);\n\t\t\t\t\t});\n\t\t\t\t\tresolve(forms);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t}\n\t});\n}\n\n\n/**\n * Global module initialization\n */\n\nif (window.MyAMS) {\n\n\t// register loaded plug-ins\n\tMyAMS.registry.register(calendar, 'calendar');\n\tMyAMS.registry.register(checker, 'checker');\n\tMyAMS.registry.register(colorPicker, 'colorPicker');\n\tMyAMS.registry.register(contextMenu, 'contextMenu');\n\tMyAMS.registry.register(datatables, 'datatables');\n\tMyAMS.registry.register(datetime, 'datetime');\n\tMyAMS.registry.register(dragdrop, 'dragdrop');\n\tMyAMS.registry.register(dropzone, 'dropzone');\n\tMyAMS.registry.register(editor, 'editor');\n\tMyAMS.registry.register(fileInput, 'fileInput');\n\tMyAMS.registry.register(imgAreaSelect, 'imgAreaSelect');\n\tMyAMS.registry.register(inputMask, 'inputMask');\n\tMyAMS.registry.register(select2, 'select2');\n\tMyAMS.registry.register(svgPlugin, 'svg');\n\tMyAMS.registry.register(switcher, 'switcher');\n\tMyAMS.registry.register(tinymce, 'tinymce');\n\tMyAMS.registry.register(treeview, 'treeview');\n\tMyAMS.registry.register(validate, 'validate');\n\n\t// register module\n\tMyAMS.config.modules.push('plugins');\n\tif (!MyAMS.env.bundle) {\n\t\tconsole.debug(\"MyAMS: plugins module loaded...\");\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;AACA;AACA;;EAEA,MAAMA,CAAC,GAAGC,KAAK,CAACD,CAAC;EAEjB,IAAI,CAACA,CAAC,CAACE,SAAS,EAAE;IACjB,MAAMC,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;IACpCJ,CAAC,CAACE,SAAS,GAAGC,QAAQ,CAACD,SAAS;EACjC;;EAGA;AACA;AACA;EACO,SAASG,QAAQA,CAACC,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAMC,SAAS,GAAGV,CAAC,CAAC,WAAW,EAAEM,OAAO,CAAC;MACzC,IAAII,SAAS,CAACC,MAAM,GAAG,CAAC,EAAE;QACzBV,KAAK,CAACW,IAAI,CAACC,KAAK,CAACC,MAAM,CAACC,YAAY,EACnC,GAAGd,KAAK,CAACe,GAAG,CAACC,OAAO,6BAA6BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;UAC5FV,SAAS,CAACW,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;YAC5B,MACCjB,OAAO,GAAGN,CAAC,CAACuB,GAAG,CAAC;cAChBC,IAAI,GAAGlB,OAAO,CAACkB,IAAI,CAAC,CAAC;cACrBC,cAAc,GAAG;gBAChBC,OAAO,EAAE,EAAE;gBACXC,WAAW,EAAE,cAAc;gBAC3BC,WAAW,EAAE,WAAW;gBACxBC,MAAM,EAAE7B,CAAC,CAAC,MAAM,CAAC,CAAC8B,IAAI,CAAC,MAAM,CAAC;gBAC9BC,aAAa,EAAE;kBACdC,KAAK,EAAE,OAAO;kBACdC,MAAM,EAAE,OAAO;kBACfC,KAAK,EAAE;gBACR,CAAC;gBACDC,oBAAoB,EAAE;kBACrBC,IAAI,EAAE,iBAAiB;kBACvBC,IAAI,EAAE;gBACP,CAAC;gBACDC,QAAQ,EAAE,CAAC;gBACXC,qBAAqB,EAAE;cACxB,CAAC;YACF,IAAIC,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAACkB,eAAe,IAAIlB,IAAI,CAACmB,OAAO,CAAC;YACjFH,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACsB,uBAAuB,IAAItB,IAAI,CAACuB,OAAO,EAC5CC,QAAQ,EAAE1C,OAAO,EAAEkC,QAAQ,CAAC,IAAIA,QAAQ;YACzC,MAAMS,IAAI,GAAG;cAACA,IAAI,EAAE;YAAK,CAAC;YAC1B3C,OAAO,CAAC4C,OAAO,CAAC,0BAA0B,EAAE,CAAC5C,OAAO,EAAEkC,QAAQ,EAAES,IAAI,CAAC,CAAC;YACtE,IAAIA,IAAI,CAACA,IAAI,EAAE;cACd;YACD;YACA,MAAM5C,QAAQ,GAAG,IAAIU,YAAY,CAACoC,QAAQ,CAAC5B,GAAG,EAAEiB,QAAQ,CAAC;YACzDlC,OAAO,CAAC4C,OAAO,CAAC,yBAAyB,EAAE,CAAC5C,OAAO,EAAED,QAAQ,CAAC,CAAC;YAC/DA,QAAQ,CAAC+C,MAAM,CAAC,CAAC;UAClB,CAAC,CAAC;UACF5C,OAAO,CAACE,SAAS,CAAC;QACnB,CAAC,EAAED,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA,MAAM6C,uBAAuB,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;EAED,MAAMC,gBAAgB,GAAGtD,CAAC,CAACE,SAAS,CAAC;IACpCqD,MAAM,EAAEF;EACT,CAAC,CAAC;EAEK,SAASG,OAAOA,CAAClD,OAAO,EAAE;IAChC,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;MAC/B,MAAMiD,QAAQ,GAAGzD,CAAC,CAAC,gBAAgB,EAAEM,OAAO,CAAC;MAC7C,IAAImD,QAAQ,CAAC9C,MAAM,GAAG,CAAC,EAAE;QACxB8C,QAAQ,CAACpC,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;UAC3B,MACCmC,MAAM,GAAG1D,CAAC,CAACuB,GAAG,CAAC;YACfC,IAAI,GAAGkC,MAAM,CAAClC,IAAI,CAAC,CAAC;UACrB,IAAI,CAACA,IAAI,CAACmC,UAAU,EAAE;YACrB,MACCC,QAAQ,GAAGF,MAAM,CAACG,MAAM,CAAC,UAAU,CAAC;cACpCC,KAAK,GAAGtC,IAAI,CAACuC,eAAe,IAAIvC,IAAI,CAACwC,QAAQ;cAC7CC,OAAO,GAAGL,QAAQ,CAACM,QAAQ,CAAC,UAAU,CAAC,IAAKJ,KAAK,KAAK,IAAK;cAC3DK,SAAS,GAAG3C,IAAI,CAAC4C,mBAAmB,IAAI5C,IAAI,CAAC6C,YAAY,IAAI,WAAWpE,KAAK,CAAC2C,IAAI,CAAC0B,UAAU,CAAC,CAAC,EAAE;cACjGC,OAAO,GAAGJ,SAAS,CAACK,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;cACvCC,MAAM,GAAGjD,IAAI,CAACkD,sBAAsB,IAAIlD,IAAI,CAACmD,eAAe;cAC5DC,MAAM,GAAGpD,IAAI,CAACqD,gBAAgB,IAAIrD,IAAI,CAACsD,SAAS,IAAI,KAAK;cACzDC,WAAW,GAAGvD,IAAI,CAACwD,cAAc,IAAIxD,IAAI,CAACyD,OAAO,IAAI,MAAM;cAC3DC,YAAY,GAAG1D,IAAI,CAAC2D,iBAAiB,IAAI3D,IAAI,CAAC4D,UAAU,IAAI,MAAM;cAClEC,cAAc,GAAG7D,IAAI,CAAC8D,kBAAkB,IAAI9D,IAAI,CAAC+D,WAAW,IAAI,OAAO;cACvEC,KAAK,GAAGhE,IAAI,CAACiE,eAAe,IAAIjE,IAAI,CAACkE,QAAQ;cAC7CC,QAAQ,GAAGnE,IAAI,CAACoE,kBAAkB,IAAIpE,IAAI,CAACqE,WAAW;cACtDC,KAAK,GAAG;gBACPpC,MAAM,EAAEA,MAAM,CAACqC,IAAI,CAAC,CAAC;gBACrB5B,SAAS,EAAEA,SAAS;gBACpBI,OAAO,EAAEA,OAAO;gBAChBiB,KAAK,EAAEA,KAAK,IAAI,IAAI;gBACpBvB,OAAO,EAAEA,OAAO;gBAChB0B,QAAQ,EAAEA,QAAQ;gBAClBlB,MAAM,EAAEA,MAAM;gBACdX,KAAK,EAAEA,KAAK;gBACZoB,YAAY,EAAEA,YAAY;gBAC1BG,cAAc,EAAEA,cAAc;gBAC9BT,MAAM,EAAEA;cACT,CAAC;cACD3B,IAAI,GAAG;gBAACA,IAAI,EAAE;cAAK,CAAC;YACrBS,MAAM,CAACR,OAAO,CAAC,yBAAyB,EAAE,CAACQ,MAAM,EAAEoC,KAAK,EAAE7C,IAAI,CAAC,CAAC;YAChE,IAAIA,IAAI,CAACA,IAAI,EAAE;cACd;YACD;YACAS,MAAM,CAACsC,IAAI,CAAC1C,gBAAgB,CAACF,MAAM,CAAC0C,KAAK,CAAC,CAAC;YAC3C9F,CAAC,CAAC,OAAO,EAAE0D,MAAM,CAAC,CAACuC,MAAM,CAAEC,GAAG,IAAK;cAClC,MACCC,KAAK,GAAGnG,CAAC,CAACkG,GAAG,CAACE,MAAM,CAAC;gBACrBnC,OAAO,GAAGkC,KAAK,CAACE,EAAE,CAAC,UAAU,CAAC;gBAC9BpD,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;cACrBS,MAAM,CAACR,OAAO,CAAC,2BAA2B,EAAE,CAACQ,MAAM,EAAET,IAAI,CAAC,CAAC;cAC3D,IAAIA,IAAI,CAACA,IAAI,EAAE;gBACdkD,KAAK,CAACG,IAAI,CAAC,SAAS,EAAE,CAACrC,OAAO,CAAC;gBAC/B;cACD;cACAhE,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAAC+E,uBAAuB,IAC5D/E,IAAI,CAACgF,gBAAgB,EAAExD,QAAQ,EAAEU,MAAM,EAAEO,OAAO,CAAC;cAClD,IAAI,CAACzC,IAAI,CAACiF,uBAAuB,IAAI,CAACjF,IAAI,CAACkF,gBAAgB,EAAE;gBAC5D,MAAMjC,MAAM,GAAG0B,KAAK,CAACQ,QAAQ,CAAC,SAAS,CAAC;gBACxC,IAAI5B,WAAW,KAAK,MAAM,EAAE;kBAC3B,IAAId,OAAO,EAAE;oBACZL,QAAQ,CAACgD,WAAW,CAAC,UAAU,CAAC;oBAChCnC,MAAM,CAACoC,GAAG,CAAC3B,YAAY,CAAC;oBACxBxB,MAAM,CAACR,OAAO,CAAC,oBAAoB,EAAE,CAACQ,MAAM,CAAC,CAAC;kBAC/C,CAAC,MAAM;oBACNE,QAAQ,CAACkD,QAAQ,CAAC,UAAU,CAAC;oBAC7BrC,MAAM,CAACoC,GAAG,CAACxB,cAAc,CAAC;oBAC1B3B,MAAM,CAACR,OAAO,CAAC,oBAAoB,EAAE,CAACQ,MAAM,CAAC,CAAC;kBAC/C;gBACD,CAAC,MAAM;kBACNE,QAAQ,CAAC0C,IAAI,CAAC,UAAU,EAAE,CAACrC,OAAO,CAAC;kBACnCQ,MAAM,CAACoC,GAAG,CAAC5C,OAAO,GAAGiB,YAAY,GAAGG,cAAc,CAAC;gBACpD;cACD;YACD,CAAC,CAAC;YACF3B,MAAM,CAACqD,OAAO,CAAC,MAAM,CAAC,CAACC,EAAE,CAAC,OAAO,EAAE,MAAM;cACxC,MAAMxD,OAAO,GAAGxD,CAAC,CAAC,UAAU,EAAE0D,MAAM,CAAC;cACrC,IAAIF,OAAO,CAAC8C,IAAI,CAAC,SAAS,CAAC,KAAKrC,OAAO,EAAE;gBACxCT,OAAO,CAACyD,KAAK,CAAC,CAAC;cAChB;YACD,CAAC,CAAC;YACF,IAAI,CAAChD,OAAO,EAAE;cACb,IAAIc,WAAW,KAAK,MAAM,EAAE;gBAC3BnB,QAAQ,CAACkD,QAAQ,CAAC,UAAU,CAAC;cAC9B,CAAC,MAAM;gBACNlD,QAAQ,CAAC0C,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC;cAChC;YACD;YACA5C,MAAM,CAACR,OAAO,CAAC,wBAAwB,EAAE,CAACQ,MAAM,CAAC,CAAC;YAClDA,MAAM,CAAClC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC;UACjC;QACD,CAAC,CAAC;QACFhB,OAAO,CAACiD,QAAQ,CAAC;MAClB,CAAC,MAAM;QACNjD,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAAS0G,WAAWA,CAAC5G,OAAO,EAAE;IACpC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM0G,MAAM,GAAGnH,CAAC,CAAC,QAAQ,EAAEM,OAAO,CAAC;MACnC,IAAI6G,MAAM,CAACxG,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAACC,WAAW,EAChC,GAAGpH,KAAK,CAACe,GAAG,CAACC,OAAO,+BAA+BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YAC9F,MAAMkG,QAAQ,GAAG,EAAE;YACnB,IAAIlG,SAAS,EAAE;cACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAAC,GAAGvH,KAAK,CAACe,GAAG,CAACC,OAAO,sCAAsChB,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EAC/G,aAAa,CAAC,CAAC;YACjB;YACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;cACpCgG,MAAM,CAAC9F,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACzB,MACC4E,KAAK,GAAGnG,CAAC,CAACuB,GAAG,CAAC;kBACdC,IAAI,GAAG2E,KAAK,CAAC3E,IAAI,CAAC,CAAC;kBACnBmG,WAAW,GAAG;oBACbC,MAAM,EAAEpG,IAAI,CAACqG,oBAAoB,IAAIrG,IAAI,CAACsG,SAAS,IAAI,KAAK;oBAC5DC,aAAa,EAAE,CAACvG,IAAI,CAACwG,2BAA2B,IAAIxG,IAAI,CAACyG,gBAAgB,IAAI,KAAK,MAAM,KAAK;oBAC7FC,QAAQ,EAAE,CAAC1G,IAAI,CAAC2G,sBAAsB,IAAI3G,IAAI,CAAC4G,WAAW,IAAI,KAAK,MAAM,KAAK;oBAC9EnC,MAAM,EAAEhG,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC8G,oBAAoB,IAAI9G,IAAI,CAAC+G,SAAS,CAAC;oBACjFC,iBAAiB,EAAEvI,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACiH,0BAA0B,IAAIjH,IAAI,CAACkH,eAAe,CAAC;oBACxGC,iBAAiB,EAAE1I,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACoH,0BAA0B,IAAIpH,IAAI,CAACqH,eAAe,CAAC;oBACxGC,kBAAkB,EAAE7I,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACuH,2BAA2B,IAAIvH,IAAI,CAACwH,gBAAgB,CAAC;oBAC3GC,iBAAiB,EAAEhJ,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC0H,0BAA0B,IAAI1H,IAAI,CAAC2H,eAAe,CAAC;oBACxGC,kBAAkB,EAAEnJ,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC6H,2BAA2B,IAAI7H,IAAI,CAAC8H,gBAAgB,CAAC;oBAC3GC,eAAe,EAAEtJ,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACgI,wBAAwB,IAAIhI,IAAI,CAACiI,aAAa,CAAC;oBAClGC,kBAAkB,EAAEzJ,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACmI,2BAA2B,IAAInI,IAAI,CAACoI,gBAAgB,CAAC;oBAC3GC,eAAe,EAAE5J,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACsI,wBAAwB,IAAItI,IAAI,CAACuI,aAAa,CAAC;oBAClGC,iBAAiB,EAAE/J,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACyI,0BAA0B,IAAIzI,IAAI,CAAC0I,eAAe,CAAC;oBACxGC,SAAS,EAAElK,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC4I,uBAAuB,IAAI5I,IAAI,CAAC6I,YAAY;kBAC1F,CAAC;gBACF,IAAI7H,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEkF,WAAW,EAAEnG,IAAI,CAAC8I,qBAAqB,IAAI9I,IAAI,CAAC+I,UAAU,CAAC;gBACvF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACgJ,0BAA0B,IAAIhJ,IAAI,CAACuB,OAAO,EAC1FC,QAAQ,EAAEmD,KAAK,EAAE3D,QAAQ,CAAC,IAAIA,QAAQ;gBACvC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1BkD,KAAK,CAACjD,OAAO,CAAC,6BAA6B,EAAE,CAACiD,KAAK,EAAE3D,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACrE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGtE,KAAK,CAACkB,WAAW,CAAC7E,QAAQ,CAAC;gBAC1CvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACkJ,+BAA+B,IAAIlJ,IAAI,CAACmJ,YAAY,EACzF3H,QAAQ,EAAEmD,KAAK,EAAEsE,MAAM,EAAEjI,QAAQ,CAAC;gBACnC2D,KAAK,CAACjD,OAAO,CAAC,4BAA4B,EAAE,CAACiD,KAAK,EAAEsE,MAAM,CAAC,CAAC;cAC7D,CAAC,CAAC;cACFjK,OAAO,CAAC2G,MAAM,CAAC;YAChB,CAAC,EAAE1G,MAAM,CAAC;UACX,CAAC,EAAEA,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASoK,WAAWA,CAACtK,OAAO,EAAE;IACpC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAMoK,KAAK,GAAG7K,CAAC,CAAC,eAAe,EAAEM,OAAO,CAAC;MACzC,IAAIuK,KAAK,CAAClK,MAAM,GAAG,CAAC,EAAE;QACrBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChC0J,KAAK,CAACxJ,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;YACxB,MACCuJ,IAAI,GAAG9K,CAAC,CAACuB,GAAG,CAAC;cACbC,IAAI,GAAGsJ,IAAI,CAACtJ,IAAI,CAAC,CAAC;cAClBmB,OAAO,GAAG;gBACToI,YAAY,EAAEvJ,IAAI,CAACwJ,sBAAsB,IAAIxJ,IAAI,CAACyJ;cACnD,CAAC;YACF,IAAIzI,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEE,OAAO,EAAEnB,IAAI,CAAC0J,qBAAqB,IAAI1J,IAAI,CAAC+I,UAAU,CAAC;YACnF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAAC2J,0BAA0B,IAAI3J,IAAI,CAACuB,OAAO,EAC/CC,QAAQ,EAAE8H,IAAI,EAAEtI,QAAQ,CAAC,IAAIA,QAAQ;YACtC,MAAMS,IAAI,GAAG;cAACA,IAAI,EAAE;YAAK,CAAC;YAC1B6H,IAAI,CAAC5H,OAAO,CAAC,6BAA6B,EAAE,CAAC4H,IAAI,EAAEtI,QAAQ,EAAES,IAAI,CAAC,CAAC;YACnE,IAAIA,IAAI,CAACA,IAAI,EAAE;cACd;YACD;YACA,MAAMwH,MAAM,GAAGK,IAAI,CAACF,WAAW,CAACpI,QAAQ,CAAC;YACzCvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAAC4J,+BAA+B,IAAI5J,IAAI,CAACmJ,YAAY,EACzD3H,QAAQ,EAAE8H,IAAI,EAAEL,MAAM,EAAEjI,QAAQ,CAAC;YAClCsI,IAAI,CAAC5H,OAAO,CAAC,4BAA4B,EAAE,CAAC4H,IAAI,EAAEL,MAAM,CAAC,CAAC;UAC3D,CAAC,CAAC;UACFjK,OAAO,CAACqK,KAAK,CAAC;QACf,CAAC,EAAEpK,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEA,MAAM6K,kBAAkB,GAAG;IAE1BC,IAAI,EAAEA,CAAA,KAAM;MAEX;MACA,MAAMC,KAAK,GAAGvL,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACC,GAAG,CAACC,IAAI;MAErCH,KAAK,CAACI,MAAM,CAACC,OAAO,CAAEpK,IAAI,IAAK;QAC9B,IAAIA,IAAI,KAAK,IAAI,IAAIA,IAAI,CAACqK,KAAK,CAAC,8DAA8D,CAAC,EAAE;UAChG,OAAO,WAAW;QACnB;QACA,OAAO,IAAI;MACZ,CAAC,CAAC;MAEFN,KAAK,CAACI,MAAM,CAACC,OAAO,CAAEpK,IAAI,IAAK;QAC9B,IAAIA,IAAI,KAAK,IAAI,IAAIA,IAAI,CAACqK,KAAK,CAAC,+FAA+F,CAAC,EAAE;UACjI,OAAO,eAAe;QACvB;QACA,OAAO,IAAI;MACZ,CAAC,CAAC;;MAEF;MACA7L,CAAC,CAACyC,MAAM,CAAC8I,KAAK,CAACO,KAAK,EAAE;QAErB;QACA,mBAAmB,EAAEC,CAACC,CAAC,EAAEC,CAAC,KAAK;UAC9B,IAAIC,CAAC,GAAGF,CAAC,CAACxH,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;UAC7C,IAAI2H,CAAC,GAAGF,CAAC,CAACzH,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;UAC7C0H,CAAC,GAAGE,UAAU,CAACF,CAAC,CAAC;UACjBC,CAAC,GAAGC,UAAU,CAACD,CAAC,CAAC;UACjB,OAASD,CAAC,GAAGC,CAAC,GAAI,CAAC,CAAC,GAAKD,CAAC,GAAGC,CAAC,GAAI,CAAC,GAAG,CAAE;QACzC,CAAC;QACD,oBAAoB,EAAEE,CAACL,CAAC,EAAEC,CAAC,KAAK;UAC/B,IAAIC,CAAC,GAAGF,CAAC,CAACxH,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;UAC7C,IAAI2H,CAAC,GAAGF,CAAC,CAACzH,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;UAC7C0H,CAAC,GAAGE,UAAU,CAACF,CAAC,CAAC;UACjBC,CAAC,GAAGC,UAAU,CAACD,CAAC,CAAC;UACjB,OAASD,CAAC,GAAGC,CAAC,GAAI,CAAC,GAAKD,CAAC,GAAGC,CAAC,GAAI,CAAC,CAAC,GAAG,CAAE;QACzC,CAAC;QAED;QACA,eAAe,EAAGH,CAAC,IAAK;UACvB,MAAMM,OAAO,GAAGtM,CAAC,CAACuM,IAAI,CAACP,CAAC,CAAC;UACzB,IAAIE,CAAC;UACL,IAAII,OAAO,KAAK,EAAE,EAAE;YACnB,MAAME,MAAM,GAAGF,OAAO,CAACG,KAAK,CAAC,GAAG,CAAC;YACjCP,CAAC,GAAG,CAACM,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;UAC5C,CAAC,MAAM;YACNN,CAAC,GAAG,QAAQ,CAAC,CAAC;UACf;UACA,OAAOA,CAAC;QACT,CAAC;QACD,eAAe,EAAEQ,CAACV,CAAC,EAAEC,CAAC,KAAK;UAC1B,OAAOD,CAAC,GAAGC,CAAC;QACb,CAAC;QACD,gBAAgB,EAAEU,CAACX,CAAC,EAAEC,CAAC,KAAK;UAC3B,OAAOA,CAAC,GAAGD,CAAC;QACb,CAAC;QAED;QACA,mBAAmB,EAAGA,CAAC,IAAK;UAC3B,MAAMM,OAAO,GAAGtM,CAAC,CAACuM,IAAI,CAACP,CAAC,CAAC;UACzB,IAAIE,CAAC;UACL,IAAII,OAAO,KAAK,EAAE,EAAE;YACnB,MAAMM,UAAU,GAAGN,OAAO,CAACG,KAAK,CAAC,KAAK,CAAC;YACvC,MAAMD,MAAM,GAAGI,UAAU,CAAC,CAAC,CAAC,CAACH,KAAK,CAAC,GAAG,CAAC;YACvC,MAAMI,MAAM,GAAGD,UAAU,CAAC,CAAC,CAAC,CAACH,KAAK,CAAC,GAAG,CAAC;YACvCP,CAAC,GAAG,CAACM,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,GAAGK,MAAM,CAAC,CAAC,CAAC,GAAGA,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;UACpE,CAAC,MAAM;YACNX,CAAC,GAAG,YAAY,CAAC,CAAC;UACnB;UACA,OAAOA,CAAC;QACT,CAAC;QACD,mBAAmB,EAAEY,CAACd,CAAC,EAAEC,CAAC,KAAK;UAC9B,OAAOD,CAAC,GAAGC,CAAC;QACb,CAAC;QACD,oBAAoB,EAAEc,CAACf,CAAC,EAAEC,CAAC,KAAK;UAC/B,OAAOA,CAAC,GAAGD,CAAC;QACb;MACD,CAAC,CAAC;IACH,CAAC;IAED;AACD;AACA;AACA;AACA;AACA;IACCgB,UAAU,EAAE,SAAAA,CAAS9G,GAAG,EAAE+G,IAAI,EAAE;MAC/B,MAAMC,KAAK,GAAGlN,CAAC,CAACkG,GAAG,CAACE,MAAM,CAAC;MAC3B8G,KAAK,CAAC1L,IAAI,CAAC,oBAAoB,EAAEyL,IAAI,CAAC;IACvC,CAAC;IAED;AACD;AACA;AACA;AACA;IACCE,WAAW,EAAE,SAAAA,CAASjH,GAAG,EAAE;MAC1B,OAAO,IAAI3F,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;QACvC,MACCyM,KAAK,GAAGlN,CAAC,CAACkG,GAAG,CAACE,MAAM,CAAC;UACrBgH,OAAO,GAAGF,KAAK,CAACG,SAAS,CAAC,CAAC;UAC3B7L,IAAI,GAAG0L,KAAK,CAAC1L,IAAI,CAAC,CAAC;QACpB;QACA,IAAI4E,MAAM,GAAG5E,IAAI,CAAC8L,qBAAqB;UACtCC,GAAG,GAAG/L,IAAI,CAACgM,aAAa;UACxBC,GAAG;QACJ,IAAI,EAAErH,MAAM,IAAImH,GAAG,CAAC,EAAE;UACrB/M,OAAO,CAAC,CAAC;QACV;QACA;QACA,MACCkN,IAAI,GAAG1N,CAAC,CAAC,YAAY,EAAEkN,KAAK,CAAC;UAC7BS,MAAM,GAAG1N,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACoM,cAAc,CAAC,IAAI,oBAAoB;QACnF,IAAI,OAAOD,MAAM,KAAK,UAAU,EAAE;UACjCF,GAAG,GAAGzN,CAAC,CAAC6N,SAAS,CAACH,IAAI,CAAC,CAACI,GAAG,CAACH,MAAM,CAAC;QACpC,CAAC,MAAM;UACNF,GAAG,GAAGC,IAAI,CAACK,QAAQ,CAACJ,MAAM,CAAC;QAC5B;QACA;QACA,MAAMK,SAAS,GAAGxM,IAAI,CAACyM,mBAAmB,IAAI,GAAG;QACjD,IAAI7H,MAAM,EAAE;UACXA,MAAM,GAAGpG,CAAC,CAACoG,MAAM,CAAC;UAClB,IAAIA,MAAM,CAAC8H,MAAM,CAAC,CAAC,EAAE;YACpB9H,MAAM,CAACS,GAAG,CAAC4G,GAAG,CAACU,IAAI,CAACH,SAAS,CAAC,CAAC;UAChC;QACD,CAAC,MAAM;UACNP,GAAG,GAAGA,GAAG,CAACU,IAAI,CAACH,SAAS,CAAC;QAC1B;QACA;QACA,IAAIT,GAAG,EAAE;UACRA,GAAG,GAAGtN,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAAC0K,GAAG,EAAEvK,QAAQ,EAAEkK,KAAK,CAAC,IAAIK,GAAG;UACnE,IAAI,EAAEA,GAAG,CAACa,UAAU,CAACtN,MAAM,CAACuN,QAAQ,CAACC,QAAQ,CAAC,IAAIf,GAAG,CAACa,UAAU,CAAC,GAAG,CAAC,CAAC,EAAE;YACvE,MAAMC,QAAQ,GAAGnB,KAAK,CAAC1L,IAAI,CAAC,cAAc,CAAC;YAC3C+L,GAAG,GAAG,GAAGc,QAAQ,IAAI,EAAE,IAAId,GAAG,EAAE;UACjC;UACA,IAAIE,GAAG,CAAC9M,MAAM,GAAG,CAAC,EAAE;YACnB,IAAI4N,QAAQ;YACZ,IAAI/M,IAAI,CAACgN,kBAAkB,EAAE;cAC5BD,QAAQ,GAAGtO,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACgN,kBAAkB,EAClExL,QAAQ,EAAEkK,KAAK,EAAEO,GAAG,CAAC;YACvB,CAAC,MAAM;cACN,MAAM3L,IAAI,GAAGN,IAAI,CAACiN,kBAAkB,IAAI,OAAO;cAC/CF,QAAQ,GAAG,CAAC,CAAC;cACbA,QAAQ,CAACzM,IAAI,CAAC,GAAG2L,GAAG;YACrB;YACAxN,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;cAChClB,KAAK,CAACW,IAAI,CAAC8N,IAAI,CAACnB,GAAG,EAAEgB,QAAQ,CAAC,CAACpN,IAAI,CAAC,CAACwN,MAAM,EAAEC,MAAM,EAAEC,GAAG,KAAK;gBAC5D7O,CAAC,CAAC,WAAW,EAAEkN,KAAK,CAAC,CAAC7L,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;kBACxCvB,CAAC,CAACuB,GAAG,CAAC,CAACuN,UAAU,CAAC,CAAC,CAAChN,IAAI,CAAC,YAAY,EAAER,GAAG,CAAC;kBAC3C8L,OAAO,CAAC2B,GAAG,CAAC/O,CAAC,CAACuB,GAAG,CAAC,CAACyN,OAAO,CAAC,IAAI,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC;gBAC7D,CAAC,CAAC;gBACF,MAAMC,QAAQ,GAAG5N,IAAI,CAAC6N,kBAAkB;gBACxC,IAAID,QAAQ,EAAE;kBACbnP,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACuM,QAAQ,EAAEpM,QAAQ,EAClDkK,KAAK,EAAEyB,MAAM,EAAEC,MAAM,EAAEC,GAAG,CAAC,CAAC1N,IAAI,CAAC,YAAgB;oBAAA,SAAAmO,IAAA,GAAAC,SAAA,CAAA5O,MAAA,EAAZ6O,OAAO,OAAAC,KAAA,CAAAH,IAAA,GAAAI,IAAA,MAAAA,IAAA,GAAAJ,IAAA,EAAAI,IAAA;sBAAPF,OAAO,CAAAE,IAAA,IAAAH,SAAA,CAAAG,IAAA;oBAAA;oBAC5ClP,OAAO,CAACkH,KAAK,CAACwF,KAAK,EAAE,GAAGsC,OAAO,CAAC;kBACjC,CAAC,CAAC;gBACH,CAAC,MAAM;kBACNvP,KAAK,CAACW,IAAI,CACR+O,UAAU,CAAChB,MAAM,EAAEzB,KAAK,CAAC8B,OAAO,CAAC,qBAAqB,CAAC,CAAC,CACxD7N,IAAI,CAAC,MAAM;oBACXX,OAAO,CAACmO,MAAM,CAAC;kBAChB,CAAC,CAAC;gBACJ;cACD,CAAC,EAAElO,MAAM,CAAC;YACX,CAAC,CAAC;UACH;QACD;MACD,CAAC,CAAC;IACH;EACD,CAAC;EAEM,SAASmP,UAAUA,CAACtP,OAAO,EAAE;IACnC,MACCuP,MAAM,GAAG,GAAG5P,KAAK,CAACe,GAAG,CAACC,OAAO,oBAAoB;MACjD6O,OAAO,GAAG,GAAG7P,KAAK,CAACe,GAAG,CAACC,OAAO,2BAA2B;IAC1D,OAAO,IAAIV,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAMsP,MAAM,GAAG/P,CAAC,CAAC,YAAY,EAAEM,OAAO,CAAC;MACvC,IAAIyP,MAAM,CAACpP,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAACoE,SAAS,EAC9B,GAAGvL,KAAK,CAACe,GAAG,CAACC,OAAO,sCAAsChB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;UACrG,MAAMkG,QAAQ,GAAG,EAAE;UACnB,IAAIlG,SAAS,EAAE;YACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,GAAGH,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAAC;YAC3FoG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAAC,GAAGsI,OAAO,wBAAwB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EAAE,gBAAgB,CAAC,CAAC;UAC7G;UACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;YACpC,MACC8O,GAAG,GAAG,CAAC,CAAC;cACRC,KAAK,GAAG,EAAE;cACVC,UAAU,GAAG,EAAE;cACfC,OAAO,GAAG,EAAE;cACZC,MAAM,GAAG,CAAC,CAAC;YACZN,MAAM,CAAC1O,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;cACzB,MACC2L,KAAK,GAAGlN,CAAC,CAACuB,GAAG,CAAC;gBACdC,IAAI,GAAG0L,KAAK,CAAC1L,IAAI,CAAC,CAAC;cACpB,IAAIA,IAAI,CAAC8O,OAAO,KAAK,SAAS,EAAE;gBAC/BpD,KAAK,CAACpL,IAAI,CAAC,cAAc,EAAE,mBAAmB,CAAC;gBAC/CoL,KAAK,CAAC4B,UAAU,CAAC,SAAS,CAAC;gBAC3BtN,IAAI,CAAC8O,OAAO,GAAGpD,KAAK,CAAC1L,IAAI,CAAC,SAAS,CAAC;cACrC,CAAC,MAAM,IAAIA,IAAI,CAAC8O,OAAO,KAAK,KAAK,EAAE;gBAClCpD,KAAK,CAACpL,IAAI,CAAC,cAAc,EAAE,oDAAoD,CAAC;gBAChFoL,KAAK,CAAC4B,UAAU,CAAC,SAAS,CAAC;gBAC3BtN,IAAI,CAAC8O,OAAO,GAAGpD,KAAK,CAAC1L,IAAI,CAAC,SAAS,CAAC;cACrC;cACA,IAAIA,IAAI,CAAC+O,QAAQ,IAAI,CAACF,MAAM,CAACE,QAAQ,IAAI,CAACvQ,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACgF,QAAQ,EAAE;gBAClEN,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAChEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACrE+O,GAAG,CAAC,iBAAiB,CAAC,GAAG,GAAGH,OAAO,sBAAsB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBAC/EmP,MAAM,CAACE,QAAQ,GAAG,IAAI;cACvB;cACA,IAAI/O,IAAI,CAAC8O,OAAO,EAAE;gBACjB,IAAI,CAACD,MAAM,CAACC,OAAO,IAAI,CAACtQ,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACiF,OAAO,EAAE;kBAC/CP,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,qBAAqB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;kBAC/DiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,qBAAqB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;kBACpEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,gBAAgB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;kBAC/D+O,GAAG,CAAC,gBAAgB,CAAC,GAAG,GAAGH,OAAO,qBAAqB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;kBAC7EmP,MAAM,CAACC,OAAO,GAAG,IAAI;gBACtB;gBACA,IAAItQ,CAAC,CAAC0Q,OAAO,CAAClP,IAAI,CAAC8O,OAAO,CAAC,EAAE;kBAC5B,MAAMK,UAAU,GAAG,EAAE;kBACrB,KAAK,MAAMC,MAAM,IAAIpP,IAAI,CAAC8O,OAAO,EAAE;oBAClC,QAAQM,MAAM;sBACb,KAAK,MAAM;wBACVD,UAAU,CAACpJ,IAAI,CAAC;0BACf9E,MAAM,EAAE,WAAW;0BACnBoO,aAAa,EAAE;4BACdC,OAAO,EAAE;0BACV;wBACD,CAAC,CAAC;wBACF;sBACD,KAAK,KAAK;wBACTH,UAAU,CAACpJ,IAAI,CAAC;0BACf9E,MAAM,EAAE,UAAU;0BAClBoO,aAAa,EAAE;4BACdC,OAAO,EAAE;0BACV;wBACD,CAAC,CAAC;wBACF;sBACD,KAAK,OAAO;wBACX,IAAI,CAACT,MAAM,CAACU,aAAa,IAAI,CAAC/Q,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACC,GAAG,CAAC6E,OAAO,CAACU,UAAU,EAAE;0BACpEd,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,QAAQ5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;0BAClDmP,MAAM,CAACU,aAAa,GAAG,IAAI;wBAC5B;wBACAJ,UAAU,CAACpJ,IAAI,CAAC;0BACf9E,MAAM,EAAE,YAAY;0BACpBoO,aAAa,EAAE;4BACdC,OAAO,EAAE;0BACV;wBACD,CAAC,CAAC;wBACF;sBACD,KAAK,KAAK;wBACT,IAAI,CAACT,MAAM,CAACY,WAAW,IAAI,CAACnQ,MAAM,CAACoQ,OAAO,EAAE;0BAC3ChB,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,UAAU5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;0BACpDiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,YAAY5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;0BAC3DmP,MAAM,CAACY,WAAW,GAAG,IAAI;wBAC1B;wBACAN,UAAU,CAACpJ,IAAI,CAAC;0BACf9E,MAAM,EAAE,UAAU;0BAClBoO,aAAa,EAAE;4BACdC,OAAO,EAAE;0BACV;wBACD,CAAC,CAAC;wBACF;sBACD,KAAK,OAAO;wBACX,IAAI,CAACT,MAAM,CAACc,aAAa,IAAI,CAACnR,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACC,GAAG,CAAC6E,OAAO,CAACc,KAAK,EAAE;0BAC/DhB,OAAO,CAAC7I,IAAI,CAAC,GAAGsI,MAAM,gBAAgB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;0BAC5DmP,MAAM,CAACc,aAAa,GAAG,IAAI;wBAC5B;wBACAR,UAAU,CAACpJ,IAAI,CAAC;0BACf9E,MAAM,EAAE,OAAO;0BACfoO,aAAa,EAAE;4BACdC,OAAO,EAAE;0BACV;wBACD,CAAC,CAAC;wBACF;sBACD,KAAK,QAAQ;wBACZ,IAAI,CAACT,MAAM,CAACgB,cAAc,IAAI,CAACrR,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACC,GAAG,CAAC6E,OAAO,CAACgB,MAAM,EAAE;0BACjElB,OAAO,CAAC7I,IAAI,CAAC,GAAGsI,MAAM,iBAAiB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;0BAC7DmP,MAAM,CAACgB,cAAc,GAAG,IAAI;wBAC7B;wBACAV,UAAU,CAACpJ,IAAI,CAAC;0BACf9E,MAAM,EAAE;wBACT,CAAC,CAAC;oBACJ;kBACD;kBACAjB,IAAI,CAAC8O,OAAO,GAAGK,UAAU;gBAC1B;cACD;cACA,IAAInP,IAAI,CAAC+P,UAAU,IAAI,CAAClB,MAAM,CAACkB,UAAU,IAAI,CAACvR,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACgG,UAAU,EAAE;gBACxEtB,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAClEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACvE+O,GAAG,CAAC,mBAAmB,CAAC,GAAG,GAAGH,OAAO,wBAAwB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACnFmP,MAAM,CAACkB,UAAU,GAAG,IAAI;cACzB;cACA,IAAI/P,IAAI,CAACiQ,YAAY,IAAI,CAACpB,MAAM,CAACoB,YAAY,IAAI,CAACzR,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACkG,YAAY,EAAE;gBAC9ExB,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,0BAA0B5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACpEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,0BAA0B5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACzE+O,GAAG,CAAC,qBAAqB,CAAC,GAAG,GAAGH,OAAO,0BAA0B7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACvFmP,MAAM,CAACoB,YAAY,GAAG,IAAI;cAC3B;cACA,IAAIjQ,IAAI,CAACmQ,WAAW,IAAI,CAACtB,MAAM,CAACsB,WAAW,IAAI,CAAC3R,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACoG,WAAW,EAAE;gBAC3E1B,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,yBAAyB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACnEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,yBAAyB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACxE+O,GAAG,CAAC,oBAAoB,CAAC,GAAG,GAAGH,OAAO,yBAAyB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACrFmP,MAAM,CAACsB,WAAW,GAAG,IAAI;cAC1B;cACA,IAAInQ,IAAI,CAACqQ,QAAQ,IAAI,CAACxB,MAAM,CAACwB,QAAQ,IAAI,CAAC7R,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACsG,QAAQ,EAAE;gBAClE5B,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAChEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACrE+O,GAAG,CAAC,iBAAiB,CAAC,GAAG,GAAGH,OAAO,sBAAsB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBAC/EmP,MAAM,CAACwB,QAAQ,GAAG,IAAI;cACvB;cACA,IAAKrQ,IAAI,CAACuQ,UAAU,KAAK,KAAK,IAAK,CAAC1B,MAAM,CAAC0B,UAAU,IAAI,CAAC/R,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACwG,UAAU,EAAE;gBACpF9B,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAClEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACvE+O,GAAG,CAAC,mBAAmB,CAAC,GAAG,GAAGH,OAAO,wBAAwB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACnFmP,MAAM,CAAC0B,UAAU,GAAG,IAAI;cACzB;cACA,IAAIvQ,IAAI,CAACyQ,QAAQ,IAAI,CAAC5B,MAAM,CAAC4B,QAAQ,IAAI,CAACjS,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAAC0G,QAAQ,EAAE;gBAClEhC,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAChEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACrE+O,GAAG,CAAC,iBAAiB,CAAC,GAAG,GAAGH,OAAO,sBAAsB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBAC/EmP,MAAM,CAAC4B,QAAQ,GAAG,IAAI;cACvB;cACA,IAAIzQ,IAAI,CAAC2Q,UAAU,IAAI,CAAC9B,MAAM,CAAC8B,UAAU,IAAI,CAACnS,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAAC4G,UAAU,EAAE;gBACxElC,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAClEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,wBAAwB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACvE+O,GAAG,CAAC,mBAAmB,CAAC,GAAG,GAAGH,OAAO,wBAAwB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACnFmP,MAAM,CAAC8B,UAAU,GAAG,IAAI;cACzB;cACA,IAAI3Q,IAAI,CAAC6Q,QAAQ,IAAI,CAAChC,MAAM,CAACgC,QAAQ,IAAI,CAACrS,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAAC8G,QAAQ,EAAE;gBAClEpC,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAChEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,sBAAsB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACrE+O,GAAG,CAAC,iBAAiB,CAAC,GAAG,GAAGH,OAAO,sBAAsB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBAC/EmP,MAAM,CAACgC,QAAQ,GAAG,IAAI;cACvB;cACA,IAAI7Q,IAAI,CAAC+Q,aAAa,IAAI,CAAClC,MAAM,CAACkC,aAAa,IAAI,CAACvS,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACgH,aAAa,EAAE;gBACjFtC,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,2BAA2B5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACrEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,2BAA2B5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAC1E+O,GAAG,CAAC,sBAAsB,CAAC,GAAG,GAAGH,OAAO,2BAA2B7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACzFmP,MAAM,CAACkC,aAAa,GAAG,IAAI;cAC5B;cACA,IAAI/Q,IAAI,CAACiR,WAAW,IAAI,CAACpC,MAAM,CAACoC,WAAW,IAAI,CAACzS,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACkH,WAAW,EAAE;gBAC3E,IAAI,CAACrC,MAAM,CAACsC,MAAM,IAAI,CAAC3S,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACmH,MAAM,EAAE;kBAC7CzC,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,oBAAoB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;kBAC9DiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,oBAAoB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;kBACnE+O,GAAG,CAAC,eAAe,CAAC,GAAG,GAAGH,OAAO,oBAAoB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;kBAC3EmP,MAAM,CAACsC,MAAM,GAAG,IAAI;gBACrB;gBACAxC,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,yBAAyB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACxEkP,OAAO,CAAC7I,IAAI,CAAC,GAAGsI,MAAM,yBAAyB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACrE+O,GAAG,CAAC,oBAAoB,CAAC,GAAG,GAAGH,OAAO,yBAAyB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACrFmP,MAAM,CAACoC,WAAW,GAAG,IAAI;cAC1B;cACA,IAAIjR,IAAI,CAACmR,MAAM,IAAI,CAACtC,MAAM,CAACsC,MAAM,IAAI,CAAC3S,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACmH,MAAM,EAAE;gBAC5DzC,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,oBAAoB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBAC9DiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,oBAAoB5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACnE+O,GAAG,CAAC,eAAe,CAAC,GAAG,GAAGH,OAAO,oBAAoB7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBAC3EmP,MAAM,CAACsC,MAAM,GAAG,IAAI;cACrB;cACA,IAAInR,IAAI,CAACoR,YAAY,IAAI,CAACvC,MAAM,CAACuC,YAAY,IAAI,CAAC5S,CAAC,CAACoH,EAAE,CAACyL,UAAU,CAACD,YAAY,EAAE;gBAC/E1C,KAAK,CAAC3I,IAAI,CAAC,GAAGsI,MAAM,0BAA0B5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACpEiP,UAAU,CAAC5I,IAAI,CAAC,GAAGsI,MAAM,0BAA0B5P,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC;gBACzE+O,GAAG,CAAC,qBAAqB,CAAC,GAAG,GAAGH,OAAO,0BAA0B7P,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM;gBACvFmP,MAAM,CAACuC,YAAY,GAAG,IAAI;cAC3B;YACD,CAAC,CAAC;YACF5S,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEkQ,KAAK,CAACpC,GAAG,CAAC7N,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,CAAC,CAAC7O,IAAI,CAAC,MAAM;cAC3D,OAAOnB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEmQ,UAAU,CAACrC,GAAG,CAAC7N,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,CAAC,CAAC7O,IAAI,CAAC,MAAM;gBACvE,OAAOnB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEoQ,OAAO,CAACtC,GAAG,CAAC7N,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,CAAC,CAAC7O,IAAI,CAAC,MAAM;kBACpE,IAAIC,SAAS,EAAE;oBACdiK,kBAAkB,CAACC,IAAI,CAAC,CAAC;kBAC1B;kBACA,KAAK,MAAM,CAACwH,IAAI,EAAEvF,GAAG,CAAC,IAAIwF,MAAM,CAACC,OAAO,CAAC/C,GAAG,CAAC,EAAE;oBAC9ChQ,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAAC+F,GAAG,EAAEuF,IAAI,CAAC;kBAC7B;kBACA/C,MAAM,CAAC1O,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;oBACzB,MAAM2L,KAAK,GAAGlN,CAAC,CAACuB,GAAG,CAAC;oBACpB,IAAIvB,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACyH,WAAW,CAAC/F,KAAK,CAAC,EAAE;sBACtC;oBACD;oBACA,MAAM1L,IAAI,GAAG0L,KAAK,CAAC1L,IAAI,CAAC,CAAC;;oBAEzB;oBACA,IAAI0R,GAAG,GAAG1R,IAAI,CAAC2R,eAAe,IAAI3R,IAAI,CAAC4R,MAAM,IAAI5R,IAAI,CAAC0R,GAAG,IAAI,EAAE;oBAC/D,IAAI,CAACA,GAAG,EAAE;sBACT,IAAI1R,IAAI,CAAC8O,OAAO,EAAE;wBACjB4C,GAAG,IAAI,2BAA2B;sBACnC;sBACA,IAAI1R,IAAI,CAAC+Q,aAAa,EAAE;wBACvBW,GAAG,IAAI,GAAG;sBACX;sBACA,IAAI1R,IAAI,CAACiR,WAAW,EAAE;wBACrBS,GAAG,IAAI,GAAG;sBACX;sBACA,IAAI1R,IAAI,CAAC6R,SAAS,KAAK,KAAK,IAAI7R,IAAI,CAAC8R,YAAY,KAAK,KAAK,EAAE;wBAC5DJ,GAAG,IAAI,aAAa;wBACpB,IAAI1R,IAAI,CAAC6R,SAAS,KAAK,KAAK,EAAE;0BAC7BH,GAAG,IAAI,wBAAwB;wBAChC;wBACA,IAAI1R,IAAI,CAAC8R,YAAY,KAAK,KAAK,EAAE;0BAChCJ,GAAG,IAAI,wBAAwB;wBAChC;wBACAA,GAAG,IAAI,GAAG;sBACX;sBACAA,GAAG,IAAI,wBAAwB;sBAC/B,IAAI1R,IAAI,CAAC+R,IAAI,KAAK,KAAK,IAAI/R,IAAI,CAACgS,MAAM,KAAK,KAAK,EAAE;wBACjDN,GAAG,IAAI,kBAAkB;wBACzB,IAAI1R,IAAI,CAAC+R,IAAI,KAAK,KAAK,EAAE;0BACxBL,GAAG,IAAI,yBAAyB;wBACjC;wBACA,IAAI1R,IAAI,CAACgS,MAAM,KAAK,KAAK,EAAE;0BAC1BN,GAAG,IAAI,yBAAyB;wBACjC;wBACAA,GAAG,IAAI,GAAG;sBACX;oBACD;oBACA,IAAI,CAAC1R,IAAI,CAAC8O,OAAO,IAAI,CAAC9O,IAAI,CAAC+Q,aAAa,IAAI,CAAC/Q,IAAI,CAACiR,WAAW,IAC3DjR,IAAI,CAAC6R,SAAS,KAAK,KAAM,IAAK7R,IAAI,CAAC8R,YAAY,KAAK,KAAM,EAAE;sBAC7DpG,KAAK,CAACvG,QAAQ,CAAC,IAAI,CAAC,CAACG,QAAQ,CAAC,MAAM,CAAC;oBACtC;;oBAEA;oBACA,MACCrF,cAAc,GAAG;sBAChBgS,QAAQ,EAAEjS,IAAI,CAACkS,oBAAoB,IAAIlS,IAAI,CAACmS,WAAW,IACtD1T,KAAK,CAAC2T,IAAI,CAAClS,OAAO,CAACkO,UAAU;sBAC9BmC,UAAU,EAAE,IAAI;sBAChBmB,GAAG,EAAEA;oBACN,CAAC;;oBAEF;oBACA,IAAIpH,KAAK,GAAGtK,IAAI,CAACqS,iBAAiB,IAAIrS,IAAI,CAACsS,QAAQ;oBACnD,IAAI,OAAOhI,KAAK,KAAK,QAAQ,EAAE;sBAC9B,MAAMiI,MAAM,GAAGjI,KAAK,CAACW,KAAK,CAAC,GAAG,CAAC;sBAC/BX,KAAK,GAAG,EAAE;sBACV,KAAK,MAAMkI,GAAG,IAAID,MAAM,EAAE;wBACzB,MAAME,QAAQ,GAAGD,GAAG,CAACvH,KAAK,CAAC,GAAG,CAAC;wBAC/BwH,QAAQ,CAAC,CAAC,CAAC,GAAGC,QAAQ,CAACD,QAAQ,CAAC,CAAC,CAAC,CAAC;wBACnCnI,KAAK,CAACvE,IAAI,CAAC0M,QAAQ,CAAC;sBACrB;oBACD;oBACA,IAAInI,KAAK,EAAE;sBACVrK,cAAc,CAACqK,KAAK,GAAGA,KAAK;oBAC7B;;oBAEA;oBACA,MACCqI,KAAK,GAAGnU,CAAC,CAAC,UAAU,EAAEkN,KAAK,CAAC;sBAC5B4D,OAAO,GAAG,EAAE;oBACbqD,KAAK,CAAC9S,IAAI,CAAC,CAACC,GAAG,EAAE8S,EAAE,KAAK;sBACvBtD,OAAO,CAACxP,GAAG,CAAC,GAAGtB,CAAC,CAACoU,EAAE,CAAC,CAAC5S,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;oBAC9C,CAAC,CAAC;oBACF,MAAM6S,SAAS,GAAGF,KAAK,CAACpG,QAAQ,CAAC,mBAAmB,CAAC;oBACrD,KAAK,MAAMuG,QAAQ,IAAID,SAAS,CAACrB,OAAO,CAAC,CAAC,EAAE;sBAC3C,MAAM,CAAC1R,GAAG,EAAEiT,QAAQ,CAAC,GAAGD,QAAQ;sBAChC,IAAI9S,IAAI,CAAC2Q,UAAU,EAAE;wBACpBrB,OAAO,CAACxP,GAAG,CAAC,CAACiT,QAAQ,GAAG,KAAK;sBAC9B,CAAC,MAAM,IAAIA,QAAQ,KAAKC,SAAS,EAAE;wBAClC1D,OAAO,CAACxP,GAAG,CAAC,CAACiT,QAAQ,GACpB,OAAOA,QAAQ,KAAK,QAAQ,GAAGE,IAAI,CAACC,KAAK,CAACH,QAAQ,CAAC,GAAGA,QAAQ;sBAChE;oBACD;oBACA,MAAMhJ,KAAK,GAAG4I,KAAK,CAACpG,QAAQ,CAAC,eAAe,CAAC;oBAC7C,KAAK,MAAMuG,QAAQ,IAAI/I,KAAK,CAACyH,OAAO,CAAC,CAAC,EAAE;sBACvC,MAAM,CAAC1R,GAAG,EAAEqT,KAAK,CAAC,GAAGL,QAAQ;sBAC7B,IAAIK,KAAK,KAAMH,SAAS,EAAE;wBACzB1D,OAAO,CAACxP,GAAG,CAAC,CAACoK,IAAI,GAAGiJ,KAAK;sBAC1B;oBACD;oBACAlT,cAAc,CAACqP,OAAO,GAAGA,OAAO;;oBAEhC;oBACA,IAAItO,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAACoT,mBAAmB,IAAIpT,IAAI,CAAC+I,UAAU,CAAC;oBACxF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACqT,wBAAwB,IAAIrT,IAAI,CAACuB,OAAO,EAC7CC,QAAQ,EAAEkK,KAAK,EAAE1K,QAAQ,CAAC,IAAIA,QAAQ;oBACvC,MAAMS,IAAI,GAAG;sBAACA,IAAI,EAAE;oBAAK,CAAC;oBAC1BiK,KAAK,CAAChK,OAAO,CAAC,2BAA2B,EAAE,CAACgK,KAAK,EAAE1K,QAAQ,EAAES,IAAI,CAAC,CAAC;oBACnE,IAAIA,IAAI,CAACA,IAAI,EAAE;sBACd;oBACD;oBACA6R,UAAU,CAAC,MAAM;sBAChB,IAAI9U,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACiF,OAAO,EAAE;wBAC3BzQ,CAAC,CAACoH,EAAE,CAACoE,SAAS,CAACiF,OAAO,CAACsE,QAAQ,CAAC7B,GAAG,CAACtC,MAAM,CAACoE,SAAS,GAAGxT,IAAI,CAACyT,4BAA4B,IACvFzT,IAAI,CAAC0T,mBAAmB,IAAI,0BAA0B;sBACxD;sBACA,MAAMzK,MAAM,GAAGyC,KAAK,CAACG,SAAS,CAAC7K,QAAQ,CAAC;sBACxCvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAAC2T,6BAA6B,IAAI3T,IAAI,CAACmJ,YAAY,EACvD3H,QAAQ,EAAEkK,KAAK,EAAEzC,MAAM,EAAEjI,QAAQ,CAAC;sBACnC0K,KAAK,CAAChK,OAAO,CAAC,0BAA0B,EAAE,CAACgK,KAAK,EAAEzC,MAAM,CAAC,CAAC;;sBAE1D;sBACA,IAAIjI,QAAQ,CAAC2P,UAAU,EAAE;wBACxB1H,MAAM,CAACzD,EAAE,CAAC,iBAAiB,EAAE/G,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACvD7G,IAAI,CAAC4T,sBAAsB,IAAI5T,IAAI,CAAC6T,aAAa,CAAC,IACnDhK,kBAAkB,CAAC2B,UAAU,CAAC;wBAC/BvC,MAAM,CAACzD,EAAE,CAAC,aAAa,EAAE/G,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACnD7G,IAAI,CAAC8T,qBAAqB,IAAI9T,IAAI,CAAC+T,YAAY,CAAC,IACjDlK,kBAAkB,CAAC8B,WAAW,CAAC;sBACjC;oBACD,CAAC,EAAE,GAAG,CAAC;kBACR,CAAC,CAAC;kBACF3M,OAAO,CAACuP,MAAM,CAAC;gBAChB,CAAC,EAAEtP,MAAM,CAAC;cACX,CAAC,EAAEA,MAAM,CAAC;YACX,CAAC,EAAEA,MAAM,CAAC;UACX,CAAC,EAAEA,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;EACO,SAASgV,QAAQA,CAAClV,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM0G,MAAM,GAAGnH,CAAC,CAAC,WAAW,EAAEM,OAAO,CAAC;MACtC,IAAI6G,MAAM,CAACxG,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACW,IAAI,CAACC,KAAK,CAACC,MAAM,CAAC2U,MAAM,EAC7B,GAAGxV,KAAK,CAACe,GAAG,CAACC,OAAO,gBAAgBhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAC,MAAM;UACtElB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAACsO,cAAc,EACnC,GAAGzV,KAAK,CAACe,GAAG,CAACC,OAAO,kCAAkChB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YACjG,MAAMkG,QAAQ,GAAG,EAAE;YACnB,IAAIlG,SAAS,EAAE;cACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAC9B,GAAGvH,KAAK,CAACe,GAAG,CAACC,OAAO,yCAAyChB,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EACnF,eAAe,CAAC,CAAC;YACnB;YACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;cACpCgG,MAAM,CAAC9F,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACzB,MACC4E,KAAK,GAAGnG,CAAC,CAACuB,GAAG,CAAC;kBACdC,IAAI,GAAG2E,KAAK,CAAC3E,IAAI,CAAC,CAAC;kBACnBC,cAAc,GAAG;oBAChBI,MAAM,EAAEL,IAAI,CAACmU,mBAAmB,IAAInU,IAAI,CAACmS,WAAW,IAAI1T,KAAK,CAAC2T,IAAI,CAACH,QAAQ;oBAC3EmC,KAAK,EAAE;sBACNC,IAAI,EAAE,cAAc;sBACpBC,IAAI,EAAE,iBAAiB;sBACvBC,EAAE,EAAE,iBAAiB;sBACrBC,IAAI,EAAE,mBAAmB;sBACzBC,QAAQ,EAAE,qBAAqB;sBAC/B5T,IAAI,EAAE,sBAAsB;sBAC5B6T,KAAK,EAAE,yBAAyB;sBAChCC,KAAK,EAAE,cAAc;sBACrBC,KAAK,EAAE;oBACR,CAAC;oBACDN,IAAI,EAAE3P,KAAK,CAACU,GAAG,CAAC,CAAC;oBACjBe,MAAM,EAAEpG,IAAI,CAAC6U,iBAAiB,IAAI7U,IAAI,CAACsG;kBACxC,CAAC;gBACF,IAAItF,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAAC8U,eAAe,IAAI9U,IAAI,CAACmB,OAAO,CAAC;gBACjFH,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAAC+U,uBAAuB,IAAI/U,IAAI,CAACuB,OAAO,EAC5CC,QAAQ,EAAEmD,KAAK,EAAE3D,QAAQ,CAAC,IAAIA,QAAQ;gBACvC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1BkD,KAAK,CAACjD,OAAO,CAAC,0BAA0B,EAAE,CAACiD,KAAK,EAAE3D,QAAQ,EAAES,IAAI,CAAC,CAAC;gBAClE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACAkD,KAAK,CAACuP,cAAc,CAAClT,QAAQ,CAAC;gBAC9B,MAAMiI,MAAM,GAAGtE,KAAK,CAAC3E,IAAI,CAAC,gBAAgB,CAAC;gBAC3C,IAAIA,IAAI,CAACgV,oBAAoB,IAAIhV,IAAI,CAACiV,YAAY,EAAE;kBACnDtQ,KAAK,CAACa,EAAE,CAAC,uBAAuB,EAAGd,GAAG,IAAK;oBAC1C,MACCwQ,MAAM,GAAG1W,CAAC,CAACkG,GAAG,CAACyQ,aAAa,CAAC;sBAC7BnV,IAAI,GAAGkV,MAAM,CAAClV,IAAI,CAAC,CAAC;sBACpB4E,MAAM,GAAGpG,CAAC,CAACwB,IAAI,CAACgV,oBAAoB,IAAIhV,IAAI,CAACiV,YAAY,CAAC;oBAC3DrQ,MAAM,CAACS,GAAG,CAACX,GAAG,CAAC4P,IAAI,GAAG5P,GAAG,CAAC4P,IAAI,CAACc,WAAW,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;kBACzD,CAAC,CAAC;gBACH;gBACAzQ,KAAK,CAACjD,OAAO,CAAC,yBAAyB,EAAE,CAACiD,KAAK,EAAEsE,MAAM,CAAC,CAAC;cAC1D,CAAC,CAAC;cACFjK,OAAO,CAAC2G,MAAM,CAAC;YAChB,CAAC,CAAC;UACH,CAAC,EAAE1G,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASqW,QAAQA,CAACvW,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAMqW,SAAS,GAAG9W,CAAC,CAAC,+CAA+C,EAAEM,OAAO,CAAC;MAC7E,IAAIwW,SAAS,CAACnW,MAAM,GAAG,CAAC,EAAE;QACzBV,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAAC2P,SAAS,EAC9B,GAAG9W,KAAK,CAACe,GAAG,CAACC,OAAO,mBAAmBhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAC,MAAM;UACzElB,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAAC,GAAGvH,KAAK,CAACe,GAAG,CAACC,OAAO,oCAAoChB,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EAAE,WAAW,CAAC,CAACC,IAAI,CAAC,MAAM;YACzH2V,SAAS,CAACzV,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;cAC5B,MACCyV,IAAI,GAAGhX,CAAC,CAACuB,GAAG,CAAC;gBACbC,IAAI,GAAGwV,IAAI,CAACxV,IAAI,CAAC,CAAC;cACnB;cACA,IAAIwV,IAAI,CAAC9S,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC/B,MAAM+S,WAAW,GAAG;kBACnBC,IAAI,EAAE1V,IAAI,CAAC2V,gBAAgB,IAAI3V,IAAI,CAAC4V,OAAO;kBAC3CC,MAAM,EAAE7V,IAAI,CAAC8V,kBAAkB,IAAI,MAAM;kBACzCC,WAAW,EAAE/V,IAAI,CAACgW,uBAAuB,IAAIhW,IAAI,CAACiW,cAAc;kBAChEC,KAAK,EAAElW,IAAI,CAACmW,iBAAiB,IAAInW,IAAI,CAACoW,QAAQ;kBAC9CC,MAAM,EAAErW,IAAI,CAACsW,kBAAkB,IAAItW,IAAI,CAACuW,SAAS;kBACjDC,iBAAiB,EAAExW,IAAI,CAACyW,2BAA2B,IAAIzW,IAAI,CAAC0W,kBAAkB;kBAC9EC,MAAM,EAAE3W,IAAI,CAAC4W,kBAAkB,IAAI5W,IAAI,CAAC6W,SAAS;kBACjDC,cAAc,EAAE9W,IAAI,CAAC+W,0BAA0B,IAAI/W,IAAI,CAACgX,iBAAiB;kBACzEC,MAAM,EAAExY,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACkX,kBAAkB,CAAC,IAAIlX,IAAI,CAACkX,kBAAkB;kBACxF1W,KAAK,EAAE/B,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACmX,iBAAiB,CAAC,IAAI,UAASzS,GAAG,EAAE0S,EAAE,EAAE;oBAChF5Y,CAAC,CAACkG,GAAG,CAACyQ,aAAa,CAAC,CAACnV,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC;kBAC/C,CAAC;kBACDqX,IAAI,EAAE5Y,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACsX,gBAAgB,CAAC,IAAI,UAAS5S,GAAG,EAAE0S,EAAE,EAAE;oBAC9E9D,UAAU,CAAC,MAAM;sBAChB9U,CAAC,CAACkG,GAAG,CAACyQ,aAAa,CAAC,CAACnV,IAAI,CAAC,aAAa,EAAE,KAAK,CAAC;oBAChD,CAAC,EAAE,GAAG,CAAC;kBACR;gBACD,CAAC;gBACD,IAAIgB,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEwU,WAAW,EACtCzV,IAAI,CAACuX,mBAAmB,IAAIvX,IAAI,CAAC+I,UAAU,CAAC;gBAC7C/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACwX,wBAAwB,IAAIxX,IAAI,CAACuB,OAAO,EAC7CC,QAAQ,EAAEgU,IAAI,EAAExU,QAAQ,CAAC,IAAIA,QAAQ;gBACtC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1B+T,IAAI,CAAC9T,OAAO,CAAC,2BAA2B,EAAE,CAAC8T,IAAI,EAAExU,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACjE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGuM,IAAI,CAACD,SAAS,CAACvU,QAAQ,CAAC;gBACvCwU,IAAI,CAACiC,gBAAgB,CAAC,CAAC;gBACvBhZ,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAAC0X,6BAA6B,IAAI1X,IAAI,CAACmJ,YAAY,EACvD3H,QAAQ,EAAEgU,IAAI,EAAEvM,MAAM,EAAEjI,QAAQ,CAAC;gBAClCwU,IAAI,CAAC9T,OAAO,CAAC,0BAA0B,EAAE,CAAC8T,IAAI,EAAEvM,MAAM,CAAC,CAAC;cACzD;cACA;cACA,IAAIuM,IAAI,CAAC9S,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC/B,MAAMiV,WAAW,GAAG;kBACnBC,MAAM,EAAE5X,IAAI,CAAC6X,kBAAkB,IAAI7X,IAAI,CAAC8X,SAAS;kBACjDC,OAAO,EAAE/X,IAAI,CAACgY,mBAAmB;kBACjCC,IAAI,EAAExZ,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACkY,gBAAgB;gBACzD,CAAC;gBACD,IAAIlX,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAE0W,WAAW,EACtC3X,IAAI,CAACmY,mBAAmB,IAAInY,IAAI,CAAC+I,UAAU,CAAC;gBAC7C/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACoY,wBAAwB,IAAIpY,IAAI,CAACuB,OAAO,EAC7CC,QAAQ,EAAEgU,IAAI,EAAExU,QAAQ,CAAC,IAAIA,QAAQ;gBACtC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1B+T,IAAI,CAAC9T,OAAO,CAAC,2BAA2B,EAAE,CAAC8T,IAAI,EAAExU,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACjE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGuM,IAAI,CAAC6C,SAAS,CAACrX,QAAQ,CAAC;gBACvCvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAACsY,6BAA6B,IAAItY,IAAI,CAACmJ,YAAY,EACvD3H,QAAQ,EAAEgU,IAAI,EAAEvM,MAAM,EAAEjI,QAAQ,CAAC;gBAClCwU,IAAI,CAAC9T,OAAO,CAAC,0BAA0B,EAAE,CAAC8T,IAAI,EAAEvM,MAAM,CAAC,CAAC;cACzD;cACA;cACA,IAAIuM,IAAI,CAAC9S,QAAQ,CAAC,UAAU,CAAC,EAAE;gBAC9B,MAAM6V,WAAW,GAAG;kBACnBC,KAAK,EAAExY,IAAI,CAACyY,gBAAgB;kBAC5BpC,MAAM,EAAErW,IAAI,CAAC0Y,iBAAiB;kBAC9BzB,MAAM,EAAExY,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC2Y,iBAAiB,CAAC,IAAI3Y,IAAI,CAAC2Y,iBAAiB;kBACtFC,WAAW,EAAE5Y,IAAI,CAAC6Y,sBAAsB;kBACxC9C,WAAW,EAAE/V,IAAI,CAAC8Y,sBAAsB;kBACxCC,WAAW,EAAE/Y,IAAI,CAACgZ,sBAAsB;kBACxCxY,KAAK,EAAE/B,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACiZ,gBAAgB,CAAC;kBAC1DC,IAAI,EAAEza,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACmZ,eAAe,CAAC;kBACxD9B,IAAI,EAAE5Y,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACoZ,eAAe;gBACxD,CAAC;gBACD,IAAIpY,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEsX,WAAW,EACtCvY,IAAI,CAACqZ,kBAAkB,IAAIrZ,IAAI,CAAC+I,UAAU,CAAC;gBAC5C/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACsZ,uBAAuB,IAAItZ,IAAI,CAACuB,OAAO,EAC5CC,QAAQ,EAAEgU,IAAI,EAAExU,QAAQ,CAAC,IAAIA,QAAQ;gBACtC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1B+T,IAAI,CAAC9T,OAAO,CAAC,0BAA0B,EAAE,CAAC8T,IAAI,EAAExU,QAAQ,EAAES,IAAI,CAAC,CAAC;gBAChE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGuM,IAAI,CAACzC,QAAQ,CAAC/R,QAAQ,CAAC;gBACtCwU,IAAI,CAACiC,gBAAgB,CAAC,CAAC;gBACvBhZ,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAACuZ,4BAA4B,IAAIvZ,IAAI,CAACmJ,YAAY,EACtD3H,QAAQ,EAAEgU,IAAI,EAAEvM,MAAM,EAAEjI,QAAQ,CAAC;gBAClCwU,IAAI,CAAC9T,OAAO,CAAC,yBAAyB,EAAE,CAAC8T,IAAI,EAAEvM,MAAM,CAAC,CAAC;cACxD;cACA;cACA,IAAIuM,IAAI,CAAC9S,QAAQ,CAAC,WAAW,CAAC,EAAE;gBAC/B,MAAM8W,aAAa,GAAG;kBACrBC,QAAQ,EAAEzZ,IAAI,CAAC0Z,oBAAoB,KAAK,KAAK,GAAG,IAAI,GAAG1Z,IAAI,CAAC0Z,oBAAoB;kBAChF3D,WAAW,EAAE/V,IAAI,CAAC2Z,uBAAuB;kBACzCC,IAAI,EAAE5Z,IAAI,CAAC6Z,gBAAgB;kBAC3BC,OAAO,EAAE9Z,IAAI,CAAC+Z,mBAAmB;kBACjCvZ,KAAK,EAAE/B,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACga,iBAAiB,CAAC;kBAC3DC,MAAM,EAAExb,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACka,kBAAkB,CAAC;kBAC7D7C,IAAI,EAAE5Y,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACma,gBAAgB;gBACzD,CAAC;gBACD,IAAInZ,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEuY,aAAa,EACxCxZ,IAAI,CAACoa,mBAAmB,IAAIpa,IAAI,CAAC+I,UAAU,CAAC;gBAC7C/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACqa,wBAAwB,IAAIra,IAAI,CAACuB,OAAO,EAC7CC,QAAQ,EAAEgU,IAAI,EAAExU,QAAQ,CAAC,IAAIA,QAAQ;gBACtC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1B+T,IAAI,CAAC9T,OAAO,CAAC,2BAA2B,EAAE,CAAC8T,IAAI,EAAExU,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACjE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGuM,IAAI,CAAC8E,SAAS,CAACtZ,QAAQ,CAAC;gBACvCwU,IAAI,CAACiC,gBAAgB,CAAC,CAAC;gBACvBhZ,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAACua,6BAA6B,IAAIva,IAAI,CAACmJ,YAAY,EACvD3H,QAAQ,EAAEgU,IAAI,EAAEvM,MAAM,EAAEjI,QAAQ,CAAC;gBAClCwU,IAAI,CAAC9T,OAAO,CAAC,0BAA0B,EAAE,CAAC8T,IAAI,EAAEvM,MAAM,CAAC,CAAC;cACzD;YACD,CAAC,CAAC;YACFjK,OAAO,CAACsW,SAAS,CAAC;UACnB,CAAC,CAAC;QACH,CAAC,EAAErW,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASwb,QAAQA,CAAC1b,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM0G,MAAM,GAAGnH,CAAC,CAAC,WAAW,EAAEM,OAAO,CAAC;MACtC,IAAI6G,MAAM,CAACxG,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAAC4U,QAAQ,EAC7B,GAAG/b,KAAK,CAACe,GAAG,CAACC,OAAO,wBAAwB,CAAC,CAACE,IAAI,CAAEC,SAAS,IAAK;YAClE,MAAMkG,QAAQ,GAAG,EAAE;YACnB,IAAIlG,SAAS,EAAE;cACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAC9B,GAAGvH,KAAK,CAACe,GAAG,CAACC,OAAO,yBAAyBhB,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EACnE,UAAU,CAAC,CAAC;YACd;YACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;cACpCgG,MAAM,CAAC9F,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACzB,MACC4E,KAAK,GAAGnG,CAAC,CAACuB,GAAG,CAAC;kBACdC,IAAI,GAAG2E,KAAK,CAAC3E,IAAI,CAAC,CAAC;kBACnBC,cAAc,GAAG;oBAChBwa,SAAS,EAAEza,IAAI,CAAC0a,oBAAoB,IAAI1a,IAAI,CAAC2a,YAAY,IAAI,mBAAmB;oBAChF5O,GAAG,EAAE/L,IAAI,CAAC4a,cAAc,IAAI5a,IAAI,CAAC6a,MAAM,IAAI,kBAAkB;oBAC7DC,cAAc,EAAE9a,IAAI,CAAC+a,yBAAyB,KAAK,KAAK,IAAI/a,IAAI,CAACgb,iBAAiB,KAAK,KAAK;oBAC5FC,eAAe,EAAEjb,IAAI,CAACkb,0BAA0B,IAAIlb,IAAI,CAACmb,kBAAkB,IAAI,EAAE;oBACjFC,WAAW,EAAEpb,IAAI,CAACqb,sBAAsB,IAAIrb,IAAI,CAACsb,cAAc;oBAC/DC,cAAc,EAAEvb,IAAI,CAACwb,yBAAyB,IAAIxb,IAAI,CAACyb,iBAAiB,IAAI,GAAG;oBAC/EC,eAAe,EAAE1b,IAAI,CAAC2b,0BAA0B,IAAI3b,IAAI,CAAC4b,kBAAkB,IAAI,GAAG;oBAClFC,eAAe,EAAE7b,IAAI,CAAC8b,0BAA0B,IAAI9b,IAAI,CAAC+b,kBAAkB,IAAI,SAAS;oBACxFC,SAAS,EAAEhc,IAAI,CAACic,oBAAoB,IAAI,KAAK,IAAIjc,IAAI,CAACkc,YAAY,KAAK,KAAK;oBAC5EC,aAAa,EAAEnc,IAAI,CAACoc,wBAAwB,IAAIpc,IAAI,CAACqc,gBAAgB;oBACrEC,OAAO,EAAE7d,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACuc,kBAAkB,IAAIvc,IAAI,CAACwc,UAAU,CAAC,IAAI,UAAUC,IAAI,EAAEtP,MAAM,EAAEzI,GAAG,EAAE;sBACjHjG,KAAK,CAACW,IAAI,CAAC+O,UAAU,CAAChB,MAAM,CAAC;oBAC9B;kBACD,CAAC;gBACF,IAAInM,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAAC0c,kBAAkB,IAAI1c,IAAI,CAAC+I,UAAU,CAAC;gBACvF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAAC2c,uBAAuB,IAAI3c,IAAI,CAACuB,OAAO,EAC5CC,QAAQ,EAAEmD,KAAK,EAAE3D,QAAQ,CAAC,IAAIA,QAAQ;gBACvC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1BkD,KAAK,CAACjD,OAAO,CAAC,0BAA0B,EAAE,CAACiD,KAAK,EAAE3D,QAAQ,EAAES,IAAI,CAAC,CAAC;gBAClE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGtE,KAAK,CAAC6V,QAAQ,CAACxZ,QAAQ,CAAC;gBACvC2D,KAAK,CAACjD,OAAO,CAAC,yBAAyB,EAAE,CAACiD,KAAK,EAAEsE,MAAM,CAAC,CAAC;cAC1D,CAAC,CAAC;cACFjK,OAAO,CAAC2G,MAAM,CAAC;YAChB,CAAC,CAAC;UACH,CAAC,EAAE1G,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAAS4d,MAAMA,CAAC9d,OAAO,EAAE;IAC/B,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM4d,OAAO,GAAGre,CAAC,CAAC,kBAAkB,EAAEM,OAAO,CAAC;MAC9C,IAAI+d,OAAO,CAAC1d,MAAM,GAAG,CAAC,EAAE;QACvBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACC,MAAM,CAACwd,GAAG,EAC1B,GAAGre,KAAK,CAACe,GAAG,CAACC,OAAO,iBAAiBhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YAEhF,MACCkd,GAAG,GAAGxd,MAAM,CAACwd,GAAG;cAChBC,QAAQ,GAAG,EAAE;YACd,IAAInd,SAAS,EAAE;cACdkd,GAAG,CAACE,MAAM,CAACC,GAAG,CAAC,UAAU,EAAE,GAAGxe,KAAK,CAACe,GAAG,CAACC,OAAO,YAAY,CAAC;cAC5Dsd,QAAQ,CAAChX,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CACjC,GAAG/P,KAAK,CAACe,GAAG,CAACC,OAAO,0BAA0BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAAC;YACvE;YACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEue,QAAQ,CAAC,CAACpd,IAAI,CAAC,MAAM;cACpCkd,OAAO,CAAChd,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBAC1B,MACCmd,QAAQ,GAAG1e,CAAC,CAACuB,GAAG,CAAC;kBACjBod,MAAM,GAAGD,QAAQ,CAAC1P,OAAO,CAAC,SAAS,CAAC;kBACpCxN,IAAI,GAAGkd,QAAQ,CAACld,IAAI,CAAC,CAAC;kBACtBod,QAAQ,GAAGN,GAAG,CAACle,OAAO,CAAC,kBAAkB,CAAC;kBAC1Cye,IAAI,GAAGrd,IAAI,CAACsd,aAAa,IAAItd,IAAI,CAACyD,OAAO,IACxC2Z,QAAQ,CAACG,cAAc,CAACvd,IAAI,CAACwd,iBAAiB,IAAIxd,IAAI,CAACyd,WAAW,IAAI,UAAU,CAAC,CAACJ,IAAI;gBAExF/J,UAAU,CAAC,MAAM;kBAChB;kBACA,MAAMoK,UAAU,GAAGlf,CAAC,CAAC,OAAO,EAAE;oBAC7Bmf,QAAQ,EAAE,UAAU;oBACpBC,KAAK,EAAEV,QAAQ,CAACU,KAAK,CAAC,CAAC;oBACvBC,MAAM,EAAEX,QAAQ,CAACW,MAAM,CAAC,CAAC;oBACzB,OAAO,EAAEX,QAAQ,CAAC5c,IAAI,CAAC,OAAO;kBAC/B,CAAC,CAAC,CAACwd,YAAY,CAACZ,QAAQ,CAAC;kBACzBA,QAAQ,CAACzO,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;kBAC/B;kBACA,MAAMxO,cAAc,GAAG;oBACtBod,IAAI,EAAEA,IAAI;oBACVU,QAAQ,EAAE,MAAM;oBAChBC,OAAO,EAAE,CAAC;oBACVC,WAAW,EAAE,KAAK;oBAClBC,UAAU,EAAE,IAAI;oBAChBC,eAAe,EAAE,IAAI;oBACrBC,WAAW,EAAE,GAAG;oBAChBC,cAAc,EAAE;kBACjB,CAAC;kBACD,IAAIrd,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAACse,gBAAgB,IAAIte,IAAI,CAAC+I,UAAU,CAAC;kBACrF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACue,qBAAqB,IAAIve,IAAI,CAACuB,OAAO,EACrFC,QAAQ,EAAE0b,QAAQ,EAAElc,QAAQ,CAAC,IAAIA,QAAQ;kBAC1C,MAAMS,IAAI,GAAG;oBAACA,IAAI,EAAE;kBAAK,CAAC;kBAC1Byb,QAAQ,CAACxb,OAAO,CAAC,wBAAwB,EAAE,CAACwb,QAAQ,EAAElc,QAAQ,EAAES,IAAI,CAAC,CAAC;kBACtE,IAAIA,IAAI,CAACA,IAAI,EAAE;oBACd;kBACD;kBACA,MAAMmb,MAAM,GAAGE,GAAG,CAAC0B,IAAI,CAACd,UAAU,CAAC,CAAC,CAAC,CAAC;kBACtCd,MAAM,CAAC6B,UAAU,CAACzd,QAAQ,CAAC;kBAC3B,IAAIvC,KAAK,CAACigB,KAAK,KAAK,UAAU,EAAE;oBAC/B9B,MAAM,CAAC+B,QAAQ,CAAC,mBAAmB,CAAC;kBACrC,CAAC,MAAM;oBACN/B,MAAM,CAAC+B,QAAQ,CAAC,oBAAoB,CAAC;kBACtC;kBACA/B,MAAM,CAACgC,OAAO,CAACC,QAAQ,CAAC3B,QAAQ,CAAC7X,GAAG,CAAC,CAAC,CAAC;kBACvC,IAAI6X,QAAQ,CAAC5c,IAAI,CAAC,UAAU,CAAC,EAAE;oBAC9Bsc,MAAM,CAACkC,WAAW,CAAC,IAAI,CAAC;kBACzB;kBACAlC,MAAM,CAACgC,OAAO,CAACpZ,EAAE,CAAC,QAAQ,EAAE,MAAM;oBACjC0X,QAAQ,CAAC7X,GAAG,CAACuX,MAAM,CAACgC,OAAO,CAACG,QAAQ,CAAC,CAAC,CAAC;kBACxC,CAAC,CAAC;kBACF5B,MAAM,CAACnd,IAAI,CAAC,QAAQ,EAAE4c,MAAM,CAAC;kBAC7Bne,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAACgf,0BAA0B,IAAIhf,IAAI,CAACmJ,YAAY,EACpD3H,QAAQ,EAAE0b,QAAQ,EAAEN,MAAM,EAAE5b,QAAQ,CAAC;kBACtCkc,QAAQ,CAACxb,OAAO,CAAC,uBAAuB,EAAE,CAACwb,QAAQ,EAAEN,MAAM,CAAC,CAAC;gBAC9D,CAAC,EAAE,GAAG,CAAC;cACR,CAAC,CAAC;cACF5d,OAAO,CAAC6d,OAAO,CAAC;YACjB,CAAC,CAAC;UACH,CAAC,CAAC;QACH,CAAC,EAAE5d,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASigB,SAASA,CAACngB,OAAO,EAAE;IAClC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM0G,MAAM,GAAGnH,CAAC,CAAC,oBAAoB,EAAEM,OAAO,CAAC;MAC/C,IAAI6G,MAAM,CAACxG,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACC,MAAM,CAAC4f,iBAAiB,EACxC,GAAGzgB,KAAK,CAACe,GAAG,CAACC,OAAO,8BAA8BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAC,MAAM;YACpF2T,UAAU,CAAC,MAAM;cAAG;cACnB3N,MAAM,CAAC9F,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACzB,MACC4E,KAAK,GAAGnG,CAAC,CAACuB,GAAG,CAAC;kBACdof,OAAO,GAAGxa,KAAK,CAACrE,IAAI,CAAC,IAAI,CAAC;kBAC1B8e,aAAa,GAAGD,OAAO,GAAG,IAAIA,OAAO,EAAE,GAAGxa,KAAK,CAACrE,IAAI,CAAC,MAAM,CAAC;kBAC5D+e,IAAI,GAAG7gB,CAAC,CAACuB,GAAG,CAACsf,IAAI,CAAC;kBAClBC,MAAM,GAAGD,IAAI,CAAC/e,IAAI,CAAC,IAAI,CAAC;kBACxBif,YAAY,GAAGD,MAAM,GAAG,IAAIA,MAAM,EAAE,GAAGD,IAAI,CAAC/e,IAAI,CAAC,MAAM,CAAC;kBACxDmB,IAAI,GAAG;oBAACA,IAAI,EAAE;kBAAK,CAAC;gBACrBkD,KAAK,CAACjD,OAAO,CAAC,2BAA2B,EAAE,CAACiD,KAAK,EAAElD,IAAI,CAAC,CAAC;gBACzD,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACAyd,iBAAiB,CAACpV,IAAI,CAACsV,aAAa,EAAEG,YAAY,CAAC;gBACnD5a,KAAK,CAACjD,OAAO,CAAC,0BAA0B,EAAE,CAACiD,KAAK,CAAC,CAAC;cACnD,CAAC,CAAC;cACF3F,OAAO,CAAC2G,MAAM,CAAC;YAChB,CAAC,EAAE,GAAG,CAAC;UACR,CAAC,EAAE1G,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASwgB,aAAaA,CAAC1gB,OAAO,EAAE;IACtC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAMwgB,MAAM,GAAGjhB,CAAC,CAAC,gBAAgB,EAAEM,OAAO,CAAC;MAC3C,IAAI2gB,MAAM,CAACtgB,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAAC4Z,aAAa,EAClC,GAAG/gB,KAAK,CAACe,GAAG,CAACC,OAAO,8BAA8BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YAC7F,MAAMkG,QAAQ,GAAG,EAAE;YACnB,IAAIlG,SAAS,EAAE;cACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAC9B,GAAGvH,KAAK,CAACe,GAAG,CAACC,OAAO,uCAAuChB,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EACjF,eAAe,CAAC,CAAC;YACnB;YACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;cACpC8f,MAAM,CAAC5f,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACzB,MAAM2f,KAAK,GAAGlhB,CAAC,CAACuB,GAAG,CAAC;gBACpB,IAAI2f,KAAK,CAAC1f,IAAI,CAAC,eAAe,CAAC,EAAE;kBAChC,OAAO,CAAE;gBACV;gBACA,MACCA,IAAI,GAAG0f,KAAK,CAAC1f,IAAI,CAAC,CAAC;kBACnB2f,cAAc,GAAG3f,IAAI,CAAC4f,sBAAsB,IAAI5f,IAAI,CAAC6f,SAAS;kBAC9Dxd,MAAM,GAAGsd,cAAc,GAAGD,KAAK,CAAClS,OAAO,CAACmS,cAAc,CAAC,GAAG,MAAM;kBAChE1f,cAAc,GAAG;oBAChB6f,QAAQ,EAAE,IAAI;oBACdhG,OAAO,EAAE,IAAI;oBACbzX,MAAM,EAAEA,MAAM;oBACd0d,EAAE,EAAE/f,IAAI,CAACggB,kBAAkB,IAAIhgB,IAAI,CAACigB,KAAK,IAAI,CAAC;oBAC9CC,EAAE,EAAElgB,IAAI,CAACmgB,kBAAkB,IAAIngB,IAAI,CAACogB,KAAK,IAAI,CAAC;oBAC9CC,EAAE,EAAErgB,IAAI,CAACsgB,kBAAkB,IAAItgB,IAAI,CAACugB,KAAK,IACxCvgB,IAAI,CAACwgB,0BAA0B,IAAIxgB,IAAI,CAACygB,aAAa;oBACtDC,EAAE,EAAE1gB,IAAI,CAAC2gB,kBAAkB,IAAI3gB,IAAI,CAAC4gB,KAAK,IACxC5gB,IAAI,CAAC6gB,2BAA2B,IAAI7gB,IAAI,CAAC8gB,cAAc;oBACxDC,UAAU,EAAE/gB,IAAI,CAACwgB,0BAA0B,IAAIxgB,IAAI,CAACygB,aAAa;oBACjEO,WAAW,EAAEhhB,IAAI,CAAC6gB,2BAA2B,IAAI7gB,IAAI,CAAC8gB,cAAc;oBACpEG,QAAQ,EAAEjhB,IAAI,CAACkhB,0BAA0B,IAAIlhB,IAAI,CAACmhB,aAAa;oBAC/DC,SAAS,EAAEphB,IAAI,CAACqhB,2BAA2B,IAAIrhB,IAAI,CAACshB,cAAc;oBAClEC,QAAQ,EAAE,GAAG;oBACbC,SAAS,EAAE,GAAG;oBACdC,WAAW,EAAEzhB,IAAI,CAAC0hB,2BAA2B,IAAI1hB,IAAI,CAAC2hB,cAAc;oBACpEC,WAAW,EAAEnjB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC6hB,yBAAyB,IAAI7hB,IAAI,CAAC8hB,cAAc,CAAC,IAAI,UAASC,GAAG,EAAEC,SAAS,EAAE;sBAC5H,MAAMpd,MAAM,GAAG5E,IAAI,CAACiiB,2BAA2B,IAAIjiB,IAAI,CAACkiB,cAAc,IAAI,QAAQ;sBAClF1jB,CAAC,CAAC,eAAeoG,MAAM,MAAM,EAAEvC,MAAM,CAAC,CAACgD,GAAG,CAAC2c,SAAS,CAACjC,EAAE,CAAC;sBACxDvhB,CAAC,CAAC,eAAeoG,MAAM,MAAM,EAAEvC,MAAM,CAAC,CAACgD,GAAG,CAAC2c,SAAS,CAAC9B,EAAE,CAAC;sBACxD1hB,CAAC,CAAC,eAAeoG,MAAM,MAAM,EAAEvC,MAAM,CAAC,CAACgD,GAAG,CAAC2c,SAAS,CAAC3B,EAAE,CAAC;sBACxD7hB,CAAC,CAAC,eAAeoG,MAAM,MAAM,EAAEvC,MAAM,CAAC,CAACgD,GAAG,CAAC2c,SAAS,CAACtB,EAAE,CAAC;oBACzD;kBACD,CAAC;gBACF,IAAI1f,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAACmiB,uBAAuB,IAAIniB,IAAI,CAAC+I,UAAU,CAAC;gBAC5F/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACoiB,4BAA4B,IAAIpiB,IAAI,CAACuB,OAAO,EACjDC,QAAQ,EAAEke,KAAK,EAAE1e,QAAQ,CAAC,IAAIA,QAAQ;gBACvC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1Bie,KAAK,CAAChe,OAAO,CAAC,+BAA+B,EAAE,CAACge,KAAK,EAAE1e,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACvE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA;gBACA6R,UAAU,CAAC,MAAM;kBAChB,MAAMrK,MAAM,GAAGyW,KAAK,CAACF,aAAa,CAACxe,QAAQ,CAAC;kBAC5C0e,KAAK,CAAChe,OAAO,CAAC,8BAA8B,EAAE,CAACge,KAAK,EAAEzW,MAAM,CAAC,CAAC;gBAC/D,CAAC,EAAE,GAAG,CAAC;cACR,CAAC,CAAC;cACFjK,OAAO,CAACygB,MAAM,CAAC;YAChB,CAAC,EAAExgB,MAAM,CAAC;UACX,CAAC,EAAEA,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;EACO,SAASqjB,SAASA,CAACvjB,OAAO,EAAE;IAClC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM0G,MAAM,GAAGnH,CAAC,CAAC,wBAAwB,EAAEM,OAAO,CAAC;MACnD,IAAI6G,MAAM,CAACxG,MAAM,GAAG,CAAC,EAAE;QACtBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAAC0c,SAAS,EAC9B,GAAG7jB,KAAK,CAACe,GAAG,CAACC,OAAO,0BAA0BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAC,MAAM;YAChFgG,MAAM,CAAC9F,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;cACzB,MACC4E,KAAK,GAAGnG,CAAC,CAACuB,GAAG,CAAC;gBACdC,IAAI,GAAG2E,KAAK,CAAC3E,IAAI,CAAC,CAAC;cACpB,IAAImB,OAAO;cACX,IAAI,OAAOnB,IAAI,CAACqiB,SAAU,KAAK,QAAQ,EAAE;gBACxClhB,OAAO,GAAGnB,IAAI,CAACqiB,SAAS;cACzB,CAAC,MAAM;gBACNlhB,OAAO,GAAG;kBACTohB,IAAI,EAAEviB,IAAI,CAACqiB,SAAS,CAACG,QAAQ,CAAC;gBAC/B,CAAC;cACF;cACA,IAAIxhB,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEE,OAAO,EAAEnB,IAAI,CAACyiB,mBAAmB,IAAIziB,IAAI,CAAC+I,UAAU,CAAC;cACjF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAAC0iB,wBAAwB,IAAI1iB,IAAI,CAACuB,OAAO,EACxFC,QAAQ,EAAEmD,KAAK,EAAE3D,QAAQ,CAAC,IAAIA,QAAQ;cACvC,MAAMS,IAAI,GAAG;gBAACA,IAAI,EAAE;cAAK,CAAC;cAC1BkD,KAAK,CAACjD,OAAO,CAAC,2BAA2B,EAAE,CAACiD,KAAK,EAAE3D,QAAQ,EAAES,IAAI,CAAC,CAAC;cACnE,IAAIA,IAAI,CAACA,IAAI,EAAE;gBACd;cACD;cACA,MAAMwH,MAAM,GAAGtE,KAAK,CAAC2d,SAAS,CAACthB,QAAQ,CAAC;cACxCvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAAC2iB,6BAA6B,IAAI3iB,IAAI,CAACmJ,YAAY,EACvF3H,QAAQ,EAAEmD,KAAK,EAAEsE,MAAM,EAAEjI,QAAQ,CAAC;cACnC2D,KAAK,CAACjD,OAAO,CAAC,0BAA0B,EAAE,CAACiD,KAAK,EAAEsE,MAAM,CAAC,CAAC;YAC3D,CAAC,CAAC;YACFjK,OAAO,CAAC2G,MAAM,CAAC;UAChB,CAAC,EAAE1G,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEA,MAAM4jB,eAAe,GAAG;IAEvBC,wBAAwB,EAAGle,KAAK,IAAK;MACpC,MAAMme,MAAM,GAAG,EAAE;MACjBne,KAAK,CAACtC,MAAM,CAAC,CAAC,CAAC0gB,IAAI,CAAC,gCAAgC,CAAC,CAACC,QAAQ,CAAC,WAAW,CAAC,CAACnjB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;QAC9F+iB,MAAM,CAAC/c,IAAI,CAACpB,KAAK,CAACqe,QAAQ,CAAC,wBAAwBjjB,GAAG,CAACkjB,KAAK,IAAI,CAAC,CAAC3iB,IAAI,CAAC,OAAO,CAAC,CAAC;MACjF,CAAC,CAAC;MACFqE,KAAK,CAAC3E,IAAI,CAAC,gBAAgB,CAAC,CAACqF,GAAG,CAACyd,MAAM,CAACnW,IAAI,CAAChI,KAAK,CAAC3E,IAAI,CAAC,uBAAuB,CAAC,IAAI,GAAG,CAAC,CAAC;IAC1F,CAAC;IAEDkjB,uBAAuB,EAAEA,CAACC,MAAM,EAAEnjB,IAAI,KAAK;MAC1C,OAAOuR,MAAM,CAAC6R,MAAM,CAAC,CAAC,CAAC,EAAED,MAAM,EAAEnjB,IAAI,CAAC;IACvC;EACD,CAAC;EAEM,SAASqjB,OAAOA,CAACvkB,OAAO,EAAE;IAChC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAMqkB,OAAO,GAAG9kB,CAAC,CAAC,UAAU,EAAEM,OAAO,CAAC;MACtC,IAAIwkB,OAAO,CAACnkB,MAAM,GAAG,CAAC,EAAE;QACvBV,KAAK,CAACG,OAAO,CAAC,MAAM,EAAE,SAAS,CAAC,CAACe,IAAI,CAAC,MAAM;UAC3ClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAACyd,OAAO,EAC5B,GAAG5kB,KAAK,CAACe,GAAG,CAACC,OAAO,yBAAyBhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YACxF,MAAMkG,QAAQ,GAAG,EAAE;YACnB,IAAIlG,SAAS,EAAE;cACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,GAAG/P,KAAK,CAACe,GAAG,CAACC,OAAO,uBAAuBhB,KAAK,CAAC2T,IAAI,CAACH,QAAQ,KAAK,CAAC,CAAC;YACzG;YACAzT,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;cACpC2jB,OAAO,CAACzjB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBAC1B,MACCoR,MAAM,GAAG3S,CAAC,CAACuB,GAAG,CAAC;kBACfC,IAAI,GAAGmR,MAAM,CAACnR,IAAI,CAAC,CAAC;gBACrB,IAAIA,IAAI,CAACqjB,OAAO,EAAE;kBACjB,OAAO,CAAE;gBACV;gBACA,MAAMpjB,cAAc,GAAG;kBACtBye,KAAK,EAAE1e,IAAI,CAACujB,eAAe,IAAIvjB,IAAI,CAACwjB,QAAQ,IAAI,YAAY;kBAC5DvR,QAAQ,EAAEjS,IAAI,CAACyjB,kBAAkB,IAAIzjB,IAAI,CAACmS,WAAW,IAAI1T,KAAK,CAAC2T,IAAI,CAACH,QAAQ;kBAC5EyR,YAAY,EAAEjlB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACzC7G,IAAI,CAAC2jB,sBAAsB,IAAI3jB,IAAI,CAAC4jB,eAAe,CAAC;kBACrDC,OAAO,EAAEplB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACpC7G,IAAI,CAAC8jB,iBAAiB,IAAI9jB,IAAI,CAAC+jB,UAAU,CAAC;kBAC3CC,MAAM,EAAEvlB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACnC7G,IAAI,CAACikB,gBAAgB,IAAIjkB,IAAI,CAACkkB,SAAS,CAAC;kBACzCC,cAAc,EAAE1lB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAC3C7G,IAAI,CAACokB,wBAAwB,IAAIpkB,IAAI,CAACqkB,iBAAiB,CAAC;kBACzDC,iBAAiB,EAAE7lB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAC9C7G,IAAI,CAACukB,2BAA2B,IAAIvkB,IAAI,CAACwkB,oBAAoB,CAAC;kBAC/DC,SAAS,EAAEhmB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACtC7G,IAAI,CAAC0kB,mBAAmB,IAAI1kB,IAAI,CAAC2kB,YAAY;gBAC/C,CAAC;gBACD,MAAMC,OAAO,GAAG5kB,IAAI,CAAC6kB,iBAAiB,IAAI7kB,IAAI,CAAC8kB,UAAU,IAAI9kB,IAAI,CAAC,UAAU,CAAC;gBAC7E,IAAI4kB,OAAO,EAAE;kBACZ;kBACA,IAAIG,gBAAgB;kBACpB,MAAMC,UAAU,GAAGvmB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAC9C7G,IAAI,CAACilB,oBAAoB,IAAIjlB,IAAI,CAACklB,aAAa,IAAIllB,IAAI,CAAC,aAAa,CAAC,CAAC,IACvEA,IAAI,CAACilB,oBAAoB,IAAIjlB,IAAI,CAACklB,aAAa,IAAIllB,IAAI,CAAC,aAAa,CAAC;kBACvE,IAAI,OAAOglB,UAAU,KAAK,UAAU,EAAE;oBACrCD,gBAAgB,GAAGC,UAAU;kBAC9B,CAAC,MAAM,IAAIA,UAAU,EAAE;oBACtBD,gBAAgB,GAAI5B,MAAM,IAAK;sBAC9B,OAAOP,eAAe,CAACM,uBAAuB,CAACC,MAAM,EAAE6B,UAAU,CAAC;oBACnE,CAAC;kBACF;kBACA/kB,cAAc,CAACb,IAAI,GAAG;oBACrB2M,GAAG,EAAEtN,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAChC7G,IAAI,CAAC6kB,iBAAiB,IAAI7kB,IAAI,CAAC8kB,UAAU,CAAC,IAC1C9kB,IAAI,CAAC6kB,iBAAiB,IAAI7kB,IAAI,CAAC8kB,UAAU;oBAC1C9kB,IAAI,EAAE+kB,gBAAgB,IAAItmB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACrD7G,IAAI,CAACmlB,kBAAkB,IAAInlB,IAAI,CAAColB,WAAW,CAAC,IAC5CplB,IAAI,CAACmlB,kBAAkB,IAAInlB,IAAI,CAAColB,WAAW;oBAC5CC,cAAc,EAAE5mB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAC3C7G,IAAI,CAACslB,4BAA4B,IAAItlB,IAAI,CAACulB,qBAAqB,CAAC,IAChEvlB,IAAI,CAACslB,4BAA4B,IAAItlB,IAAI,CAACulB,qBAAqB;oBAChEC,SAAS,EAAE/mB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CACtC7G,IAAI,CAACylB,uBAAuB,IAAIzlB,IAAI,CAAC0lB,gBAAgB,CAAC,IACtD1lB,IAAI,CAACylB,uBAAuB,IAAIzlB,IAAI,CAAC0lB;kBACvC,CAAC;kBACDzlB,cAAc,CAAC0lB,kBAAkB,GAAG3lB,IAAI,CAAC4lB,4BAA4B,IACpE5lB,IAAI,CAAC6lB,qBAAqB,IAAI7lB,IAAI,CAAC2lB,kBAAkB;kBACtD,IAAI1lB,cAAc,CAAC0lB,kBAAkB,KAAK3S,SAAS,EAAE;oBACpD/S,cAAc,CAAC0lB,kBAAkB,GAAG,CAAC;kBACtC;gBACD;gBACA,IAAIxU,MAAM,CAACzO,QAAQ,CAAC,UAAU,CAAC,EAAE;kBAChC;kBACA,MAAMojB,MAAM,GAAGtnB,CAAC,CAAC,8BAA8B2S,MAAM,CAAC7Q,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAACylB,WAAW,CAAC5U,MAAM,CAAC;kBAC3F2U,MAAM,CAACzgB,GAAG,CAAC7G,CAAC,CAAC,iBAAiB,EAAE2S,MAAM,CAAC,CAAC5E,QAAQ,CAAC,OAAO,CAAC,CAACI,IAAI,CAAC3M,IAAI,CAACgmB,mBAAmB,IAAI,GAAG,CAAC,CAAC;kBAChG7U,MAAM,CAACnR,IAAI,CAAC,gBAAgB,EAAE8lB,MAAM,CAAC,CACnCG,UAAU,CAAC,MAAM,CAAC;kBACpBhmB,cAAc,CAACqkB,iBAAiB,GAAItkB,IAAI,IAAK;oBAC5C,MAAMD,GAAG,GAAGvB,CAAC,CAACwB,IAAI,CAAClB,OAAO,CAAC;oBAC3BiB,GAAG,CAACO,IAAI,CAAC,cAAc,EAAEP,GAAG,CAACyE,IAAI,CAAC,CAAC,CAAC;oBACpC,OAAOxE,IAAI,CAACuE,IAAI;kBACjB,CAAC;gBACF;gBACA,IAAIvD,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAACkmB,iBAAiB,IAAIlmB,IAAI,CAAC+I,UAAU,CAAC;gBACtF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACmmB,sBAAsB,IAAInmB,IAAI,CAACuB,OAAO,EAC3CC,QAAQ,EAAE2P,MAAM,EAAEnQ,QAAQ,CAAC,IAAIA,QAAQ;gBACxC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1B0P,MAAM,CAACzP,OAAO,CAAC,yBAAyB,EAAE,CAACyP,MAAM,EAAEnQ,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACnE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAGkI,MAAM,CAACkS,OAAO,CAACriB,QAAQ,CAAC;gBACvCmQ,MAAM,CAAC3L,EAAE,CAAC,wEAAwE,EAAGd,GAAG,IAAK;kBAC5F;kBACA,IAAIlG,CAAC,CAACkG,GAAG,CAACE,MAAM,CAAC,CAACC,EAAE,CAAC,WAAW,CAAC,EAAE;oBAClC,OAAO,KAAK;kBACb;gBACD,CAAC,CAAC;gBACFsM,MAAM,CAAC3L,EAAE,CAAC,iBAAiB,EAAGd,GAAG,IAAK;kBACrC;kBACA,MAAM0hB,KAAK,GAAG5nB,CAAC,CAACkG,GAAG,CAACyQ,aAAa,CAAC,CAAC3H,OAAO,CAAC,QAAQ,CAAC,CAAC6Y,KAAK,CAAC,CAAC;kBAC5D,IAAID,KAAK,CAAC1Z,MAAM,CAAC,CAAC,EAAE;oBACnB,MAAM4Z,MAAM,GAAG5T,QAAQ,CAAC0T,KAAK,CAAC3X,GAAG,CAAC,SAAS,CAAC,CAAC;oBAC7CxF,MAAM,CAACjJ,IAAI,CAAC,SAAS,CAAC,CAACumB,SAAS,CAAC9X,GAAG,CAAC,SAAS,EAAE6X,MAAM,GAAG,CAAC,CAAC;kBAC5D;gBACD,CAAC,CAAC;gBACFnV,MAAM,CAAC3L,EAAE,CAAC,cAAc,EAAE,MAAM;kBAC/B;kBACA8N,UAAU,CAAC,MAAM;oBAChB,MAAMkT,QAAQ,GAAGhoB,CAAC,CAAC,wBAAwB,EAAEyK,MAAM,CAACjJ,IAAI,CAAC,SAAS,CAAC,CAACumB,SAAS,CAAC;oBAC9E,IAAIC,QAAQ,CAAC9Z,MAAM,CAAC,CAAC,EAAE;sBACtB8Z,QAAQ,CAAC/Y,GAAG,CAAC,CAAC,CAAC,CAACgZ,KAAK,CAAC,CAAC;oBACxB;kBACD,CAAC,EAAE,EAAE,CAAC;gBACP,CAAC,CAAC;gBACF,IAAItV,MAAM,CAACzO,QAAQ,CAAC,UAAU,CAAC,EAAE;kBAChCjE,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAACmN,QAAQ,EAC7B,GAAGtU,KAAK,CAACe,GAAG,CAACC,OAAO,mBAAmBhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAC,MAAM;oBACzEwR,MAAM,CAAC9O,MAAM,CAAC,CAAC,CAAC0gB,IAAI,CAAC,gCAAgC,CAAC,CAAChQ,QAAQ,CAAC;sBAC/DgD,WAAW,EAAE,QAAQ;sBACrB2Q,MAAM,EAAEA,CAAA,KAAM;wBACb9D,eAAe,CAACC,wBAAwB,CAAC1R,MAAM,CAAC;sBACjD;oBACD,CAAC,CAAC;oBACFA,MAAM,CAAC3L,EAAE,CAAC,iCAAiC,EAAGd,GAAG,IAAK;sBACrD,MACCiiB,EAAE,GAAGjiB,GAAG,CAACye,MAAM,CAACnjB,IAAI,CAAC2mB,EAAE;wBACvB/hB,MAAM,GAAGpG,CAAC,CAACkG,GAAG,CAACyQ,aAAa,CAAC;wBAC7ByR,MAAM,GAAGhiB,MAAM,CAACoe,QAAQ,CAAC,iBAAiB2D,EAAE,IAAI,CAAC;sBAClDloB,KAAK,CAACooB,OAAO,CAACC,sBAAsB,CAACF,MAAM,CAAC;sBAC5ChiB,MAAM,CAAClD,OAAO,CAAC,QAAQ,CAAC;sBACxBkhB,eAAe,CAACC,wBAAwB,CAACje,MAAM,CAAC;oBACjD,CAAC,CAAC;kBACH,CAAC,CAAC;gBACH;gBACAnG,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAAC+mB,2BAA2B,IAAI/mB,IAAI,CAACmJ,YAAY,EACrD3H,QAAQ,EAAE2P,MAAM,EAAElI,MAAM,EAAEjI,QAAQ,CAAC;gBACpCmQ,MAAM,CAACzP,OAAO,CAAC,wBAAwB,EAAE,CAACyP,MAAM,EAAElI,MAAM,CAAC,CAAC;cAC3D,CAAC,CAAC;cACFjK,OAAO,CAACskB,OAAO,CAAC;YACjB,CAAC,EAAErkB,MAAM,CAAC;UACX,CAAC,EAAEA,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASgoB,SAASA,CAACloB,OAAO,EAAE;IAClC,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;MAC/B,MAAMioB,IAAI,GAAGzoB,CAAC,CAAC,gBAAgB,EAAEM,OAAO,CAAC;MACzC,IAAImoB,IAAI,CAAC9nB,MAAM,GAAG,CAAC,EAAE;QACpB8nB,IAAI,CAACpnB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;UACvB,MACCmnB,SAAS,GAAG1oB,CAAC,CAACuB,GAAG,CAAC;YAClBonB,GAAG,GAAG3oB,CAAC,CAAC,KAAK,EAAE0oB,SAAS,CAAC;YACzBtJ,KAAK,GAAGuJ,GAAG,CAAC7mB,IAAI,CAAC,OAAO,CAAC;YACzBud,MAAM,GAAGsJ,GAAG,CAAC7mB,IAAI,CAAC,QAAQ,CAAC;UAC5B,IAAIsd,KAAK,IAAIC,MAAM,EAAE;YACpB9d,GAAG,CAACqnB,YAAY,CAAC,SAAS,EACzB,OAAOC,IAAI,CAACC,KAAK,CAAC1c,UAAU,CAACgT,KAAK,CAAC,CAAC,IAAIyJ,IAAI,CAACC,KAAK,CAAC1c,UAAU,CAACiT,MAAM,CAAC,CAAC,EAAE,CAAC;UAC3E;UACAsJ,GAAG,CAAC7mB,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAACA,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC;QACjD,CAAC,CAAC;QACFtB,OAAO,CAACioB,IAAI,CAAC;MACd,CAAC,MAAM;QACNjoB,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;AACA;AACA;AACA;;EAEO,SAASuoB,QAAQA,CAACzoB,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAEC,OAAO,IAAK;MAC/B,MAAMwoB,SAAS,GAAGhpB,CAAC,CAAC,iBAAiB,EAAEM,OAAO,CAAC;MAC/C,IAAI0oB,SAAS,CAACroB,MAAM,GAAG,CAAC,EAAE;QACzBqoB,SAAS,CAAC3nB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;UAC5B,MACCmC,MAAM,GAAG1D,CAAC,CAACuB,GAAG,CAAC;YACfqC,QAAQ,GAAGF,MAAM,CAACG,MAAM,CAAC,UAAU,CAAC;YACpCrC,IAAI,GAAGkC,MAAM,CAAClC,IAAI,CAAC,CAAC;YACpBsC,KAAK,GAAGtC,IAAI,CAACynB,gBAAgB,IAAIznB,IAAI,CAACwC,QAAQ;YAC9CklB,UAAU,GAAG1nB,IAAI,CAAC2nB,qBAAqB,IAAI3nB,IAAI,CAAC4nB,aAAa,IAAI,cAAc;YAC/EC,SAAS,GAAG7nB,IAAI,CAAC8nB,oBAAoB,IAAI9nB,IAAI,CAAC+nB,YAAY,IAAI,eAAe;UAC9E,IAAI,CAAC/nB,IAAI,CAACgoB,WAAW,EAAE;YACtB,MAAMvmB,IAAI,GAAG;cAACA,IAAI,EAAE;YAAK,CAAC;YAC1BS,MAAM,CAACR,OAAO,CAAC,0BAA0B,EAAE,CAACQ,MAAM,EAAElC,IAAI,EAAEyB,IAAI,CAAC,CAAC;YAChE,IAAIA,IAAI,CAACA,IAAI,EAAE;cACd;YACD;YACAjD,CAAC,CAAC,yBAAyB8D,KAAK,KAAK,MAAM,GAAGolB,UAAU,GAAGG,SAAS,aAAa,CAAC,CAChFI,SAAS,CAAC/lB,MAAM,CAAC;YACnBA,MAAM,CAACsD,EAAE,CAAC,OAAO,EAAGd,GAAG,IAAK;cAC3BA,GAAG,CAACwjB,cAAc,CAAC,CAAC;cACpB,MAAMzmB,IAAI,GAAG,CAAC,CAAC;cACfS,MAAM,CAACR,OAAO,CAAC,4BAA4B,EAAE,CAACQ,MAAM,EAAET,IAAI,CAAC,CAAC;cAC5D,IAAIA,IAAI,CAACA,IAAI,EAAE;gBACd;cACD;cACA,IAAIW,QAAQ,CAACM,QAAQ,CAAC,UAAU,CAAC,EAAE;gBAClCN,QAAQ,CAACgD,WAAW,CAAC,UAAU,CAAC;gBAChC3G,KAAK,CAAC2C,IAAI,CAAC+mB,UAAU,CAAC3pB,CAAC,CAAC,GAAG,EAAE0D,MAAM,CAAC,EAAE2lB,SAAS,EAAEH,UAAU,CAAC;gBAC5DxlB,MAAM,CAACR,OAAO,CAAC,qBAAqB,EAAE,CAACQ,MAAM,CAAC,CAAC;gBAC/C,MAAMykB,EAAE,GAAGzkB,MAAM,CAAC5B,IAAI,CAAC,IAAI,CAAC;gBAC5B,IAAIqmB,EAAE,EAAE;kBACPnoB,CAAC,CAAC,2CAA2CmoB,EAAE,IAAI,EAAEvkB,QAAQ,CAAC,CAACvC,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;oBACjF,MAAMwnB,QAAQ,GAAG/oB,CAAC,CAACuB,GAAG,CAAC;oBACvB,IAAIwnB,QAAQ,CAAC/Z,OAAO,CAAC,UAAU,CAAC,CAAC9K,QAAQ,CAAC,UAAU,CAAC,EAAE;sBACtD6kB,QAAQ,CAAC9hB,KAAK,CAAC,CAAC;oBACjB;kBACD,CAAC,CAAC;gBACH;cACD,CAAC,MAAM;gBACNrD,QAAQ,CAACkD,QAAQ,CAAC,UAAU,CAAC;gBAC7B7G,KAAK,CAAC2C,IAAI,CAAC+mB,UAAU,CAAC3pB,CAAC,CAAC,GAAG,EAAE0D,MAAM,CAAC,EAAEwlB,UAAU,EAAEG,SAAS,CAAC;gBAC5D3lB,MAAM,CAACR,OAAO,CAAC,qBAAqB,EAAE,CAACQ,MAAM,CAAC,CAAC;cAChD;YACD,CAAC,CAAC;YACF,IAAII,KAAK,KAAK,MAAM,EAAE;cACrBF,QAAQ,CAACkD,QAAQ,CAAC,UAAU,CAAC;YAC9B;YACApD,MAAM,CAACR,OAAO,CAAC,yBAAyB,EAAE,CAACQ,MAAM,CAAC,CAAC;YACnDA,MAAM,CAAClC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC;UAClC;QACD,CAAC,CAAC;QACFhB,OAAO,CAACwoB,SAAS,CAAC;MACnB,CAAC,MAAM;QACNxoB,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAASopB,OAAOA,CAACtpB,OAAO,EAAE;IAChC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM4d,OAAO,GAAGre,CAAC,CAAC,UAAU,EAAEM,OAAO,CAAC;MACtC,IAAI+d,OAAO,CAAC1d,MAAM,GAAG,CAAC,EAAE;QACvBV,KAAK,CAACG,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UACxC,MAAMF,OAAO,GAAG,GAAGhB,KAAK,CAACe,GAAG,CAACC,OAAO,iBAAiBhB,KAAK,CAACe,GAAG,CAAC6oB,OAAO,GAAG,MAAM,GAAE,EAAE,EAAE;UACrF5pB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACC,MAAM,CAAC8oB,OAAO,EAC9B,GAAG3oB,OAAO,WAAWhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YAChE,MAAMmd,QAAQ,GAAG,EAAE;YACnB,IAAInd,SAAS,EAAE;cACdwoB,OAAO,CAAC3oB,OAAO,GAAGA,OAAO;cACzB2oB,OAAO,CAACE,MAAM,GAAG7pB,KAAK,CAACe,GAAG,CAACE,MAAM;cACjCqd,QAAQ,CAAChX,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,GAAG/O,OAAO,wBAAwB,CAAC,CAAC;cACvEsd,QAAQ,CAAChX,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,GAAG/O,OAAO,uBAAuBhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAAC;cAC3F;cACAlB,CAAC,CAACgD,QAAQ,CAAC,CAACgE,EAAE,CAAC,SAAS,EAAGd,GAAG,IAAK;gBAClC,IAAIlG,CAAC,CAACkG,GAAG,CAACE,MAAM,CAAC,CAACW,OAAO,CAAC,kCAAkC,GAC3D,wCAAwC,CAAC,CAACpG,MAAM,EAAE;kBAClDuF,GAAG,CAAC6jB,wBAAwB,CAAC,CAAC;gBAC/B;cACD,CAAC,CAAC;cACF;cACA/pB,CAAC,CAACgD,QAAQ,CAAC,CAACgE,EAAE,CAAC,mBAAmB,EAAE,CAACd,GAAG,EAAEjD,IAAI,EAAE3C,OAAO,KAAK;gBAC3DN,CAAC,CAAC,UAAU,EAAEM,OAAO,CAAC,CAACe,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;kBACzC,MACCyoB,QAAQ,GAAGhqB,CAAC,CAACuB,GAAG,CAAC,CAACO,IAAI,CAAC,IAAI,CAAC;oBAC5Bsc,MAAM,GAAGtd,MAAM,CAAC8oB,OAAO,CAAC3a,GAAG,CAAC+a,QAAQ,CAAC;kBACtC,IAAI5L,MAAM,KAAK,IAAI,EAAE;oBACpBA,MAAM,CAAC6L,MAAM,CAAC,CAAC;kBAChB;gBACD,CAAC,CAAC;cACH,CAAC,CAAC;YACH;YACAjqB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEue,QAAQ,CAAC,CAACpd,IAAI,CAAC,MAAM;cACpCkd,OAAO,CAAChd,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBAC1B,MACC6c,MAAM,GAAGpe,CAAC,CAACuB,GAAG,CAAC;kBACfC,IAAI,GAAG4c,MAAM,CAAC5c,IAAI,CAAC,CAAC;kBACpBC,cAAc,GAAG;oBAChByoB,QAAQ,EAAE,YAAY9L,MAAM,CAACtc,IAAI,CAAC,IAAI,CAAC,EAAE;oBACzCqoB,QAAQ,EAAElpB,OAAO;oBACjBif,KAAK,EAAE1e,IAAI,CAAC4oB,eAAe,IAAI5oB,IAAI,CAACwjB,QAAQ,IAAI,QAAQ;oBACxDvR,QAAQ,EAAExT,KAAK,CAAC2T,IAAI,CAACH,QAAQ;oBAC7B4W,OAAO,EAAG7oB,IAAI,CAAC8oB,iBAAiB,KAAK,KAAK,IAAM9oB,IAAI,CAAC+oB,UAAU,KAAK,KAAM;oBAC1EC,SAAS,EAAGhpB,IAAI,CAACipB,mBAAmB,KAAK,KAAK,IAAMjpB,IAAI,CAACkpB,YAAY,KAAK,KAAM;oBAChFhpB,OAAO,EAAEF,IAAI,CAACmpB,iBAAiB,IAAInpB,IAAI,CAACopB,UAAU,IAAI,CACrD,gFAAgF,EAChF,kEAAkE,EAClE,kEAAkE,EAClE,8DAA8D,CAC9D;oBACDC,OAAO,EAAErpB,IAAI,CAACspB,iBAAiB,IAAItpB,IAAI,CAACupB,UAAU;oBAClDC,QAAQ,EAAIxpB,IAAI,CAACypB,kBAAkB,KAAK,KAAK,IAAMzpB,IAAI,CAAC0pB,WAAW,KAAK,KAAM,GAAI,KAAK,GACtF1pB,IAAI,CAACypB,kBAAkB,IAAIzpB,IAAI,CAAC0pB,WAAW,IAC3C,sDAAsD,GACtD,kDAAkD,GAClD,gCAAgC;oBACjCC,QAAQ,EAAI3pB,IAAI,CAAC4pB,kBAAkB,KAAK,KAAK,IAAM5pB,IAAI,CAAC6pB,WAAW,KAAK,KAAM,GAAI,KAAK,GACtF7pB,IAAI,CAAC4pB,kBAAkB,IAAI5pB,IAAI,CAAC6pB,WAAW,IAC3C,6DAA6D,GAC7D,iCAAiC;oBAClCC,WAAW,EAAE9pB,IAAI,CAAC+pB,oBAAoB,IAAI/pB,IAAI,CAACgqB,aAAa;oBAC5DC,OAAO,EAAEjqB,IAAI,CAACkqB,iBAAiB,IAAIlqB,IAAI,CAACmqB,UAAU;oBAClDC,aAAa,EAAEpqB,IAAI,CAACqqB,sBAAsB,IAAIrqB,IAAI,CAACsqB,eAAe;oBAClEC,aAAa,EAAEvqB,IAAI,CAACwqB,sBAAsB,IAAIxqB,IAAI,CAACyqB,eAAe;oBAClEC,aAAa,EAAE1qB,IAAI,CAAC2qB,sBAAsB,IAAI3qB,IAAI,CAAC4qB,eAAe;oBAClEC,aAAa,EAAE,KAAK;oBACpBC,kBAAkB,EAAE,KAAK;oBACzBC,YAAY,EAAE,KAAK;oBACnBC,YAAY,EAAE,IAAI;oBAClBC,UAAU,EAAExsB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACkrB,mBAAmB,IAAIlrB,IAAI,CAACmrB,YAAY,CAAC,IACtFnrB,IAAI,CAACkrB,mBAAmB,IAAIlrB,IAAI,CAACmrB,YAAY;oBAC9CC,gBAAgB,EAAEprB,IAAI,CAACqrB,wBAAwB,IAAIrrB,IAAI,CAACsrB,iBAAiB;oBACzEC,SAAS,EAAE9sB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACwrB,kBAAkB,IAAIxrB,IAAI,CAACyrB,WAAW,CAAC,IACnFzrB,IAAI,CAACwrB,kBAAkB,IAAIxrB,IAAI,CAACyrB,WAAW;oBAC5CC,eAAe,EAAE1rB,IAAI,CAAC2rB,uBAAuB,IAAI3rB,IAAI,CAAC4rB,gBAAgB;oBACtEC,aAAa,EAAI7rB,IAAI,CAAC8rB,qBAAqB,KAAK9Y,SAAS,IAAMhT,IAAI,CAAC+rB,cAAc,KAAK/Y,SAAU,GAChG,IAAI,GAAGhT,IAAI,CAAC8rB,qBAAqB,IAAI9rB,IAAI,CAAC+rB,cAAc;oBACzDC,2BAA2B,EAAIhsB,IAAI,CAACisB,0BAA0B,KAAKjZ,SAAS,IAAMhT,IAAI,CAACksB,mBAAmB,KAAKlZ,SAAU,GACxH,IAAI,GAAGhT,IAAI,CAACisB,0BAA0B,IAAIjsB,IAAI,CAACksB,mBAAmB;oBACnEC,4BAA4B,EAAEnsB,IAAI,CAACosB,mCAAmC,IAAIpsB,IAAI,CAACqsB,4BAA4B,IAAI,KAAK;oBACpHC,kBAAkB,EAAItsB,IAAI,CAACusB,0BAA0B,KAAKvZ,SAAS,IAAMhT,IAAI,CAACwsB,mBAAmB,KAAKxZ,SAAU,GAC/G,IAAI,GAAGhT,IAAI,CAACusB,0BAA0B,IAAIvsB,IAAI,CAACwsB,mBAAmB;oBACnEC,mBAAmB,EAAIzsB,IAAI,CAAC0sB,2BAA2B,KAAK1Z,SAAS,IAAMhT,IAAI,CAAC2sB,oBAAoB,KAAK3Z,SAAU,GAClH,IAAI,GAAGhT,IAAI,CAAC0sB,2BAA2B,IAAI1sB,IAAI,CAAC2sB,oBAAoB;oBACrE9O,MAAM,EAAE7d,IAAI,CAAC4sB,gBAAgB,IAAI5sB,IAAI,CAAC6sB,SAAS,IAAI,EAAE;oBACrDC,UAAU,EAAE,EAAE;oBACd7S,MAAM,EAAE,IAAI;oBACZ8S,qBAAqB,EAAE,EAAE;oBACzBC,qBAAqB,EAAE;kBACxB,CAAC;gBACF,MAAM9sB,OAAO,GAAGF,IAAI,CAACitB,yBAAyB,IAAIjtB,IAAI,CAACktB,kBAAkB;gBACzE,IAAIhtB,OAAO,EAAE;kBACZ,MAAMitB,KAAK,GAAGjtB,OAAO,CAAC+K,KAAK,CAAC,KAAK,CAAC;kBAClC,KAAK,MAAMqG,IAAI,IAAI6b,KAAK,EAAE;oBACzB,MAAMC,GAAG,GAAGxQ,MAAM,CAAC5c,IAAI,CAAC,sBAAsBsR,IAAI,EAAE,CAAC,IAAIsL,MAAM,CAAC5c,IAAI,CAAC,cAAcsR,IAAI,EAAE,CAAC;oBAC1FhS,MAAM,CAAC8oB,OAAO,CAACiF,aAAa,CAACC,IAAI,CAAChc,IAAI,EAAE7S,KAAK,CAAC2C,IAAI,CAACmsB,SAAS,CAACH,GAAG,CAAC,CAAC;kBACnE;gBACD;gBACA,IAAIpsB,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEhB,cAAc,EAAED,IAAI,CAACwtB,iBAAiB,IAAIxtB,IAAI,CAAC+I,UAAU,CAAC;gBACtF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC1CrB,IAAI,CAACytB,sBAAsB,IAAIztB,IAAI,CAACuB,OAAO,EAC3CC,QAAQ,EAAEob,MAAM,EAAE5b,QAAQ,CAAC,IAAIA,QAAQ;gBACxC,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1Bmb,MAAM,CAAClb,OAAO,CAAC,yBAAyB,EAAE,CAACkb,MAAM,EAAE5b,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACnE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA6R,UAAU,CAAC,MAAM;kBAChB,MAAMrK,MAAM,GAAG2T,MAAM,CAACwL,OAAO,CAACpnB,QAAQ,CAAC;kBACvCvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAC/BrB,IAAI,CAAC0tB,2BAA2B,IAAI1tB,IAAI,CAACmJ,YAAY,EACrD3H,QAAQ,EAAEob,MAAM,EAAE3T,MAAM,EAAEjI,QAAQ,CAAC;kBACpC4b,MAAM,CAAClb,OAAO,CAAC,wBAAwB,EAAE,CAACkb,MAAM,EAAE5b,QAAQ,CAAC,CAAC;gBAC7D,CAAC,EAAE,GAAG,CAAC;cACR,CAAC,CAAC;cACFhC,OAAO,CAAC6d,OAAO,CAAC;YACjB,CAAC,EAAE5d,MAAM,CAAC;UACX,CAAC,EAAEA,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAAS2uB,QAAQA,CAAC7uB,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM2uB,KAAK,GAAGpvB,CAAC,CAAC,WAAW,EAAEM,OAAO,CAAC;MACrC,IAAI8uB,KAAK,CAACzuB,MAAM,GAAG,CAAC,EAAE;QACrBV,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UAChClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAACioB,OAAO,EAC5B,GAAGpvB,KAAK,CAACe,GAAG,CAACC,OAAO,4BAA4BhB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YAC3F,MAAMkG,QAAQ,GAAG,EAAE;YACnB,IAAIlG,SAAS,EAAE;cACdkG,QAAQ,CAACC,IAAI,CAACtH,KAAK,CAAC2C,IAAI,CAAC4E,MAAM,CAAC,GAAGvH,KAAK,CAACe,GAAG,CAACC,OAAO,mCAAmChB,KAAK,CAACe,GAAG,CAACE,MAAM,MAAM,EAC5G,UAAU,CAAC,CAAC;YACd;YACAlB,CAAC,CAACyH,IAAI,CAACC,KAAK,CAAC1H,CAAC,EAAEsH,QAAQ,CAAC,CAACnG,IAAI,CAAC,MAAM;cACpCiuB,KAAK,CAAC/tB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACxB,MACC4tB,QAAQ,GAAGnvB,CAAC,CAACuB,GAAG,CAAC;kBACjBC,IAAI,GAAG2tB,QAAQ,CAAC3tB,IAAI,CAAC,CAAC;kBACtBmG,WAAW,GAAG;oBACbnG,IAAI,EAAEA,IAAI,CAAC8tB,eAAe;oBAC1BC,MAAM,EAAE/tB,IAAI,CAACguB,iBAAiB;oBAC9BC,WAAW,EAAEjuB,IAAI,CAACkuB,sBAAsB;oBACxCC,UAAU,EAAEnuB,IAAI,CAACouB,qBAAqB,IAAI,0BAA0B;oBACpEC,YAAY,EAAEruB,IAAI,CAACsuB,uBAAuB,IAAI,2BAA2B;oBACzEC,SAAS,EAAEvuB,IAAI,CAACwuB,oBAAoB;oBACpCC,QAAQ,EAAEzuB,IAAI,CAAC0uB,mBAAmB;oBAClCC,YAAY,EAAE3uB,IAAI,CAAC4uB,uBAAuB;oBAC1CC,WAAW,EAAE7uB,IAAI,CAAC8uB,sBAAsB,IAAI,2BAA2B;oBACvEC,aAAa,EAAE/uB,IAAI,CAACgvB,wBAAwB,IAAI,qBAAqB;oBACrEC,KAAK,EAAEjvB,IAAI,CAACkvB,gBAAgB;oBAC5BC,SAAS,EAAEnvB,IAAI,CAACovB,oBAAoB;oBACpCC,WAAW,EAAErvB,IAAI,CAACsvB,sBAAsB;oBACxCC,YAAY,EAAEvvB,IAAI,CAACwvB,qBAAqB;oBACxCC,aAAa,EAAEzvB,IAAI,CAAC0vB,wBAAwB;oBAC5CC,iBAAiB,EAAE3vB,IAAI,CAAC4vB,4BAA4B;oBACpDC,iBAAiB,EAAE7vB,IAAI,CAAC8vB,4BAA4B,IAAI,kBAAkB;oBAC1EC,qBAAqB,EAAE/vB,IAAI,CAACgwB,gCAAgC,IAAI,kBAAkB;oBAClFC,WAAW,EAAEjwB,IAAI,CAACkwB,sBAAsB;oBACxCC,iBAAiB,EAAEnwB,IAAI,CAACowB,4BAA4B;oBACpDC,sBAAsB,EAAErwB,IAAI,CAACswB,iCAAiC;oBAC9DC,UAAU,EAAEvwB,IAAI,CAACwwB,qBAAqB;oBACtCC,QAAQ,EAAEzwB,IAAI,CAAC0wB,mBAAmB;oBAClCC,YAAY,EAAE3wB,IAAI,CAAC4wB,uBAAuB;oBAC1CC,QAAQ,EAAE7wB,IAAI,CAAC8wB,mBAAmB;oBAClCC,kBAAkB,EAAE/wB,IAAI,CAACgxB,6BAA6B;oBACtDC,WAAW,EAAEjxB,IAAI,CAACkxB,sBAAsB;oBACxCC,aAAa,EAAE1yB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACoxB,sBAAsB,CAAC;oBACxEC,eAAe,EAAE5yB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACsxB,wBAAwB,CAAC;oBAC5EC,cAAc,EAAE9yB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACwxB,uBAAuB,CAAC;oBAC1EC,aAAa,EAAEhzB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC0xB,sBAAsB,CAAC;oBACxEC,cAAc,EAAElzB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC4xB,uBAAuB,CAAC;oBAC1EC,cAAc,EAAEpzB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC8xB,uBAAuB,CAAC;oBAC1EC,eAAe,EAAEtzB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACgyB,wBAAwB,CAAC;oBAC5EC,gBAAgB,EAAExzB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACkyB,yBAAyB,CAAC;oBAC9EC,gBAAgB,EAAE1zB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACoyB,yBAAyB,CAAC;oBAC9EC,eAAe,EAAE5zB,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAACsyB,wBAAwB;kBAC5E,CAAC;gBACF,IAAItxB,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEkF,WAAW,EAAEnG,IAAI,CAACuyB,kBAAkB,CAAC;gBACjEvxB,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACwyB,uBAAuB,IAAIxyB,IAAI,CAACuB,OAAO,EACvFC,QAAQ,EAAEmsB,QAAQ,EAAE3sB,QAAQ,CAAC,IAAIA,QAAQ;gBAC1C,MAAMS,IAAI,GAAG;kBAACA,IAAI,EAAE;gBAAK,CAAC;gBAC1BksB,QAAQ,CAACjsB,OAAO,CAAC,0BAA0B,EAAE,CAACisB,QAAQ,EAAE3sB,QAAQ,EAAES,IAAI,CAAC,CAAC;gBACxE,IAAIA,IAAI,CAACA,IAAI,EAAE;kBACd;gBACD;gBACA,MAAMwH,MAAM,GAAG0kB,QAAQ,CAACA,QAAQ,CAAC3sB,QAAQ,CAAC;gBAC1CvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACyyB,4BAA4B,IAAIzyB,IAAI,CAACmJ,YAAY,EACtF3H,QAAQ,EAAEmsB,QAAQ,EAAE1kB,MAAM,EAAEjI,QAAQ,CAAC;gBACtC2sB,QAAQ,CAACjsB,OAAO,CAAC,yBAAyB,EAAE,CAACisB,QAAQ,EAAE1kB,MAAM,CAAC,CAAC;cAChE,CAAC,CAAC;cACFjK,OAAO,CAAC4uB,KAAK,CAAC;YACf,CAAC,EAAE3uB,MAAM,CAAC;UACX,CAAC,EAAEA,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX,CAAC,MAAM;QACND,OAAO,CAAC,IAAI,CAAC;MACd;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEO,SAAS0zB,QAAQA,CAAC5zB,OAAO,EAAE;IACjC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACvC,MAAM0zB,KAAK,GAAGn0B,CAAC,CAAC,wBAAwB,EAAEM,OAAO,CAAC;MAClD,IAAI6zB,KAAK,CAACxzB,MAAM,GAAG,CAAC,EAAE;QACrBV,KAAK,CAACG,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;UACxClB,KAAK,CAACW,IAAI,CAACC,KAAK,CAACb,CAAC,CAACoH,EAAE,CAAC8sB,QAAQ,EAC7B,GAAGj0B,KAAK,CAACe,GAAG,CAACC,OAAO,kCAAkChB,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAEC,SAAS,IAAK;YACjG,IAAIA,SAAS,IAAKnB,KAAK,CAAC2T,IAAI,CAACH,QAAQ,KAAK,IAAK,EAAE;cAChDxT,KAAK,CAAC2C,IAAI,CAACoN,SAAS,CAAC,GAAG/P,KAAK,CAACe,GAAG,CAACC,OAAO,iCAAiChB,KAAK,CAAC2T,IAAI,CAACH,QAAQ,GAAGxT,KAAK,CAACe,GAAG,CAACE,MAAM,KAAK,CAAC,CAACC,IAAI,CAAC,MAAM,CAClI,CAAC,CAAC;YACH;YACAgzB,KAAK,CAAC9yB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;cACxB,MACCsf,IAAI,GAAG7gB,CAAC,CAACuB,GAAG,CAAC;gBACbC,IAAI,GAAGqf,IAAI,CAACrf,IAAI,CAAC,CAAC;gBAClBmG,WAAW,GAAG;kBACbysB,MAAM,EAAE,IAAI;kBACZC,cAAc,EAAEp0B,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC8yB,yBAAyB,CAAC,KAC3E,CAACpuB,GAAG,EAAEquB,SAAS,KAAK;oBACnB;oBACAv0B,CAAC,CAAC,iBAAiB,EAAE6gB,IAAI,CAAC,CAACoJ,MAAM,CAAC,CAAC;oBACnCjqB,CAAC,CAAC,aAAa,EAAE6gB,IAAI,CAAC,CAACja,WAAW,CAAC,YAAY,CAAC;oBAChD,KAAK,MAAM4tB,KAAK,IAAID,SAAS,CAACE,SAAS,EAAE;sBACxC,MACCn0B,OAAO,GAAGN,CAAC,CAACw0B,KAAK,CAACl0B,OAAO,CAAC;wBAC1Bo0B,MAAM,GAAGp0B,OAAO,CAAC0O,OAAO,CAAC,WAAW,CAAC;wBACrC2lB,SAAS,GAAGr0B,OAAO,CAAC0O,OAAO,CAAC,mBAAmB,CAAC;sBACjD2lB,SAAS,CAACtzB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;wBAC5BvB,CAAC,CAAC,iBAAiB,EAAEuB,GAAG,CAAC,CAAC0F,KAAK,CAAC,CAAC;sBAClC,CAAC,CAAC;sBACFytB,MAAM,CAACrzB,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;wBACzB,MACCqzB,KAAK,GAAG50B,CAAC,CAACuB,GAAG,CAAC;0BACdszB,IAAI,GAAGD,KAAK,CAAC5lB,OAAO,CAAC,cAAc,CAAC,CAClCrI,QAAQ,CAAC,WAAW,CAAC;wBACxB3G,CAAC,CAAC,gBAAgB40B,KAAK,CAACE,KAAK,CAAC,CAAC,GAAG,CAAC,GAAG,EAAED,IAAI,CAAC,CAC3C/tB,QAAQ,CAAC,YAAY,CAAC;wBACxB9G,CAAC,CAAC,uBAAuB,EAAE60B,IAAI,CAAC,CAC9B5tB,KAAK,CAAC,CAAC;sBACV,CAAC,CAAC;oBACH;kBACD,CAAC,CACD;kBACD8tB,YAAY,EAAEvzB,IAAI,CAACwzB,uBAAuB,IAAI,MAAM;kBACpDC,UAAU,EAAEzzB,IAAI,CAAC0zB,qBAAqB,IAAI,YAAY;kBACtDC,cAAc,EAAEl1B,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC4zB,yBAAyB,CAAC,KAC1E,CAACZ,KAAK,EAAEl0B,OAAO,KAAK;oBACpBk0B,KAAK,CAAC1tB,QAAQ,CAAC,kBAAkB,CAAC;oBAClCxG,OAAO,CAACyG,OAAO,CAAC,cAAc,CAAC,CAACsuB,MAAM,CAACb,KAAK,CAAC;kBAC9C,CAAC,CAAC;kBACHc,aAAa,EAAEr1B,KAAK,CAAC2C,IAAI,CAACyF,iBAAiB,CAAC7G,IAAI,CAAC+zB,wBAAwB,CAAC,KACxE1U,IAAI,CAAC/e,IAAI,CAAC,YAAY,CAAC,KAAK0S,SAAS,GACrC,MAAM;oBACLvU,KAAK,CAACG,OAAO,CAAC,MAAM,CAAC,CAACe,IAAI,CAAC,MAAM;sBAChClB,KAAK,CAAC4gB,IAAI,CAAC2U,MAAM,CAAC3U,IAAI,CAAC;oBACxB,CAAC,CAAC;kBACH,CAAC,GACC,MAAM;oBACPA,IAAI,CAAC5R,GAAG,CAAC,CAAC,CAAC,CAACumB,MAAM,CAAC,CAAC;kBACrB,CAAC;gBACJ,CAAC;cACFx1B,CAAC,CAAC,2BAA2B,EAAE6gB,IAAI,CAAC,CAACxf,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBACvD,IAAID,GAAG,KAAK,CAAC,EAAE;kBACdqG,WAAW,CAAC8tB,KAAK,GAAG,CAAC,CAAC;gBACvB;gBACA9tB,WAAW,CAAC8tB,KAAK,CAACz1B,CAAC,CAACuB,GAAG,CAAC,CAACO,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG9B,CAAC,CAACuB,GAAG,CAAC,CAACC,IAAI,CAAC,oBAAoB,CAAC;cAC3E,CAAC,CAAC;cACFxB,CAAC,CAAC,8BAA8B,EAAE6gB,IAAI,CAAC,CAACxf,IAAI,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;gBAC1D,IAAID,GAAG,KAAK,CAAC,EAAE;kBACdqG,WAAW,CAAC+tB,QAAQ,GAAG,CAAC,CAAC;gBAC1B;gBACA/tB,WAAW,CAAC+tB,QAAQ,CAAC11B,CAAC,CAACuB,GAAG,CAAC,CAACO,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG9B,CAAC,CAACuB,GAAG,CAAC,CAACC,IAAI,CAAC,uBAAuB,CAAC;cACjF,CAAC,CAAC;cACF,IAAIgB,QAAQ,GAAGxC,CAAC,CAACyC,MAAM,CAAC,CAAC,CAAC,EAAEkF,WAAW,EAAEnG,IAAI,CAACm0B,kBAAkB,IAAIn0B,IAAI,CAAC+I,UAAU,CAAC;cACpF/H,QAAQ,GAAGvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACo0B,uBAAuB,IACvEp0B,IAAI,CAACuB,OAAO,EAAEC,QAAQ,EAAE6d,IAAI,EAAEre,QAAQ,CAAC,IAAIA,QAAQ;cACpD,MAAMS,IAAI,GAAG;gBAACA,IAAI,EAAE;cAAK,CAAC;cAC1B4d,IAAI,CAAC3d,OAAO,CAAC,0BAA0B,EAAE,CAAC2d,IAAI,EAAEre,QAAQ,EAAES,IAAI,CAAC,CAAC;cAChE,IAAIA,IAAI,CAACA,IAAI,EAAE;gBACd;cACD;cACA,MAAMwH,MAAM,GAAGoW,IAAI,CAACqT,QAAQ,CAAC1xB,QAAQ,CAAC;cACtCvC,KAAK,CAAC2C,IAAI,CAACC,qBAAqB,CAACrB,IAAI,CAACq0B,4BAA4B,IACjEr0B,IAAI,CAACmJ,YAAY,EAAE3H,QAAQ,EAAE6d,IAAI,EAAEpW,MAAM,EAAEjI,QAAQ,CAAC;cACrDqe,IAAI,CAAC3d,OAAO,CAAC,yBAAyB,EAAE,CAAC2d,IAAI,EAAEpW,MAAM,CAAC,CAAC;YACxD,CAAC,CAAC;YACFjK,OAAO,CAAC2zB,KAAK,CAAC;UACf,CAAC,EAAE1zB,MAAM,CAAC;QACX,CAAC,EAAEA,MAAM,CAAC;MACX;IACD,CAAC,CAAC;EACH;;EAGA;AACA;AACA;;EAEA,IAAIK,MAAM,CAACb,KAAK,EAAE;IAEjB;IACAA,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC11B,QAAQ,EAAE,UAAU,CAAC;IAC7CJ,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACvyB,OAAO,EAAE,SAAS,CAAC;IAC3CvD,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC7uB,WAAW,EAAE,aAAa,CAAC;IACnDjH,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACnrB,WAAW,EAAE,aAAa,CAAC;IACnD3K,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACnmB,UAAU,EAAE,YAAY,CAAC;IACjD3P,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACvgB,QAAQ,EAAE,UAAU,CAAC;IAC7CvV,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAClf,QAAQ,EAAE,UAAU,CAAC;IAC7C5W,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC/Z,QAAQ,EAAE,UAAU,CAAC;IAC7C/b,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC3X,MAAM,EAAE,QAAQ,CAAC;IACzCne,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACtV,SAAS,EAAE,WAAW,CAAC;IAC/CxgB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC/U,aAAa,EAAE,eAAe,CAAC;IACvD/gB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAClS,SAAS,EAAE,WAAW,CAAC;IAC/C5jB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAClR,OAAO,EAAE,SAAS,CAAC;IAC3C5kB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACvN,SAAS,EAAE,KAAK,CAAC;IACzCvoB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAChN,QAAQ,EAAE,UAAU,CAAC;IAC7C9oB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAACnM,OAAO,EAAE,SAAS,CAAC;IAC3C3pB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC5G,QAAQ,EAAE,UAAU,CAAC;IAC7ClvB,KAAK,CAAC61B,QAAQ,CAACC,QAAQ,CAAC7B,QAAQ,EAAE,UAAU,CAAC;;IAE7C;IACAj0B,KAAK,CAACue,MAAM,CAACwX,OAAO,CAACzuB,IAAI,CAAC,SAAS,CAAC;IACpC,IAAI,CAACtH,KAAK,CAACe,GAAG,CAACi1B,MAAM,EAAE;MACtBC,OAAO,CAACC,KAAK,CAAC,iCAAiC,CAAC;IACjD;EACD;AAAC","ignoreList":[]}