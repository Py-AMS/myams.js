{"version":3,"sources":["mod-plugins.js"],"names":["$","MyAMS","templates","jsrender","require","CHECKER_TEMPLATE_STRING","CHECKER_TEMPLATE","markup","checker","element","each","idx","elt","legend","data","amsChecker","fieldset","parent","checked","hasClass","amsCheckerState","fieldName","amsCheckerFieldname","core","generateId","fieldId","replace","prefix","amsCheckerHiddenPrefix","marker","amsCheckerMarker","checkerMode","amsCheckerMode","checkedValue","amsCheckerValueOn","uncheckedValue","amsCheckerValueOff","props","text","value","amsCheckerValue","readonly","amsCheckerReadonly","state","veto","trigger","html","render","change","evt","input","target","is","prop","executeFunctionByName","amsCheckerChangeHandler","document","amsCheckerCancelDefault","siblings","removeClass","val","addClass","closest","on","click","contextMenu","menus","length","then","menu","options","menuSelector","amsContextmenuSelector","amsMenuSelector","settings","extend","amsContextmenuOptions","amsOptions","amsContextmenuInitCallback","amsInit","plugin","amsContextmenuAfterInitCallback","amsAfterInit","draggable","draggables","ajax","check","fn","env","baseURL","extext","defaultOptions","cursor","amsDraggableCursor","containment","amsDraggableContainment","handle","amsDraggableHandle","connectToSortable","amsDraggableConnectSortable","helper","getFunctionByName","amsDraggableHelper","start","amsDraggableStart","stop","amsDraggableStop","amsDraggableOptions","amsDraggableInitCallback","disableSelection","amsDraggableAfterInitCallback","droppable","droppables","accept","amsDroppableAccept","drop","amsDroppableDrop","amsDroppableOptions","amsDroppableInitCallback","amsDroppableAfterInitCallback","fileInput","inputs","window","bsCustomFileInput","inputId","attr","inputSelector","form","formId","formSelector","init","_select2Helpers","select2UpdateHiddenField","values","find","children","push","title","join","select2","selects","firstLoad","required","getScript","i18n","language","getCSS","when","apply","select","theme","amsSelect2Theme","hidden","insertAfter","listattr","amsSelect2Separator","removeAttr","templateSelection","amsSelect2Options","amsSelect2InitCallback","modal","currentTarget","parents","first","exists","zIndex","parseInt","css","$dropdown","sortable","update","id","params","option","helpers","moveElementToParentEnd","amsSelect2AfterInitCallback","svgPlugin","svgs","container","svg","width","height","setAttribute","Math","round","parseFloat","switcher","minusClass","amsSwitcherMinusClass","amsMinusClass","plusClass","amsSwitcherPlusClass","amsPlusClass","amsSwitcher","amsSwitcherState","prependTo","preventDefault","switchIcon","validate","forms","dataOptions","ignore","invalidHandler","amsValidateInvalidHandler","validator","remove","errorList","error","panels","fieldsets","panel","tabs","index","errorElement","amsValidateErrorElement","errorClass","amsValidateErrorClass","errorPlacement","amsvalidateErrorPlacement","append","submitHandler","amsValidateSubmitHandler","undefined","submit","get","rules","messages","amsValidateOptions","amsValidateInitCallback","amsValidateAfterInitCallback","registry","register","config","modules","bundle","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS, bsCustomFileInput */\n/**\n * MyAMS standard plugins\n */\n\nconst $ = MyAMS.$;\n\nif (!$.templates) {\n\tconst jsrender = require('jsrender');\n\t$.templates = jsrender.templates;\n}\n\n\n/**\n * Fieldset checker plug-in\n * A checker is like a simple switcher, but also provides a checkbox which is used\n * as \"switcher\" input field.\n * The \"checker\" class is applied to the fieldset legend; checkbox is created automatically\n * by the plug-in.\n * Check options are given as data attributes, all prefixed with \"ams-checker-\":\n *  - state: is 'off' by default; can be set to 'on' to automatically activate the checker\n *  - mode: is 'hide' by default, which make the fieldset hidden when the checker is not activated;\n *    you cna set it to \"disable\" to make fieldset content visible but disabled when the checker\n *    is not activated\n *  - fieldname: is the name of the input checkbox created by the plug-in\n *  - value: this is the \"checked\" value of the main checkbox field\n *  - readonly: if \"true\", the checkbox is disabled and in read-only mode\n *  - hidden-prefix: if not null, this is a prefix which will be assigned to an additional\n *    hidden input field, updated automatically when the checker is switched; the name of the\n *    hidden input if made of this prefix, followed by the \"fieldname\" value\n *  - value-on: this is the \"checked\" value of the hidden input; \"true\" by default\n *  - value-off: this is the \"unchecked\" value of the hidden input; \"false\" by default\n *  - marker: if not null, another hidden input with a fixed value of 1 will be created; the name\n *    of this input will be the \"fieldname\" value followed by this \"marker\" value\n *  - change-handler: this optional handler will be called on checker switch\n *  - cancel-default: if \"true\", the default behaviour will not be executed on checker switch\n */\n\nconst CHECKER_TEMPLATE_STRING = `\n\t<span class=\"custom-control custom-switch\">\n\t\t<input type=\"checkbox\"\n\t\t\t   id=\"{{: fieldId }}\" name=\"{{: fieldName }}\"\n\t\t\t   class=\"custom-control-input checker\"\n\t\t\t   {{if checked}}checked{{/if}}\n\t\t\t   {{if readonly}}disabled{{/if}}\n\t\t\t   value=\"{{: value }}\" />\n\t\t{{if prefix}}\n\t\t<input type=\"hidden\" class=\"prefix\"\n\t\t\t   id=\"{{: prefix}}{{: fieldName}}_prefix\"\n\t\t\t   name=\"{{: prefix}}{{: fieldName}}\"\n\t\t\t   value=\"{{if state==='on'}}{{: checkedValue}}{{else}}{{: uncheckedValue}}{{/if}}\" />\n\t\t{{else marker}}\n\t\t<input type=\"hidden\" class=\"marker\"\n\t\t\t   name=\"{{: fieldName}}{{: marker}}\"\n\t\t\t   value=\"1\" />\n\t\t{{/if}}\n\t\t<label for=\"{{: fieldId }}\"\n\t\t\t   class=\"custom-control-label\">\n\t\t\t{{: legend }}\n\t\t</label>\n\t</span>\n`;\n\nconst CHECKER_TEMPLATE = $.templates({\n\tmarkup: CHECKER_TEMPLATE_STRING\n});\n\nexport function checker(element) {\n\t$('legend.checker', element).each((idx, elt) => {\n\t\tconst\n\t\t\tlegend = $(elt),\n\t\t\tdata = legend.data();\n\t\tif (!data.amsChecker) {\n\t\t\tconst\n\t\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\t\tchecked = fieldset.hasClass('switched') || (data.amsCheckerState === 'on'),\n\t\t\t\tfieldName = data.amsCheckerFieldname || `checker_${MyAMS.core.generateId()}`,\n\t\t\t\tfieldId = fieldName.replace(/\\./g, '_'),\n\t\t\t\tprefix = data.amsCheckerHiddenPrefix,\n\t\t\t\tmarker = data.amsCheckerMarker || false,\n\t\t\t\tcheckerMode = data.amsCheckerMode || 'hide',\n\t\t\t\tcheckedValue = data.amsCheckerValueOn || 'true',\n\t\t\t\tuncheckedValue = data.amsCheckerValueOff || 'false',\n\t\t\t\tprops = {\n\t\t\t\t\tlegend: legend.text(),\n\t\t\t\t\tfieldName: fieldName,\n\t\t\t\t\tfieldId: fieldId,\n\t\t\t\t\tvalue: data.amsCheckerValue || true,\n\t\t\t\t\tchecked: checked,\n\t\t\t\t\treadonly: data.amsCheckerReadonly,\n\t\t\t\t\tprefix: prefix,\n\t\t\t\t\tstate: data.amsCheckerState,\n\t\t\t\t\tcheckedValue: checkedValue,\n\t\t\t\t\tuncheckedValue: uncheckedValue,\n\t\t\t\t\tmarker: marker\n\t\t\t\t},\n\t\t\t\tveto = { veto: false };\n\t\t\tlegend.trigger('before-init.ams.checker', [legend, props, veto]);\n\t\t\tif (veto.veto) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlegend.html(CHECKER_TEMPLATE.render(props));\n\t\t\t$('input', legend).change((evt) => {\n\t\t\t\tconst\n\t\t\t\t\tinput = $(evt.target),\n\t\t\t\t\tchecked = input.is(':checked'),\n\t\t\t\t\tveto = { veto: false };\n\t\t\t\tlegend.trigger('before-switch.ams.checker', [legend, veto]);\n\t\t\t\tif (veto.veto) {\n\t\t\t\t\tinput.prop('checked', !checked);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tMyAMS.core.executeFunctionByName(data.amsCheckerChangeHandler,\n\t\t\t\t\tdocument, legend, checked);\n\t\t\t\tif (!data.amsCheckerCancelDefault) {\n\t\t\t\t\tconst prefix = input.siblings('.prefix');\n\t\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\t\t\tprefix.val(checkedValue);\n\t\t\t\t\t\t\tlegend.trigger('opened.ams.checker', [legend]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\t\t\tprefix.val(uncheckedValue);\n\t\t\t\t\t\t\tlegend.trigger('closed.ams.checker', [legend]);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfieldset.prop('disabled', !checked);\n\t\t\t\t\t\tprefix.val(checked ? checkedValue : uncheckedValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tlegend.closest('form').on('reset', () => {\n\t\t\t\tconst checker = $('.checker', legend);\n\t\t\t\tif (checker.prop('checked') !== checked) {\n\t\t\t\t\tchecker.click();\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!checked) {\n\t\t\t\tif (checkerMode === 'hide') {\n\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t} else {\n\t\t\t\t\tfieldset.prop('disabled', true);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlegend.trigger('after-init.ams.checker', [legend]);\n\t\t\tlegend.data('ams-checker', true);\n\t\t}\n\t});\n}\n\n\n/**\n * Context menu plug-in\n */\n\nexport function contextMenu(element) {\n\tconst menus = $('.context-menu', element);\n\tif (menus.length > 0) {\n\t\tMyAMS.require('menu').then(() => {\n\t\t\tmenus.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tmenu = $(elt),\n\t\t\t\t\tdata = menu.data(),\n\t\t\t\t\toptions = {\n\t\t\t\t\t\tmenuSelector: data.amsContextmenuSelector || data.amsMenuSelector\n\t\t\t\t\t};\n\t\t\t\tlet settings = $.extend({}, options, data.amsContextmenuOptions || data.amsOptions);\n\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\tdata.amsContextmenuInitCallback || data.amsInit,\n\t\t\t\t\tdocument, menu, settings) || settings;\n\t\t\t\tconst veto = { veto: false };\n\t\t\t\tmenu.trigger('before-init.ams.contextmenu', [menu, settings, veto]);\n\t\t\t\tif (veto.veto) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst plugin = menu.contextMenu(settings);\n\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\tdata.amsContextmenuAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\tdocument, menu, plugin, settings);\n\t\t\t\tmenu.trigger('after-init.ams.contextmenu', [menu, plugin]);\n\t\t\t});\n\t\t});\n\t}\n}\n\n\n/**\n * JQuery-UI draggable plug-in\n */\n\nexport function draggable(element) {\n\tconst draggables = $('.draggable', element);\n\tif (draggables.length > 0) {\n\t\tMyAMS.ajax.check($.fn.draggable,\n\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\tdraggables.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tdraggable = $(elt),\n\t\t\t\t\tdata = draggable.data(),\n\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\tcursor: data.amsDraggableCursor || 'move',\n\t\t\t\t\t\tcontainment: data.amsDraggableContainment,\n\t\t\t\t\t\thandle: data.amsDraggableHandle,\n\t\t\t\t\t\tconnectToSortable: data.amsDraggableConnectSortable,\n\t\t\t\t\t\thelper: MyAMS.core.getFunctionByName(data.amsDraggableHelper) || data.amsDraggableHelper,\n\t\t\t\t\t\tstart: MyAMS.core.getFunctionByName(data.amsDraggableStart),\n\t\t\t\t\t\tstop: MyAMS.core.getFunctionByName(data.amsDraggableStop)\n\t\t\t\t\t};\n\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsDraggableOptions || data.amsOptions);\n\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\tdata.amsDraggableInitCallback || data.amsInit,\n\t\t\t\t\tdocument, draggable, settings) || settings;\n\t\t\t\tconst veto = { veto: false };\n\t\t\t\tdraggable.trigger('before-init.ams.draggable', [draggable, settings, veto]);\n\t\t\t\tif (veto.veto) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst plugin = draggable.draggable(settings);\n\t\t\t\tdraggable.disableSelection();\n\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\tdata.amsDraggableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\tdocument, draggable, plugin, settings);\n\t\t\t\tdraggable.trigger('after-init.ams.draggable', [draggable, plugin]);\n\t\t\t});\n\t\t});\n\t}\n}\n\n\n/**\n * JQuery-ui droppable plug-in\n */\n\nexport function droppable(element) {\n\tconst droppables = $('.droppable', element);\n\tif (droppables.length > 0) {\n\t\tMyAMS.ajax.check($.fn.droppable,\n\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\tdroppables.each((idx, elt) => {\n\t\t\t\tconst\n\t\t\t\t\tdroppable = $(elt),\n\t\t\t\t\tdata = droppable.data(),\n\t\t\t\t\tdefaultOptions = {\n\t\t\t\t\t\taccept: data.amsDroppableAccept,\n\t\t\t\t\t\tdrop: MyAMS.core.getFunctionByName(data.amsDroppableDrop)\n\t\t\t\t\t};\n\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsDroppableOptions || data.amsOptions);\n\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\tdata.amsDroppableInitCallback || data.amsInit,\n\t\t\t\t\tdocument, droppable, settings) || settings;\n\t\t\t\tconst veto = { veto: false };\n\t\t\t\tdroppable.trigger('before-init.ams.droppable', [droppable, settings, veto]);\n\t\t\t\tif (veto.veto) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst plugin = droppable.droppable(settings);\n\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\tdata.amsDroppableAfterInitCallback || data.amsAfterInit,\n\t\t\t\t\tdocument, droppable, plugin, settings);\n\t\t\t\tdroppable.trigger('after-init.ams.droppable', [droppable, plugin]);\n\t\t\t});\n\t\t});\n\t}\n}\n\n\n/**\n * Bootstrap custom file input manager\n */\n\nexport function fileInput(element) {\n\tconst inputs = $('.custom-file-input', element);\n\tif (inputs.length > 0) {\n\t\tMyAMS.require('ajax').then(() => {\n\t\t\tMyAMS.ajax.check(window.bsCustomFileInput,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/bs-custom-file-input${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\tinputs.each((idx, elt) => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tinput = $(elt),\n\t\t\t\t\t\tinputId = input.attr('id'),\n\t\t\t\t\t\tinputSelector = inputId ? `#${inputId}` : input.attr('name'),\n\t\t\t\t\t\tform = $(elt.form),\n\t\t\t\t\t\tformId = form.attr('id'),\n\t\t\t\t\t\tformSelector = formId ? `#${formId}` : form.attr('name'),\n\t\t\t\t\t\tveto = { veto: false };\n\t\t\t\t\tinput.trigger('before-init.ams.fileinput', [input, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbsCustomFileInput.init(inputSelector, formSelector);\n\t\t\t\t\tinput.trigger('after-init.ams.fileinput', [input]);\n\t\t\t\t});\n\t\t\t});\n\t\t})\n\t}\n}\n\n\n/**\n * Select2 plug-in integration\n */\n\nconst _select2Helpers = {\n\n\tselect2UpdateHiddenField: function(input) {\n\t\tconst values = [];\n\t\tinput.parent().find('ul.select2-selection__rendered').children('li[title]').each((idx, elt) => {\n\t\t\tvalues.push(input.children(`option[data-content=\"${elt.title}\"]`).attr('value'));\n\t\t});\n\t\tinput.data('select2-target').val(values.join(input.data('ams-select2-separator') || ','));\n\t}\n};\n\nexport function select2(element) {\n\tconst selects = $('.select2', element);\n\tif (selects.length > 0) {\n\t\tMyAMS.require('ajax', 'helpers').then(() => {\n\t\t\tMyAMS.ajax.check($.fn.select2,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/select2/select2${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\tconst required = [];\n\t\t\t\tif (firstLoad) {\n\t\t\t\t\trequired.push(MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/select2/i18n/${MyAMS.i18n.language}.js`));\n\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/select2${MyAMS.env.extext}.css`, 'select2'));\n\t\t\t\t\trequired.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/select2-bootstrap4${MyAMS.env.extext}.css`, 'select2_bs4'));\n\t\t\t\t}\n\t\t\t\t$.when.apply($, required).then(() => {\n\t\t\t\t\tselects.each((idx, elt) => {\n\t\t\t\t\t\tconst\n\t\t\t\t\t\t\tselect = $(elt),\n\t\t\t\t\t\t\tdata = select.data();\n\t\t\t\t\t\tif (data.select2) {\n\t\t\t\t\t\t\treturn;  // already initialized\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst defaultOptions = {\n\t\t\t\t\t\t\ttheme: data.amsSelect2Theme || 'bootstrap4',\n\t\t\t\t\t\t\tlanguage: MyAMS.i18n.language\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\t// create hidden input for sortable selections\n\t\t\t\t\t\t\tconst hidden = $(`<input type=\"hidden\" name=\"${select.attr('name')}\">`).insertAfter(select);\n\t\t\t\t\t\t\thidden.val($('option:selected', select).listattr('value').join(data.amsSelect2Separator || ','));\n\t\t\t\t\t\t\tselect.data('select2-target', hidden)\n\t\t\t\t\t\t\t\t.removeAttr('name');\n\t\t\t\t\t\t\tdefaultOptions.templateSelection = (data) => {\n\t\t\t\t\t\t\t\tconst elt = $(data.element);\n\t\t\t\t\t\t\t\telt.attr('data-content', elt.html());\n\t\t\t\t\t\t\t\treturn data.text;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet settings = $.extend({}, defaultOptions, data.amsSelect2Options || data.amsOptions);\n\t\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\tdata.amsSelect2InitCallback || data.amsInit,\n\t\t\t\t\t\t\tdocument, select, settings) || settings;\n\t\t\t\t\t\tconst veto = { veto: false };\n\t\t\t\t\t\tselect.trigger('before-init.ams.select2', [select, settings, veto]);\n\t\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst plugin = select.select2(settings);\n\t\t\t\t\t\tselect.on('select2:opening select2:selecting select2:unselecting select2:clearing', (evt) => {\n\t\t\t\t\t\t\tif ($(evt.target).is(':disabled')) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tselect.on('select2:opening', (evt) => {\n\t\t\t\t\t\t\tconst modal = $(evt.currentTarget).parents('.modal').first();\n\t\t\t\t\t\t\tif (modal.exists()) {\n\t\t\t\t\t\t\t\tconst zIndex = parseInt(modal.css('z-index'));\n\t\t\t\t\t\t\t\tplugin.data('select2').$dropdown.css('z-index', zIndex + 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (select.hasClass('sortable')) {\n\t\t\t\t\t\t\tMyAMS.ajax.check($.fn.sortable,\n\t\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t\t\tselect.parent().find('ul.select2-selection__rendered').sortable({\n\t\t\t\t\t\t\t\t\tcontainment: 'parent',\n\t\t\t\t\t\t\t\t\tupdate: () => {\n\t\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(select);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tselect.on('select2:select select2:unselect', (evt) => {\n\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\tid = evt.params.data.id,\n\t\t\t\t\t\t\t\t\t\ttarget = $(evt.currentTarget),\n\t\t\t\t\t\t\t\t\t\toption = target.children(`option[value=\"${id}\"]`);\n\t\t\t\t\t\t\t\t\tMyAMS.helpers.moveElementToParentEnd(option);\n\t\t\t\t\t\t\t\t\ttarget.trigger('change');\n\t\t\t\t\t\t\t\t\t_select2Helpers.select2UpdateHiddenField(target);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tMyAMS.core.executeFunctionByName(\n\t\t\t\t\t\t\tdata.amsSelect2AfterInitCallback || data.amsAfterInit,\n\t\t\t\t\t\t\tdocument, select, plugin, settings);\n\t\t\t\t\t\tselect.trigger('after-init.ams.select2', [select, plugin]);\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t})\n\t\t});\n\t}\n}\n\n\n/**\n * SVG image plug-in\n */\n\nexport function svgPlugin(element) {\n\tconst svgs = $('.svg-container', element);\n\tif (svgs.length > 0) {\n\t\tsvgs.each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tcontainer = $(elt),\n\t\t\t\tsvg = $('svg', container),\n\t\t\t\twidth = svg.attr('width'),\n\t\t\t\theight = svg.attr('height');\n\t\t\tif (width && height) {\n\t\t\t\telt.setAttribute('viewBox',\n\t\t\t\t\t`0 0 ${Math.round(parseFloat(width))} ${Math.round(parseFloat(height))}`);\n\t\t\t}\n\t\t\tsvg.attr('width', '100%').attr('height', 'auto');\n\t\t});\n\t}\n}\n\n\n/**\n * Fieldset switcher plug-in\n */\n\nexport function switcher(element) {\n\t$('legend.switcher', element).each((idx, elt) => {\n\t\tconst\n\t\t\tlegend = $(elt),\n\t\t\tfieldset = legend.parent('fieldset'),\n\t\t\tdata = legend.data(),\n\t\t\tminusClass = data.amsSwitcherMinusClass || data.amsMinusClass || 'minus',\n\t\t\tplusClass = data.amsSwitcherPlusClass || data.amsPlusClass || 'plus';\n\t\tif (!data.amsSwitcher) {\n\t\t\tconst veto = { veto: false };\n\t\t\tlegend.trigger('before-init.ams.switcher', [legend, data, veto]);\n\t\t\tif (veto.veto) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$(`<i class=\"fa fa-${data.amsSwitcherState === 'open' ? minusClass : plusClass} mr-2\"></i>`)\n\t\t\t\t.prependTo(legend);\n\t\t\tlegend.on('click', (evt) => {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tconst veto = {};\n\t\t\t\tlegend.trigger('before-switch.ams.switcher', [legend, veto]);\n\t\t\t\tif (veto.veto) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (fieldset.hasClass('switched')) {\n\t\t\t\t\tfieldset.removeClass('switched');\n\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), plusClass, minusClass);\n\t\t\t\t\tlegend.trigger('opened.ams.switcher', [legend]);\n\t\t\t\t\tconst id = legend.attr('id');\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\t$(`legend.switcher[data-ams-switcher-sync=\"${id}\"]`, fieldset).each((idx, elt) => {\n\t\t\t\t\t\t\tconst switcher = $(elt);\n\t\t\t\t\t\t\tif (switcher.parents('fieldset').hasClass('switched')) {\n\t\t\t\t\t\t\t\tswitcher.click();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfieldset.addClass('switched');\n\t\t\t\t\tMyAMS.core.switchIcon($('i', legend), minusClass, plusClass);\n\t\t\t\t\tlegend.trigger('closed.ams.switcher', [legend]);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (data.amsSwitcherState !== 'open') {\n\t\t\t\tfieldset.addClass('switched');\n\t\t\t}\n\t\t\tlegend.trigger('after-init.ams.switcher', [legend]);\n\t\t\tlegend.data('ams-switcher', true);\n\t\t}\n\t});\n}\n\n\n/**\n * Form validation plug-in\n */\n\nexport function validate(element) {\n\tconst forms = $('form:not([novalidate])', element);\n\tif (forms.length > 0) {\n\t\tMyAMS.require('ajax', 'i18n').then(() => {\n\t\t\tMyAMS.ajax.check($.fn.validate,\n\t\t\t\t`${MyAMS.env.baseURL}../ext/validate/jquery-validate${MyAMS.env.extext}.js`).then((firstLoad) => {\n\t\t\t\tif (firstLoad && (MyAMS.i18n.language !== 'en')) {\n\t\t\t\t\tMyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/validate/i18n/messages_${MyAMS.i18n.language}${MyAMS.env.extext}.js`).then(() => {});\n\t\t\t\t}\n\t\t\t\tforms.each((idx, elt) => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tform = $(elt),\n\t\t\t\t\t\tdata = form.data(),\n\t\t\t\t\t\tdataOptions = {\n\t\t\t\t\t\t\tignore: null,\n\t\t\t\t\t\t\tinvalidHandler: MyAMS.core.getFunctionByName(data.amsValidateInvalidHandler) || (\n\t\t\t\t\t\t\t\t(evt, validator) => {\n\t\t\t\t\t\t\t\t\t// automatically display hidden fields with errors!\n\t\t\t\t\t\t\t\t\t$('span.is-invalid', form).remove();\n\t\t\t\t\t\t\t\t\t$('.is-invalid', form).removeClass('is-invalid');\n\t\t\t\t\t\t\t\t\tfor (const error of validator.errorList) {\n\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\telement = $(error.element),\n\t\t\t\t\t\t\t\t\t\t\tpanels = element.parents('.tab-pane'),\n\t\t\t\t\t\t\t\t\t\t\tfieldsets = element.parents('fieldset.switched');\n\t\t\t\t\t\t\t\t\t\tfieldsets.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\t$('legend.switcher', elt).click();\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tpanels.each((idx, elt) => {\n\t\t\t\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\t\t\t\tpanel = $(elt),\n\t\t\t\t\t\t\t\t\t\t\t\ttabs = panel.parents('.tab-content')\n\t\t\t\t\t\t\t\t\t\t\t\t\t.siblings('.nav-tabs');\n\t\t\t\t\t\t\t\t\t\t\t$(`li:nth-child(${panel.index()+1})`, tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t.addClass('is-invalid');\n\t\t\t\t\t\t\t\t\t\t\t$('li.is-invalid:first a', tabs)\n\t\t\t\t\t\t\t\t\t\t\t\t.click();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\terrorElement: data.amsValidateErrorElement || 'span',\n\t\t\t\t\t\t\terrorClass: data.amsValidateErrorClass || 'is-invalid',\n\t\t\t\t\t\t\terrorPlacement: MyAMS.core.getFunctionByName(data.amsvalidateErrorPlacement) ||\n\t\t\t\t\t\t\t\t((error, element) => {\n\t\t\t\t\t\t\t\t\terror.addClass('invalid-feedback');\n\t\t\t\t\t\t\t\t\telement.closest('.form-widget').append(error);\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tsubmitHandler: MyAMS.core.getFunctionByName(data.amsValidateSubmitHandler) ||\n\t\t\t\t\t\t\t\t(form.attr('data-async') !== undefined ?\n\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\tMyAMS.require('form').then(() => {\n\t\t\t\t\t\t\t\t\t\t\tMyAMS.form.submit(form);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: () => {\n\t\t\t\t\t\t\t\t\t\tform.get(0).submit();\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t};\n\t\t\t\t\t$('[data-ams-validate-rules]', form).each((idx, elt) => {\n\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\tdataOptions.rules = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdataOptions.rules[$(elt).attr('name')] = $(elt).data('ams-validate-rules');\n\t\t\t\t\t});\n\t\t\t\t\t$('[data-ams-validate-messages]', form).each((idx, elt) => {\n\t\t\t\t\t\tif (idx === 0) {\n\t\t\t\t\t\t\tdataOptions.messages = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdataOptions.messages[$(elt).attr('name')] = $(elt).data('ams-validate-messages');\n\t\t\t\t\t});\n\t\t\t\t\tlet settings = $.extend({}, dataOptions, data.amsValidateOptions || data.amsOptions);\n\t\t\t\t\tsettings = MyAMS.core.executeFunctionByName(data.amsValidateInitCallback ||\n\t\t\t\t\t\tdata.amsInit, document, form, settings) || settings;\n\t\t\t\t\tconst veto = { veto: false };\n\t\t\t\t\tform.trigger('before-init.ams.validate', [form, settings, veto]);\n\t\t\t\t\tif (veto.veto) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst plugin = form.validate(settings);\n\t\t\t\t\tMyAMS.core.executeFunctionByName(data.amsValidateAfterInitCallback ||\n\t\t\t\t\t\tdata.amsAfterInit, document, form, plugin, settings);\n\t\t\t\t\tform.trigger('after-init.ams.validate', [form, plugin]);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n}\n\n\n/**\n * Global module initialization\n */\n\nif (window.MyAMS) {\n\n\t// register loaded plug-ins\n\tMyAMS.registry.register(checker, 'checker');\n\tMyAMS.registry.register(contextMenu, 'contextMenu');\n\tMyAMS.registry.register(draggable, 'draggable');\n\tMyAMS.registry.register(droppable, 'droppable');\n\tMyAMS.registry.register(fileInput, 'fileInput');\n\tMyAMS.registry.register(select2, 'select2');\n\tMyAMS.registry.register(svgPlugin, 'svg');\n\tMyAMS.registry.register(switcher, 'switcher');\n\tMyAMS.registry.register(validate, 'validate');\n\n\t// register module\n\tMyAMS.config.modules.push('plugins');\n\tif (!MyAMS.env.bundle) {\n\t\tconsole.debug(\"MyAMS: plugins module loaded...\");\n\t}\n}\n"],"file":"mod-plugins-dev.js"}