!function(e,t){var a;"function"==typeof define&&define.amd?define(["exports"],t):"undefined"!=typeof exports?t(exports):(t(a={}),e.modPlugins=a)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e){"use strict";function o(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==a.return||a.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.checker=a,e.contextMenu=n,e.draggable=r,e.droppable=i,e.fileInput=c,e.select2=s,e.svgPlugin=u,e.switcher=m,e.validate=f;var t,h=MyAMS.$;h.templates||(t=require("jsrender"),h.templates=t.templates);var M=h.templates({markup:'\n\t<span class="custom-control custom-switch">\n\t\t<input type="checkbox"\n\t\t\t   id="{{: fieldId }}" name="{{: fieldName }}"\n\t\t\t   class="custom-control-input checker"\n\t\t\t   {{if checked}}checked{{/if}}\n\t\t\t   {{if readonly}}disabled{{/if}}\n\t\t\t   value="{{: value }}" />\n\t\t{{if prefix}}\n\t\t<input type="hidden" class="prefix"\n\t\t\t   id="{{: prefix}}{{: fieldName}}_prefix"\n\t\t\t   name="{{: prefix}}{{: fieldName}}"\n\t\t\t   value="{{if state===\'on\'}}{{: checkedValue}}{{else}}{{: uncheckedValue}}{{/if}}" />\n\t\t{{else marker}}\n\t\t<input type="hidden" class="marker"\n\t\t\t   name="{{: fieldName}}{{: marker}}"\n\t\t\t   value="1" />\n\t\t{{/if}}\n\t\t<label for="{{: fieldId }}"\n\t\t\t   class="custom-control-label">\n\t\t\t{{: legend }}\n\t\t</label>\n\t</span>\n'});function a(e){h("legend.checker",e).each(function(e,t){var i=h(t),c=i.data();if(!c.amsChecker){var s=i.parent("fieldset"),a=s.hasClass("switched")||"on"===c.amsCheckerState,n=c.amsCheckerFieldname||"checker_".concat(MyAMS.core.generateId()),r=n.replace(/\./g,"_"),o=c.amsCheckerHiddenPrefix,l=c.amsCheckerMarker||!1,d=c.amsCheckerMode||"hide",u=c.amsCheckerValueOn||"true",m=c.amsCheckerValueOff||"false",f={legend:i.text(),fieldName:n,fieldId:r,value:c.amsCheckerValue||!0,checked:a,readonly:c.amsCheckerReadonly,prefix:o,state:c.amsCheckerState,checkedValue:u,uncheckedValue:m,marker:l},g={veto:!1};if(i.trigger("before-init.ams.checker",[i,f,g]),g.veto)return;i.html(M.render(f)),h("input",i).change(function(e){var t,a=h(e.target),n=a.is(":checked"),r={veto:!1};i.trigger("before-switch.ams.checker",[i,r]),r.veto?a.prop("checked",!n):(MyAMS.core.executeFunctionByName(c.amsCheckerChangeHandler,document,i,n),c.amsCheckerCancelDefault||(t=a.siblings(".prefix"),"hide"===d?n?(s.removeClass("switched"),t.val(u),i.trigger("opened.ams.checker",[i])):(s.addClass("switched"),t.val(m),i.trigger("closed.ams.checker",[i])):(s.prop("disabled",!n),t.val(n?u:m))))}),i.closest("form").on("reset",function(){var e=h(".checker",i);e.prop("checked")!==a&&e.click()}),a||("hide"===d?s.addClass("switched"):s.prop("disabled",!0)),i.trigger("after-init.ams.checker",[i]),i.data("ams-checker",!0)}})}function n(e){var t=h(".context-menu",e);0<t.length&&MyAMS.require("menu").then(function(){t.each(function(e,t){var a,n=h(t),r=n.data(),i={menuSelector:r.amsContextmenuSelector||r.amsMenuSelector},c=h.extend({},i,r.amsContextmenuOptions||r.amsOptions),c=MyAMS.core.executeFunctionByName(r.amsContextmenuInitCallback||r.amsInit,document,n,c)||c,s={veto:!1};n.trigger("before-init.ams.contextmenu",[n,c,s]),s.veto||(a=n.contextMenu(c),MyAMS.core.executeFunctionByName(r.amsContextmenuAfterInitCallback||r.amsAfterInit,document,n,a,c),n.trigger("after-init.ams.contextmenu",[n,a]))})})}function r(e){var t=h(".draggable",e);0<t.length&&MyAMS.ajax.check(h.fn.draggable,"".concat(MyAMS.env.baseURL,"../ext/jquery-ui").concat(MyAMS.env.extext,".js")).then(function(){t.each(function(e,t){var a,n=h(t),r=n.data(),i={cursor:r.amsDraggableCursor||"move",containment:r.amsDraggableContainment,handle:r.amsDraggableHandle,connectToSortable:r.amsDraggableConnectSortable,helper:MyAMS.core.getFunctionByName(r.amsDraggableHelper)||r.amsDraggableHelper,start:MyAMS.core.getFunctionByName(r.amsDraggableStart),stop:MyAMS.core.getFunctionByName(r.amsDraggableStop)},c=h.extend({},i,r.amsDraggableOptions||r.amsOptions),c=MyAMS.core.executeFunctionByName(r.amsDraggableInitCallback||r.amsInit,document,n,c)||c,s={veto:!1};n.trigger("before-init.ams.draggable",[n,c,s]),s.veto||(a=n.draggable(c),n.disableSelection(),MyAMS.core.executeFunctionByName(r.amsDraggableAfterInitCallback||r.amsAfterInit,document,n,a,c),n.trigger("after-init.ams.draggable",[n,a]))})})}function i(e){var t=h(".droppable",e);0<t.length&&MyAMS.ajax.check(h.fn.droppable,"".concat(MyAMS.env.baseURL,"../ext/jquery-ui").concat(MyAMS.env.extext,".js")).then(function(){t.each(function(e,t){var a,n=h(t),r=n.data(),i={accept:r.amsDroppableAccept,drop:MyAMS.core.getFunctionByName(r.amsDroppableDrop)},c=h.extend({},i,r.amsDroppableOptions||r.amsOptions),c=MyAMS.core.executeFunctionByName(r.amsDroppableInitCallback||r.amsInit,document,n,c)||c,s={veto:!1};n.trigger("before-init.ams.droppable",[n,c,s]),s.veto||(a=n.droppable(c),MyAMS.core.executeFunctionByName(r.amsDroppableAfterInitCallback||r.amsAfterInit,document,n,a,c),n.trigger("after-init.ams.droppable",[n,a]))})})}function c(e){var t=h(".custom-file-input",e);0<t.length&&MyAMS.require("ajax").then(function(){MyAMS.ajax.check(window.bsCustomFileInput,"".concat(MyAMS.env.baseURL,"../ext/bs-custom-file-input").concat(MyAMS.env.extext,".js")).then(function(){t.each(function(e,t){var a=h(t),n=a.attr("id"),r=n?"#".concat(n):a.attr("name"),i=h(t.form),c=i.attr("id"),s=c?"#".concat(c):i.attr("name"),o={veto:!1};a.trigger("before-init.ams.fileinput",[a,o]),o.veto||(bsCustomFileInput.init(r,s),a.trigger("after-init.ams.fileinput",[a]))})})})}var d={select2UpdateHiddenField:function(a){var n=[];a.parent().find("ul.select2-selection__rendered").children("li[title]").each(function(e,t){n.push(a.children('option[data-content="'.concat(t.title,'"]')).attr("value"))}),a.data("select2-target").val(n.join(a.data("ams-select2-separator")||","))}};function s(e){var a=h(".select2",e);0<a.length&&MyAMS.require("ajax","helpers").then(function(){MyAMS.ajax.check(h.fn.select2,"".concat(MyAMS.env.baseURL,"../ext/select2/select2").concat(MyAMS.env.extext,".js")).then(function(e){var t=[];e&&(t.push(MyAMS.core.getScript("".concat(MyAMS.env.baseURL,"../ext/select2/i18n/").concat(MyAMS.i18n.language,".js"))),t.push(MyAMS.core.getCSS("".concat(MyAMS.env.baseURL,"../../css/ext/select2").concat(MyAMS.env.extext,".css"),"select2")),t.push(MyAMS.core.getCSS("".concat(MyAMS.env.baseURL,"../../css/ext/select2-bootstrap4").concat(MyAMS.env.extext,".css"),"select2_bs4"))),h.when.apply(h,t).then(function(){a.each(function(e,t){var a,n,r,i,c,s=h(t),o=s.data();o.select2||(a={theme:o.amsSelect2Theme||"bootstrap4",language:MyAMS.i18n.language},s.hasClass("sortable")&&((n=h('<input type="hidden" name="'.concat(s.attr("name"),'">')).insertAfter(s)).val(h("option:selected",s).listattr("value").join(o.amsSelect2Separator||",")),s.data("select2-target",n).removeAttr("name"),a.templateSelection=function(e){var t=h(e.element);return t.attr("data-content",t.html()),e.text}),r=h.extend({},a,o.amsSelect2Options||o.amsOptions),r=MyAMS.core.executeFunctionByName(o.amsSelect2InitCallback||o.amsInit,document,s,r)||r,i={veto:!1},s.trigger("before-init.ams.select2",[s,r,i]),i.veto||(c=s.select2(r),s.on("select2:opening select2:selecting select2:unselecting select2:clearing",function(e){if(h(e.target).is(":disabled"))return!1}),s.on("select2:opening",function(e){var t,a=h(e.currentTarget).parents(".modal").first();a.exists()&&(t=parseInt(a.css("z-index")),c.data("select2").$dropdown.css("z-index",t+1))}),s.hasClass("sortable")&&MyAMS.ajax.check(h.fn.sortable,"".concat(MyAMS.env.baseURL,"../ext/jquery-ui").concat(MyAMS.env.extext,".js")).then(function(){s.parent().find("ul.select2-selection__rendered").sortable({containment:"parent",update:function(){d.select2UpdateHiddenField(s)}}),s.on("select2:select select2:unselect",function(e){var t=e.params.data.id,a=h(e.currentTarget),n=a.children('option[value="'.concat(t,'"]'));MyAMS.helpers.moveElementToParentEnd(n),a.trigger("change"),d.select2UpdateHiddenField(a)})}),MyAMS.core.executeFunctionByName(o.amsSelect2AfterInitCallback||o.amsAfterInit,document,s,c,r),s.trigger("after-init.ams.select2",[s,c])))})})})})}function u(e){var t=h(".svg-container",e);0<t.length&&t.each(function(e,t){var a=h(t),n=h("svg",a),r=n.attr("width"),i=n.attr("height");r&&i&&t.setAttribute("viewBox","0 0 ".concat(Math.round(parseFloat(r))," ").concat(Math.round(parseFloat(i)))),n.attr("width","100%").attr("height","auto")})}function m(e){h("legend.switcher",e).each(function(e,t){var n=h(t),r=n.parent("fieldset"),a=n.data(),i=a.amsSwitcherMinusClass||a.amsMinusClass||"minus",c=a.amsSwitcherPlusClass||a.amsPlusClass||"plus";if(!a.amsSwitcher){var s={veto:!1};if(n.trigger("before-init.ams.switcher",[n,a,s]),s.veto)return;h('<i class="fa fa-'.concat("open"===a.amsSwitcherState?i:c,' mr-2"></i>')).prependTo(n),n.on("click",function(e){e.preventDefault();var t,a={};n.trigger("before-switch.ams.switcher",[n,a]),a.veto||(r.hasClass("switched")?(r.removeClass("switched"),MyAMS.core.switchIcon(h("i",n),c,i),n.trigger("opened.ams.switcher",[n]),(t=n.attr("id"))&&h('legend.switcher[data-ams-switcher-sync="'.concat(t,'"]'),r).each(function(e,t){var a=h(t);a.parents("fieldset").hasClass("switched")&&a.click()})):(r.addClass("switched"),MyAMS.core.switchIcon(h("i",n),i,c),n.trigger("closed.ams.switcher",[n])))}),"open"!==a.amsSwitcherState&&r.addClass("switched"),n.trigger("after-init.ams.switcher",[n]),n.data("ams-switcher",!0)}})}function f(e){var t=h("form:not([novalidate])",e);0<t.length&&MyAMS.require("ajax","i18n").then(function(){MyAMS.ajax.check(h.fn.validate,"".concat(MyAMS.env.baseURL,"../ext/validate/jquery-validate").concat(MyAMS.env.extext,".js")).then(function(e){e&&"en"!==MyAMS.i18n.language&&MyAMS.core.getScript("".concat(MyAMS.env.baseURL,"../ext/validate/i18n/messages_").concat(MyAMS.i18n.language).concat(MyAMS.env.extext,".js")).then(function(){}),t.each(function(e,t){var s=h(t),a=s.data(),n={ignore:null,invalidHandler:MyAMS.core.getFunctionByName(a.amsValidateInvalidHandler)||function(e,t){h("span.is-invalid",s).remove(),h(".is-invalid",s).removeClass("is-invalid");var a,n=o(t.errorList);try{for(n.s();!(a=n.n()).done;){var r=a.value,i=h(r.element),c=i.parents(".tab-pane");i.parents("fieldset.switched").each(function(e,t){h("legend.switcher",t).click()}),c.each(function(e,t){var a=h(t),n=a.parents(".tab-content").siblings(".nav-tabs");h("li:nth-child(".concat(a.index()+1,")"),n).addClass("is-invalid"),h("li.is-invalid:first a",n).click()})}}catch(e){n.e(e)}finally{n.f()}},errorElement:a.amsValidateErrorElement||"span",errorClass:a.amsValidateErrorClass||"is-invalid",errorPlacement:MyAMS.core.getFunctionByName(a.amsvalidateErrorPlacement)||function(e,t){e.addClass("invalid-feedback"),t.closest(".form-widget").append(e)},submitHandler:MyAMS.core.getFunctionByName(a.amsValidateSubmitHandler)||(void 0!==s.attr("data-async")?function(){MyAMS.require("form").then(function(){MyAMS.form.submit(s)})}:function(){s.get(0).submit()})};h("[data-ams-validate-rules]",s).each(function(e,t){0===e&&(n.rules={}),n.rules[h(t).attr("name")]=h(t).data("ams-validate-rules")}),h("[data-ams-validate-messages]",s).each(function(e,t){0===e&&(n.messages={}),n.messages[h(t).attr("name")]=h(t).data("ams-validate-messages")});var r,i=h.extend({},n,a.amsValidateOptions||a.amsOptions),i=MyAMS.core.executeFunctionByName(a.amsValidateInitCallback||a.amsInit,document,s,i)||i,c={veto:!1};s.trigger("before-init.ams.validate",[s,i,c]),c.veto||(r=s.validate(i),MyAMS.core.executeFunctionByName(a.amsValidateAfterInitCallback||a.amsAfterInit,document,s,r,i),s.trigger("after-init.ams.validate",[s,r]))})})})}window.MyAMS&&(MyAMS.registry.register(a,"checker"),MyAMS.registry.register(n,"contextMenu"),MyAMS.registry.register(r,"draggable"),MyAMS.registry.register(i,"droppable"),MyAMS.registry.register(c,"fileInput"),MyAMS.registry.register(s,"select2"),MyAMS.registry.register(u,"svg"),MyAMS.registry.register(m,"switcher"),MyAMS.registry.register(f,"validate"),MyAMS.config.modules.push("plugins"),MyAMS.env.bundle||console.debug("MyAMS: plugins module loaded..."))});